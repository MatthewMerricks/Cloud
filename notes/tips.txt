o Ruby 1.9.3 requires a different C compiler:
    - rvm install 1.9.3  --with-gcc=clang
o RubyMine doesn't debug
    - curl -OL http://rubyforge.org/frs/download.php/75414/linecache19-0.5.13.gem
  - gem install linecache19-0.5.13.gem
  - gem install --pre ruby-debug-base19x
o .rvmrc file: specifies the ruby environment and the gem set to use.
o gemsets:
  - $ rvm use 1.8.7  <== switch to the Ruby interpreter you want to use.
  - $ rvm gemset create rails3
  - $ rvm gemset list
  - $ rvm gemset use rails2
  - gem install rails
    - rvm gemset use rails3
    - gem install --pre rails
    - rvm gemset delete rails3
    - gem list
    - http://ruby.about.com/gi/o.htm?zi=1/XJ&zTi=1&sdn=ruby&cdn=compute&tm=634&f=00&su=p284.13.342.ip_p504.6.342.ip_&tt=2&bt=0&bts=0&zu=http%3A//rvm.beginrescueend.com/gemsets/
    - rvm use 1.9.2-head@albinochipmunk --create
  - rvm use 1.9.2-head@albinochipmunk --default
  - rvm gemdir
  - rvm gemset list
  - rvm gemset list_all
  - rvm gemset delete albinochipmunk
  - rvm gemset empty albinochipmunk
o (2/8/12) Test Application
  - MovieVision
  - Model
    . Movie
      o Title
      o Rating
      o Year
      o Has_many Artists
      o Has_many Media
      o Belongs_to Artist
    . Artist
      o Name
      o Has_many Movies
      o Belongs_to Movie
    . Site
      o Name
      o Has_many Machines
    . Machine
      o Name
      o Belongs_to Site
      o Has many bins
    . Bin
      o Number
      o Belongs_to Machine
      o Has_One (or none) Disk
    . Media
      o Type (DVD, BlueRay, MemoryStick)
      o SerialNumber
      o Has_one Movie
      o Belongs_to Movie
      o May Belong_to Bin
  - Build the model
    . Use shell scripts to build and destroy the model until it is right.
  - Build the scaffold
    . Use shell scripts to build and destroy the scaffold until it is right.
o (2/8/12) Run tests in the rails console
    ruby-1.9.2-p290 :001 > require 'rake'
    ruby-1.9.2-p290 :002 > r = Rake.application
    ruby-1.9.2-p290 :003 > r.init
    ruby-1.9.2-p290 :004 > r.load_rakefile
    ruby-1.9.2-p290 :005 > r['test:units'].invoke
o (2/8/12) Debugging Functional Tests
  - These tests create records in the database from the
    Fixtures.
  - One of the tests was trying to create a record (box) that
    was already in the database from the fixture, and the
    model had a uniqueness requirement.  The test was failing.
  - Insert a "puts @response.body" after the HTML GET/POST.
  - You will see the HTML response text that will help with
    the debugging.
o (2/10/12) RubyMine Keyboard Operations
  - Alt-L - Highlight line at cursor
  - Alt-Del - Delete from cursor to beginning of word.
  - Alt-Fn-Del - Delete from cursor to end of word.
  - Alt-RightArrow - Move cursor to next word.
  - Alt-LeftArrow - Move cursor to previous word.
  - Alt-UpArrow - Select more and more logical text "up".
  - Alt-DownArrow - Select less and less logical text "down".
  - Alt-Shift-Arrows - As above, but select the text.
  - Alt-P - Page down.
  - Alt-Ctrl-P - Page up.
  - Cmd-D - Duplicate line at cursor, below.
  - Cmd-Del - Delete the line at the cursor.
  - Cmd-[ - Cursor to start of block up.
  - Cmd-] - Cursor to end of block down.
  - Cmd-{[]} - As above, but select text moved over.
  - Cmd-Z - Undo
  - Cmd-RightArrow - Cursor to end of line text.
  - Cmd-LeftArrow - Cursor to start of line text.
  - Cmd-Shift-U - Toggle case of selection.
  - Cmd-Alt-U - Toggle Camel/Snake case.
  - Fn-RightArrow - Cursor to end of line text.
  - Fn-LeftArrow - Cursor to start of line text.
  - Fn-UpArrow - Top of file text.
  - Fn-DownArrow - Bottom of file text.
  - Shift-Cmd-Arrows(left, right) - Same as above, but select text.
  - Shift-Fn-Arrows - Same as above, but select text.
  - Shift-Enter - New line below.
  - Ctrl-UpArrow - Show the desktop.
  - Ctrl-DownArrow - Unshow the desktop.
  - Ctrl-Shift-J - Join the selected lines into a single line.
  - Ctrl-Enter - Split the line at the cursor.
  - Shift-DownArrow - Move the selected text down.
  - Shift-UpArrow - Move the selected text up.
  - Shift-LeftArrow - Move the selected text left.
  - Shift-RightArrow - Move the selected text right.
  - Tab - Indent selection
  - Shift-Tab - Unindent selection.
o (2/18/12) Code Camp Davie
  - TDD: Barry S. Stahl
    . Use VS.  Add class.  Queue.cs.  He uses FxCop a lot.  Has his own FxCop template on his blog.
    . Use moq for the mock tool.
    . Cognitiveinheritance.com
  - Buildig HTML5 and JS Apps with MVVM and KnockOut, John Papa
    . johnpapa.net
    . KnockOut.js, Steve Sanderson put it together.  Sustainable JS apps.
    . Sep of concerns, UI patterns, Structured JS, Data & Bindings.
    . Rich client-side interactivity
    . MVVM-like pattern
    . Wide browser support
    . 3 steps:
      <input data-bind="value: firstName" />  Declarative binding
      library looks for data- 
      var myViewModel = {
        firstName: ko.observable("John")  Create an observable
      };
      ko.applyBindings(myViewModel);  Bind the ViewModel to the view.
      jsfiddle scratchpad  jsfiddlt.net/johnpapa/BEXJc/
      One-way binding if not using observables.
      ko.observable(); 2-way binding.
      product: {
        id: ko.observable(1001),
        model: ko.observable("Taylor
      ko.applyBindings(myViewModel);
      Computed Observables: Define a function to veal a value, and use it for binding.
      When its boservables change, it also notifies that change occurred.
      Manage "this".  Pass in an owner for "this", if needed.  Don't assume "this" means something.  It doesn't.  It's weird in JS.
      vm.etended price = ko.comuted(function () {
         return this.product() ? this.salePrice() * parstInt("0" + this.qty(), 10) : 0;
      }, vm);    That's a ViewModel (vm).  The vm says what the "this" is.  It's called the Owner properter.
      Can have multiple of these "computed values".  One at the product level, and another at the total level.
      Can also have read/write "computed values".  Allows you to use extended price to buy as many as I have money for.
      Knockout is client-side.
      Observale Arrays:
      Tracks which object are in the array, not their state.  Track the state with ko.observable()
      var myViewModel = {
         products: koobservableArray([
              { model: "Taloy ", price: 1749, id=321 },
              next item…
      }
      <span data=bind to that…
      Built-in Bindings:
        Text & html
        Value bindings
        etc.
      Facilitate inding to attributes for eleents
      May use multiple binding expressions separated by commas.
      Click event binding
      ValueUpdate.  Input area's value changes (default).  e.g., blur.  Or keyup, key press or afterkeydown.
      <input type = "tesxt" data-bind="value.price" valueUpdate=afterkeydown
      Templates, used with Knockout.
      Control of Flow.  if, if not, foreach, with
      All these apply to Knockout data-bindings.
      with customer.address   then refer to street1, street2, etc.
      Can also use query templates, underscore and others.
      data-bind="template: {name: 'products,  for-each…
      Can change scope.  $data current, $parent, my parent  $root.  the root
      Knockout has a native template engine  implicit definitons if, etc.
      Containerless bindingns.
      Custom binding handlers.  A little more involved.
      How do you integrate with jquery-ui?
      ko.bindingHandlers.fadeVisible (extension).  init: runs first.  update:  runs when the binding is accessed.
      Custom binding.  data-bind="fadeVisible: canShowDetails(), fadeDuration="2000"
      Tip 1: self-closing spans.  Must close the span.  not <span   …. />, but <span  … >dddd</span>
      Tip 2: ko.toJson().  Will spit out everything for debugging.
  - Techniques, strategies, and patterns for structuring JS code, John papa.  Great patterns.
  - Intro to interactive web pages with Knockout JS, CoffeeScript and SCSS
    . Quent Hershelman
    . QuentHershelman@hotmail.com
    . www.quentnet
    . See www.IsaGlobal.org (certified Architect)
    . Knockout is amazingly close to the Xaml data binding support.
    . Also coffee script and SCSS.
    . Knockout: Steve Sanderson.  Good docs.  MIT open source.  All browsers.  Easy and tutorialsl
    . View-ViwModel data binding.
    . Observables.
    . Fine-grained dependency chaining (View changes triggers to update to ViewModel.  ViewModel changes triggers to update View.
    . Inluclde <srcipt src="knockout-2.0.0.js"></script>
    . Write your view: <span data-bind="text: first name"></span>  This is a "text" binding.  Tons more.
    . Write your JS viewModel
        var viewModel=:\{
          firstname: ko.observale("Quent")  Also ko.observaleArray() and ko.computed().
         };
    . Wire up the runtime in the $.ready function
        ko.applyBindings(viewModel);
    . Bindings: text: html: css: style: attar: click: text: visible: and lots more…
    . Add a comment reference /// <reference … to JS to turn on Intellisense in a JS file inside VS.
    . Can use <script type="html/text"> x…..x.   </script>  to include template HTML stuff.
    . A comment <!-- ko jdkjkdjj --> will invoke the html snippet and substitute data.
  - Linq to objects, Advanced topics, Amir Liberman.
    . projecteuler.net: tough math problems.  Some can be solved by linq.
    . linqlib open source.
    . linq extensions library on codeplex.com
    . codeplex.com linqlib.codeplex.com
o (2/22/12) First day with Gus' team
  - Demo for March 13th.
  - 
  - moch inject  insoe finder.  Extend folder structure with a badge.  
  - Michael.  bootstrap css project to handle css.  Leverage bootstrap for the back-end (from twitter).  Working on authentication with web app.
    What does metadata server need.  Some kind of cache?  App has the same id on a device every time.  UdId already registered.  If linking another device
    just override the device?  Steve:  Will look at it.  If the UdId belongs to the user of that device, just overlay it.  Must transfer the ownership
    of the device to a new user.  Must scrub the ID.  Scrub is new registration, a…  Unique elements are user and device.  If the user already exists, don't' let it
    reregister.  Refresh the access token for the device?  What about multiple users on a computer?  Today, device has hash and serial number.  Will add a
    user ID.  Token based on shot key?  and time and random number.  Register a device goes to a default location.  What does an account represent?  Generate
    ID, not necessarily tied to the hardware.  Can be multiple users on a device.  The token should include the app id, user ID and device ID.  
    If the user ID and the device ID match, this guy is just trying to reconnect, and we should let it happen.  If a user recreates a device, then logs in and
    tries to resync the device, must ask the user.  Allow the user to resync, or blow it away.  
o (2/21/12) Badges over Finder file icons:
  - How to superimpose an image:  http://stackoverflow.com/questions/2281177/how-to-overlap-superimpose-an-image-over-a-file-icon-using-cocoa
  - More: http://stackoverflow.com/questions/3181145/add-an-icon-mac-pc-to-a-file-with-cocoa
  - It is possible to put a badge onto a file icon using Quick-Look icons, but I think only for certain file types.  This link says
    it is impossible to use this method to put badges on all files: http://lists.apple.com/archives/quicklook-dev/2011/Sep/msg00003.html
  - Use NsWorkspace setIconForFile to set the icon: http://www.cimgf.com/2008/06/16/cocoa-tutorial-custom-folder-icons/
  - Getting the icon data? From: http://gears.googlecode.com/svn/trunk/third_party/growl/CFGrowlAdditions.c 
DATA_TYPE copyIconDataForURL(URL_TYPE URL)
{
	CFDataRef data = NULL;

	if (URL) {
		FSRef ref;
		if (CFURLGetFSRef(URL, &ref)) {
			IconRef icon = NULL;
			SInt16 label_noOneCares;
			OSStatus err = GetIconRefFromFileInfo(&ref,
												  /*inFileNameLength*/ 0U, /*inFileName*/ NULL,
												  kFSCatInfoNone, /*inCatalogInfo*/ NULL,
												  kIconServicesNoBadgeFlag | kIconServicesUpdateIfNeededFlag,
												  &icon,
												  &label_noOneCares);
			if (err != noErr) {
				NSLog(CFSTR("in copyIconDataForURL in CFGrowlAdditions: could not get icon for %@: GetIconRefFromFileInfo returned %li\n"), URL, (long)err);
			} else {
				IconFamilyHandle fam = NULL;
				err = IconRefToIconFamily(icon, kSelectorAllAvailableData, &fam);
				if (err != noErr) {
					NSLog(CFSTR("in copyIconDataForURL in CFGrowlAdditions: could not get icon for %@: IconRefToIconFamily returned %li\n"), URL, (long)err);
				} else {
					HLock((Handle)fam);
					data = CFDataCreate(kCFAllocatorDefault, (const UInt8 *)*(Handle)fam, GetHandleSize((Handle)fam));
					HUnlock((Handle)fam);
					DisposeHandle((Handle)fam);
				}
				ReleaseIconRef(icon);
			}
		}
	}

	return data;
}
  - Can get icon data and use CompositeIconRef to superimpose one image on top of another.  Supported in the Cocoa framework.
    See http://fossies.org/unix/misc/fpcbuild-2.6.0.tar.gz:a/fpcbuild-2.6.0/fpcsrc/packages/univint/src/IconsCore.pas.
  - May use FSEvents framework to watch for changes to the file system.
  - QuickLook docs: https://developer.apple.com/library/mac/#documentation/userexperience/conceptual/Quicklook_Programming_Guide/Articles/QLImplementationOverview.html
  - Static QuickLook pproach: If you want to specify static thumbnail and preview images for a bundled document, you can take the easiest approach—it 
    doesn’t even require a generator. Just have your application place the images inside the document bundle in a subfolder named QuickLook; 
    the image file for thumbnails should be named Thumbnail.ext and the file for previews should be named Preview.ext (where ext is an 
    extension such as tiff, png, or jpg). If you decide on this approach, you should not create a generator.
  - DB implements this via a Finder Context Menu Extension: http://forums.DB.com/topic.php?id=13858
  - Interesting comment: There is no official or supported plugin system for the Finder. Starting with OS X 10.6, you will need to inject code into the Finder process and override objective C methods in the Finder process.
I've done this for a proprietary project. I can tell you that the reason that there are no examples or tutorials for this is because it is a significantly difficult and time consuming development task. For this reason, there's plenty of incentive for individuals or organizations who have accomplished this to guard the specifics of their process closely.
If there's any way at all that you can accomplish your goal using the Services API, do it. Writing a Finder plugin will take you 1-2 solid months of painstaking development and reasonably deep knowledge of C and Objective-C internals.
If you're still convinced that you want do to this, grab mach_star. Good luck.
  - Seems to be definitive: http://stackoverflow.com/questions/1294335/how-to-write-os-x-finder-plugin
  - I could use the SCPlugin, but that was developed with the Carbon framework, and probably does not have support in Cocoa.
  - All about swizzling: http://www.mikeash.com/pyblog/friday-qa-2010-01-29-method-replacement-for-fun-and-profit.html
  - Source code for GetIconRefFromFileInfo: http://fossies.org/unix/misc/fpcbuild-2.6.0.tar.gz:a/fpcbuild-2.6.0/fpcsrc/packages/univint/src/IconsCore.pas
  - Very good info on badging: http://www.cocoabuilder.com/archive/cocoa/95797-finder-icon-badging.html
  - F-Script injection (like SPY++): http://pmougin.wordpress.com/2010/01/05/the-revenge-of-f-script-anywhere/
  - About IconRefs: https://developer.apple.com/legacy/mac/library/documentation/Carbon/Conceptual/Icon_Service_nd_Utilities/IconServUtili.pdf
  - DB does it via Context Menu plugin???: http://forums.DB.com/topic.php?id=13858
  - MachStar: https://github.com/rentzsch/mach_star#readme
  - Add an item to Finder's right-click menu: http://stackoverflow.com/questions/8809256/how-do-i-get-information-about-the-file-folder-that-has-been-right-clicked-befor
  - Debugging mach_inject with file output: http://stackoverflow.com/questions/8179946/mach-inject-kick-start
  - In Lion, apparently attaching XCode4 Instruments to Finder will allow reverse engineering.
  - class-dump: command line tool to dump a bundle's code in recompilable format.
  - The Mack Hacker's Handbook: http://translated.by/you/the-mac-hacker-s-handbook-part-3-poslednyaya/into-be/trans/?page=92
  - Patch to fix mach_override on intel machines: http://mabblog.com/blog/category/cocoa-programming-osx/
  - Add a user to the procmod group:
    . groups robertstevens  <== list the groups that the user is in.
    . sudo dscl localhost -append /Local/Default/Groups/procmod GroupMembership robertstevens
    . Instructions here: http://0x0005.blogspot.com/2008/08/it-appeared-difficult-to-add-user-to.html
  - Add the debug executable to the procmod group:
    . Find the file by clicking on the target under products.  Then right-click and select Show in Finder.
    . A file like /Users/robertstevens/Library/Developer/Xcode/DerivedData/mach_inject_test-agmaofynhaoajmfbwlnewmbujorx/Build/Products/Development/mach_inject_test_injector.app.
    . sudo chgrp procmod
  - Find the debug bundle file output location.  Drop-down products.  Right-click the .app file.  Click Show in Finder.
  - Find the path of the program file programmatically: [NSBundle mainBundle] bundlePath].
  - Programmatically authorizing: https://blogs.oracle.com/dns/entry/understanding_the_authorization_framework_on
  - Old Tiger code using task gated to get proceed membership via code: http://superuser.com/questions/352388/sudo-sysctl-w-kern-tfp-policy-1-fails
  - task_for_pid() restriction explained: http://books.google.com/books?id=WAPxyIorYM0C&pg=PT52&lpg=PT52&dq=mac+os+x+add+user+to+procmod+group&source=bl&ots=w3b-A0ThY2&sig=KCRrNWYzH1mjwYAAV8Sgkx-gk1c&hl=en&sa=X&ei=EltFT8uMK8betgfT-cGZAw&ved=0CFUQ6AEwBw#v=onepage&q=mac%20os%20x%20add%20user%20to%20procmod%20group&f=false
  - Possible programmatic code to get authorization to inject:  http://lists.apple.com/archives/darwin-userlevel/2008/Jul/msg00002.html
  - An example of programmatic authorization with signed executable and a .plist file: http://www.os-tres.net/
  - Confirmation that I need signed code, and a .plist entry: http://osdir.com/ml/apple-cdsa/2010-01/msg00022.html
  - More on the task_for_pid() problem:
    . http://osdir.com/ml/apple-cdsa/2010-01/msg00022.html
    . http://lists.apple.com/archives/apple-cdsa/2008/Feb/msg00014.html
    . http://web.archiveorange.com/archive/v/M1Kj9CciXUo0RNWl7N3z  (authoratative!)
  - Tutorial on how to code sign: http://os-tres.net/blog/2010/02/17/mac-os-x-and-task-for-pid-mach-call/
  - Great code signing guide: http://www.filibeto.org/unix/macos/lib/dev/documentation/Security/Conceptual/CodeSigningGuide/CodeSigningGuide.pdf
  - Interesting comment: "This is an intentional security feature in task_for_pid() and in ptrace() to preclude you using the debugger to debug a program with escalated privilege and thus access code, data, or interfaces which you would otherwise not be privileged to access or execute as a privileged user or group.  It doesn't matter that the group is the same as gdb itself is running as, what matters is that the credential for that user has been adulterated away from the identity given to the system by DirectoryServices or whatever authentication database you are using to establish the credential in the first place.  Credentials are established by escalating privilege, setting up the credential, and dropping privilege.  If you run a program that re-escalates privilege, unless it does the little dance to establish its rights to establish a new kernel credential authoritatively, privilege is revoked.  In your case, your gdb is only sgid, so it's incapable of obtaining root privilege in order to become an authoritative source of credential information for the kernel.  This is also generally why we ask people to rely on login as a gatekeeper, rather than writing their own credential establishing code."  From : http://lists.apple.com/archives/darwin-dev/2009/Jul/msg00015.html
  - &&&&&&&&&&&&&&&&&&&&&&&&&&&&
  - (2/23/12) Requiring root privilege is OK.
  - Write a program that becomes a daemon with root privileges.
  - How to request root privileges in code: http://stackoverflow.com/questions/6659527/task-for-pid-always-returns-os-kern-failure-on-darwin-in-c
  - Launch_dev man page: http://www.manpagez.com/man/5/launchd.plist/
  - LaunchCtl tutorial: http://www.afp548.com/article.php?story=20050620071558293
  - Change the owner on a file: sudo chown root /Library/LaunchAgent/foo.plist
  - Debugging tip for .plist loading: 
        <key>StandardOutPath</key> 
     <string>/var/root/NightlyRSyncBackup.out</string>
     <key>StandardErrorPath</key>
     <string>/var/root/NightlyRSyncBackup.err</string>
  - Another tip:
	Note that per-user configuration files (LaunchAgents) must be owned by the user loading them. All system-wide daemons (LaunchDaemons) must be owned by root. Configuration files must not be group- or world-	writable. These restrictions are in place for security reasons, as allowing writability to a launchd configuration file allows one to specify which executable will be launched.  So, if your rsync should be stared as root:		
		chown root  /Library/LaunchDaemons/your.plist 
		chgrp wheel /Library/LaunchDaemons/your.plist 
		chmod 644   /Library/LaunchDaemons/your.plist
	and after these:
		launchctl load /Library/LaunchDaemons/your.plist
  - Mac Debugging Magic Tech Note: https://developer.apple.com/library/mac/#technotes/tn2124/_index.html
  - (2/26/12) Enhancing rights so task_for_pid() will work?: http://guiheneuf.org/cross-task%20control%20on%20intel.html
  - Good info on code injection: http://www.mikeash.com/pyblog/friday-qa-2009-01-30-code-injection.html
  - Paint icon for every file beginning with "A": http://stackoverflow.com/questions/1294335/how-to-write-os-x-finder-plugin
  - Overview of insertion and APE: http://stackoverflow.com/questions/2689348/is-it-possible-to-hook-api-calls-on-mac-os
  - Convert executable console app to bundle: http://stackoverflow.com/questions/4636572/building-mac-os-x-app-instead-of-console
  - More on converting to bundle, and LSUIElement: http://stackoverflow.com/questions/2226749/gui-less-app-bundle
  - NIBLess project: http://lapcatsoftware.com/blog/2007/06/
  - (2/27/12) I have a NibLess app with initialization and full AppKit support.  Now actually place a hook.
  - I need Finder's proper headers.  Use class-dump to get them.  Download it from here: http://www.codethecode.com/projects/class-dump/
    . Show all files in Finder
    . The class-dump download is a DMG.
    . When double-clicked in the Downloads folder it loads the disk image.  You can see it in the left Finder pane.
    . Use two Finder windows to drag the class-dump executable to /usr/bin.
  - Problem: Show in Finder doesn't work: https://discussions.apple.com/thread/2801693?start=0&tstart=0
  - Show all files in Finder: 
    . defaults write com.apple.finder AppleShowAllFiles TRUE?    . killall Finder
  - (2/27/12) Staff meeting.
    . Logo discussion.  Won't be using the gray circle cloud.
    . Felipe: No.  Had 1-hour interview prior to this meeting.
    . Need to hire someone in March because req will go away.
  - Class-dump:
    . class-dump -H /System/Library/frameworks/appkit.framework
  - find files:
    . find . -name "*run*.h" -print    <== case sensitive!
  - find strings in files:
    .grep -r  --include="*.h" "Method" *
    .grep -rwi  --include="*.h" "Method" *  <== find words only, ignoring case.
  - Interesting snip with nodeWithFEIcon: http://pastebin.com/et1kmGVY/etc/social/index.html
       AAA = [(TNodeIconAndNameCell *)self node];  // Get my own node.  Treat myself as a TNodeIconAndNameCell.
       BBB = [NSClassFromString(@"FINode") nodeWithFENode:AAA];  // form a runtime class from the string "FINode" + my own node ID.
       NSString *path = [BBB fullPath];    // Get the full path from that runtime class.
  - Get the full path of a TFENode in Lion: http://stackoverflow.com/questions/8861503/getting-the-full-path-of-a-tfenode-in-lion
                 From a TFENode, you can get an OpaqueNodeRef, and use that with FINode's nodeFromNodeRef: method. 
                After that, you can get the NSURL to the item with FINode's previewItemURL method.
  - Lots of references to icon modification and context menu adds in Finder: http://loopingrecursion.com/index.php?t=finder
  - Test TNodeIconAndNameCell with TFENode definition: https://llvm.org/svn/llvm-project/cfe/tags/Apple/clang-114.1/src/tools/clang/test/CodeGenObjCXX/property-dot-reference.mm
  - Lion context menu support links: http://www.assembla.com/wiki/show/macintosh-svn-client/LionSupport
  - (2/28/12) Finder.app is located in /System/Library/CoreServices/.
  - Add methods to an object at runtime: http://www.developers-life.com/add-methods-to-obejct-at-runtime-in-objective-c.html
  - runtime.h is in /usr/include/objc/runtime.h
  - (2/28/12) List of classes in memory is in IconBadge/ListOfClassesInMemory.rtf.
  - There are two references that I can't find anywhere: OpaqueNodeRef and FINode.  Hopefully, the runtime will make up for it.
  - Current problem: The code looks for the TIconAndTextCell class which is the class driven by Finder.  However, that class is not in the current process.  I listed out all of the
    currently registered names.  it's not there.  How do I find the class used by Finder if it is not registered?  Do I need to look in another process somehow?  Duh!  I think the answer to
    this is that I haven't injected the code yet.  The swizzling that I am trying to do should be done by the injection process???
  -  Installing, authorizing and patching finder?  https://github.com/snielsen/DeathToDSStore/blob/master/source/DeathToDSStoreAppDelegate.m
  - I got the DeathToDSStore programs working and rebranded.
  - Now I need to do the swizzling.
  - Neat command to search for symbols: /usr/bin/nm /System/Library/PrivateFrameworks/FinderKit.framework/FinderKit | c++filt | grep TIconAnd
  - C++filt man page: https://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/c++filt.1.html
  - Book: Design Patterns in Ruby.
  - Kill the finder: killall -KILL Finder
  - (2//29/12) Open Finder at a particular path: In terminal, "open <path>".
  - Swizzle package: http://github.com/rentzsch/jrswizzle.
  - Really good article on swizzling: http://cocoadev.com/index.pl?MethodSwizzling
  - Working without a NIB: http://lapcatsoftware.com/blog/2007/06/
  - Example of mach_override(): http://www.core.dk/~lp/2009/08/mac-os-x-code-injection.html
  - Finally got the C function to drive from the Finder Objective C environment!!!!  I used this web page: http://www.developers-life.com/add-methods-to-obejct-at-runtime-in-objective-c.html
  - That page (http://www.developers-life.com/add-methods-to-obejct-at-runtime-in-objective-c.html) also shows how to get into the full Objective C environment if I need to!
  - It works!!!!!!
  - Now look at the API.
  - Lion supports XPC (enhanced IPC).  https://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingXPCServices.html#//apple_ref/doc/uid/10000172i-SW6
  - About XPC sandboxing: https://developer.apple.com/library/mac/#documentation/Security/Conceptual/AppSandboxDesignGuide/AppSandboxInDepth/AppSandboxInDepth.html#//apple_ref/doc/uid/TP40011183-CH3-SW2
  - More on the sandbox: http://lacquer.fi/pauli/blog/2011/11/why-the-mac-app-sandbox-makes-me-sad/
  - XPCKit: https://github.com/amazingsyco/XPCKit
  - XPC .plist man page: http://www.manpagez.com/man/5/xpcservice.plist/
  - Research item: When I change a model state in real time (e.g., from syncing to synced), how do I signal Finder to change the icon?
  - Forms of IPC on Mac OS x: http://www.puredarwin.org/curious/ipc
  - (3/1/12) I realized that XPC won't work.  That only works in a launched process, but we need the Finder process to receive these messages.
  - I found a simple solution that works with Objective C: http://www.gnustep.org/resources/documentation/Developer/Base/ProgrammingManual/manual_7.html
    . I need to create a full Objective C environment with a run loop in the finder process.
    . Create a thread (using the Finder process context) to drive this run loop.
    . The thread will be the server, and will use socket communication to accept requests and send responses.
    . Another good example of the client/server code: http://www.cocoadev.com/index.pl?DistributedObjectsSampleCode
    . Runloops are thread-based: http://cocoadev.com/forums/discussion/256/nsrunloop-behaviour-in-leopard/p1
    . More on Distributed Objects with protocols: http://cocoadevcentral.com/articles/000062.php
    . This works now with a simple telephone directory lookup method.
    . I designed the initial API.  See "ICONBADGE API" below.
  - I installed F-Script.  This tool injects into Finder and allows me to inspect Finder's object model.
    . It looks like "drawInlinePreview" is the method that draws a preview image in the TFlowView Finder view.
    . It looks like that same method is used in the TIconView Finder view.
    . F-Script page: http://pmougin.wordpress.com/2010/01/05/the-revenge-of-f-script-anywhere/
    . F-Script documentation: http://www.fscript.org/documentation/index.htm
    . F-Script fix for Lion: http://groups.google.com/group/f-script/browse_thread/thread/8899f236501a1980
  - I looked for a trace tool like Windows procmon.  I want to trace all Objective C messages generated by Finder.
    . I found DTrace.  I'll look into it.  I hope it will do the job.
    . Using Xcode and DTrace to trace file accesses: http://www.symantec.com/business/support/index?page=content&id=HOWTO36824
    . More on DTrace to capture file accesses: http://www.symantec.com/business/support/index?page=content&id=TECH145293
    . YES!  DTrace has an Objective C message provider: http://www.mactech.com/articles/mactech/Vol.23/23.11/ExploringLeopardwithDTrace/index.html
    . nlist utility can look up private symbols (DTrace with mods in your program): http://www.dribin.org/dave/blog/archives/2006/04/22/tracing_objc/
    . That same page also shows how to hook the logObjcMessageSends() function and replace it with any logging function.  That allows tracing of ObjC msg sends.
    . Simple D-Trace instructions for tracing ObjC msgs: http://snippets.aktagon.com/snippets/342-How-to-trace-Objective-C-messages-with-dtrace-in-OSX
    . Using Xcode Instruments with DTrace for tracing particular ObjC msgs: http://www.friday.com/bbum/2008/01/04/objective-c-using-instruments-to-trace-messages-to-nil/
    . A great DTrace tutorial:  http://www.1729.us/cocoasamurai/Debugging%20Cocoa%20with%20DTrace.pdf
    . Mack hacking presentation: http://www.blackhat.com/presentations/bh-jp-08/bh-jp-08-Miller/BlackHat-Japan-08-Miller-Hacking-OSX.pdf
    . A tutorial on objc_msgsend: http://www.friday.com/bbum/2009/12/18/objc_msgsend-part-1-the-road-map/
    . You can't DTrace the objc_msgsend return code: http://stackoverflow.com/questions/7047097/is-it-possible-to-get-the-result-of-objc-method-in-dtrace
    . Tracing objc_msgsend calls to nil: http://www.friday.com/bbum/2008/01/03/objective-c-using-dtrace-to-trace-messages-to-nil/
    . setenv DYLD_SHARED_REGION avoid  <==== allows us to print the selector name.
    . Printing class names being forwarded to (not for 64-bit): http://www.friday.com/bbum/2008/01/26/objective-c-printing-class-name-from-dtrace/
    . More on printing class names: http://lists.apple.com/archives/xcode-users/2009/Jul/msg00356.html
    . (3/5/12) Running DTrace: In the Projects/DTrace folder:  ./TestDTrace.sh 6466 >log.txt
    . 
  - Returning multiple errors:
    . NSError is the standard way to represent an error.  Read one way to use it here: http://www.cimgf.com/2008/04/04/cocoa-tutorial-using-nserror-to-great-effect/
    . Another NSError example: http://stackoverflow.com/questions/4654653/how-to-use-nserror-in-my-iphone-app
  - A list of tools for reverse engineering, and obj conference notes?  https://gist.github.com/297037
  - Where are Xcode substitution variables discussed?: https://developer.apple.com/library/mac/#documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html
  - Print all of the methods for an objective c class instance: http://labs.distriqt.com/post/863
  - More of the above, another method: http://stackoverflow.com/questions/754824/get-an-object-attributes-list-in-objective-c
  - String encodings of argument types: http://pj.freefaculty.org/ps905/ObjC.pdf
  - Allow more console log messages per second: http://superuser.com/questions/168727/mac-extend-or-disable-500-messages-limit-of-console
  - Mono - Objective C project: http://api.monobjc.net/html/T_Monobjc_Foundation_NSURL.htm
  - QuickLook processing with previewItemURL: http://development.christopherdrum.com/blog/?p=109
  - (3/4/12) Saved code to print ObjectiveC class hierarchy: /Users/robertstevens/Source/Projects/SavedSource/FinderOverride20120304PrintObjcClassHierarchy.m.
  - NSLock example: http://alienryderflex.com/NSLock.html
  - I got the unit tests running.  You have to delete the automatically produced target and add a new one: http://stackoverflow.com/questions/5057951/test-driven-development-tdd-writing-unit-tests-in-xcode-4
  - Unit testing macros: https://developer.apple.com/library/ios/#documentation/DeveloperTools/Conceptual/UnitTesting/AB-Unit-Test_Result_Macro_Reference/result_macro_reference.html#//apple_ref/doc/uid/TP40002143-CH9-SW1
  - SenTest open source: http://www.sente.ch/software/ocunit/
  - SenTest runs tests randomly!!!!   I proved it!
  - Apparently, SenTest (OCUnit) runs the tests in alphabetic order.  Make the test names like test000*, test001*, etc.
  - NSLog format specifiers: https://developer.apple.com/library/mac/#documentation/cocoa/Conceptual/Strings/Articles/formatSpecifiers.html#//apple_ref/doc/uid/TP40004265
  - (3/5/12) Project to find hook to allow QuickLook icons to be badged:
    . Interesting article on hacking Leopard: http://securityevaluators.com/files/papers/hackingleopard.pdf
    . Try DTrace on DB.
    . Browse through the Finder class-dump .h files.
    . Try DTrace on Finder.
    . Use Automator to do something repetitive with Finder so the relevant code could be exposed: http://www.macosxautomation.com/automator/  (Won't work).
    . Run Finder under GDB and set some breakpoints to see what info I can see.
    . Promising: FI_TGroupIconView.h drawNode:atAnchor:inContext.  However, the only "drawnode" in the DTrace is shouldDrawNode:atIndex: from FI_TIconViewController.h.
    . Also promising: FI_TIconView.h drawRect.  Maybe our current swizzled class (TIconAndTextCell) is related in some way?  Try this because it is easy to change.
    . (3/8/12) Modulle IKImageBrowserDatasourceItemPrivate-Protocol.h.  quickLookContentFrameForImageSize imageToDrawForCell
    .  NSBrowserProtocol-Delegate.h: NSBrowserDelegate willDisplayCell
    . NSImage-NSImageAdditions.h:  drawInRectFE
    . QLPreviewViewDelegate-Protocol.h:  didShowPreviewItem
    . TBrowserViewController.h iconFrameForNode frameForNode ensureCGSurfaceUpdateOnDraw iconSize getCellForNode
    . TChooseImageController.h shouldShowNode
    . TColumnViewController.h browser:willDisplayCell quickLookSharedPreviewViewForPreviewNode currentNode 
    . TDesktopIcon.h:  drawIconInContext
    . TDesktopIconUIElement.h:  frame 
    . TDesktopIconView.h: drawRect
    . TDesktopViewController.h:  quickLookSharedPreviewViewForPreviewNode extendedDesktopIconFrameForNode desktopIconFrameForNode iconFrameForNode desktopFrameForNode frameForNode draw prepareToDrawNode iconForNode nodes iconRegionForNode setShowIconPreview iconView
    . TFlowViewController.h: quickLookSharedPreviewViewForPreviewNode ensureCGSurfaceUpdateOnDraw 
    . TIconImageView.h: drawRect
    . TIconView.h:  drawRect drawBackgroundOverhangInRect shouldDrawCell drawBackground caNeedsDisplay              
    . (3/9/12) TIconViewCell.h: imageFrame frame
    . TIconViewController.h: imageOfCell quickLookSharedPreviewViewForPreviewNode restoreImageForNode currentSingleIconBounds anchoredIconBounds anchoredBoundsForIconCellPart anchoredBoundsForIconCellPart setShowIconPreview 
    . TIconViewScrollView.h drawRect
    . TIconViewSettings.h: showIconPreview 
    . TListGroupRowView.h: drawRect
    . TListView.h: drawRect drawRect
    . TListViewController.h: imageForRow idealViewSize iconFrameForNode frameForNode 
    . TListViewIconAndTextCell.h: drawIconWithFrame
    . TNodeViewSettings.h: BOOL iconViewShowIconPreview 
    . TPreviewWindowController.h: Manages the preview window.
    . TQLPreviewWindowControllerProtocol-Protocol.h: quickLookSharedPreviewViewForPreviewNode 
    . TThumbnailImageRep.h: initWithCGImage
    . TView.h: drawRect 
    . TIconImageView::drawRect didn't hit.  Try TIconViewScrollView::drawRect.
    . No hits from TIconViewScrollView::drawRect.  Try TView::drawRect
    . That didn't hit either.
    . Maybe none of the calls from Finder will work?  Do I need to only use the FinderKit executable?
    . I think the objects are in the Finder (not FinderKit) process, because TIcon* is found, not FI_TIcon*.
    . TIconView::drawRect gets hits in the proper count, but the badges don't draw.
    . Try TIconViewScrollView::drawRect.  That didn't hit.
    . GDB and DTrace have no symbols for finder.  The stack traces are of no use.
    . The Finder "Get Info" is broken on my machine following injection.  However, it works on Gus' machine.
    . I have some hits on TIconView::drawRect.  Maybe the root object methods will hold some info.  Put in the method dump code.
    . (3/10/12) Big problem yesterday and today with Mac OS permissions.  Finally solved.
    . I printed the stack on entry to the swizzled code (TIconView::drawRect).  I see patterns in the DTrace like this:
             AppKit`-[NSTableView drawRect:]+0xe5
             AppKit`-[NSTrackableOutlineView drawRect:]+0x4a
              Finder`0x00000001003611ec+0x958
              AppKit`-[NSView _drawRect:clip:]+0xeae
    . NSView::drawRect called Finder (no symbols) who called NSTrackableOutlineView::drawRect, who called NSTableView::drawRect.
    . Search the class header files for NSTrackableOutlineView and NSTableView.
    . NSTracableOutlineView is the base class of the TSidebarView class.  Not ours.  Oh snap!
    . There's another pattern like that:
              AppKit`-[NSControl drawRect:]+0xa3
              Finder`0x0000000100360199+0x1f2
              AppKit`-[NSView _drawRect:clip:]+0xeae
    . Finder is calling NSControl::drawRect.  Can I find that?
    . That looks like it is dealing with drawing text.  Any more?
    . Another pattern:
             ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawRect:]+0x62
              Finder`0x0000000100363de0+0xa69
              AppKit`-[NSView _drawRect:clip:]+0xf9b
    . That's from the TImageBrowserView class.  More promising!
    . That class has the following methods:
	@interface TImageBrowserView : IKImageBrowserView {}
		- (void)viewDidMoveToSuperview;
		- (void)viewWillMoveToSuperview:(id)arg1;
		- (void)viewDidMoveToWindow;
		- (void)viewWillMoveToWindow:(id)arg1;
		- (id)backgroundSubtextAttributes;
		- (id)backgroundTextAttributes;
	@end
    . Not much too interesting there.
    . Any more patterns?
    . Not so fast…  There's more to the pattern:
              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawVisibleCells:]+0x364
              Finder`0x0000000100364f92+0x6d
              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawWithCurrentRendererInRect:]+0x13d
              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawRect:]+0x324
              Finder`0x0000000100363de0+0xa69
              AppKit`-[NSView _drawRect:clip:]+0xf9b
    . It looks like Finder is calling the IKImageBrowserView category extension method drawVisibleCells.  Can I find that?
    . drawVisibleCells is a method in TIconView!  I'll bet someone is calling that method to paint the whole view.
    . drawVisibleCells is defined as: - (void)drawVisibleCells:(struct CGRect)arg1;
    . Perhaps I could swizzle that method, let it call the super method to do the drawing, then loop through all of the nodes in the view and badge them???
      o To do that, I need a couple of things:
          - A list of the nodes.
          - The drawing rectangle for each node.
      o The controller (TIconViewController.h) has an interesting method: - (struct CGRect)iconFrameForNode:(const struct TFENode *)arg1;
          - If I have a node, that should give me the drawing rectangle for the icon.
          - There are also popoverFrameForNode, and frameForNode with the same signature.
      o The controller has what might be the list of nodes: - (const struct TFENodeVector *)targetNodes;
      o While searching for the TFENodeVector definition, I found an interesting structure:
		struct TIconViewLayout {
		    struct TNSRef<TIconView *> _field1;
		    struct CGRect _field2;
		    struct CGRect _field3;
		    unsigned short _field4;
		    int _field5;
		    struct TFENode _field6;
		    struct TFENodeVector _field7;
		    struct TNSRef<NSMutableDictionary *> _field8;
		    _Bool _field9;
		    struct TIconLayoutDataCache _field10;
		    struct TNSRef<TIconSpatialDataController *> _field11;
		    struct unordered_map<TFENode, Point32, TFENodeHasher, std::equal_to<TFENode>, std::allocator<std::pair<const TFENode, Point32>>, 0> _field12;
		    _Bool _field13;
		    struct CGSize _field14;
		    struct CGPoint _field15;
		    struct vector<TIconLayoutBitmap *, std::allocator<TIconLayoutBitmap *>> _field16;
		};
          - Notice _field7: That is a vector of nodes.
          - Also notice _field16.  That looks like a structure that might hold bitmaps that will be displayed.
          - Could I find those bitmaps in memory, and badge them there, so the standard infrastructure will draw them as badged?  Maybe.  Later…
          - Interesting: TIconViewController is derived from TBrowserViewController.  TBrowserViewController has lots of methods
            to handle vectors of nodes.  They use C++ templates to define the vectors.  For example, TBrowserViewController has the following method:
				TBrowserViewController.h:- (void)getVisibleNodes:(struct TFENodeVector *)arg1;
          - It looks like that one call will populate a TFENodeVector with the currently-visible nodes.  I should be able to iterate over that vector.
          - Do I have the definition of TFENode?  And TFENodeVector?  I have TFENode, which just holds a single pointer to an OpaqueNodeRef (for which I
            don't have a definition).  Then I use dynamic class FINode's to get a FINode from the OpaqueNodeRef.  I don't have the FINode definition either.
            Once I have the FINode, I use dynamic class FINode's previewItemURL method to get a URL and subsequent file path.  Perhaps I can get other
            info from the FINode.  There a lot of definitions I DON'T have!
          - While looking for TFENodeVector, I found a great reference for the "struct map<*>" definitions: 
             . http://mailman.linuxchix.org/pipermail/programming/2004-September/001487.html
             . http://mailman.linuxchix.org/pipermail/programming/2004-September/001486.html
          - I don't have the definition of a TFENodeVector either.  Maybe I can just assume it is a std::vector of TFENodes and build the definition myself?
          - One thing I have already tried and aborted because it was taking too much time to get it right:
             . Write a shell script to chase through all of the Mac OS X executable files and class dump them all.
             . Maybe I would find the definitions of FINode, OpaqueNodeRef, and TFENodeVector.
             . Maybe I should try that again...
      o Let's see how far I get with chasing the nodes of the TIconView without the definitions…..
          - Swizzle the drawVisibleItems method and run it without action code just to print out the call stack at the entry to the swizzled function (TIconView::drawVisibleCells).
          - Very interesting!  I get the following stack:
             . NSView::drawRect calls Finder (I'm not swizzling that method now).
             . Finder calls IKImageBrowserView(ImageBrowserDrawing)::drawRect
             . That function calls IKImageBrowserView(ImageBrowserDrawing)::drawWithCurrentRendererInRect
             . That function calls back into Finder at TIconView::drawVisibleCells.
          - I wonder if I am dealing with an iterator here?
          - Actually, that's just what I would expect from seeing the DTrace above.  This just confirms it, and doesn't add too much more info.
          - One thing to note: drawVisibleCells is passed a rect that is the size of a window (863 x 359), so it seems that it is trying to draw the whole window.
          - In any case, I am looking for some event that happens EARLIER.  I want to catch a hook, let it draw, then do my own drawing.
          - I already hooked the higher-level drawRect function, let it draw, then drew my own badge.  That didn't show, indicating to me
               that someone else came later and drew over top of my image.
          - Wait a minute!  I wonder if drawRect was passing a large window as well, rather than a single icon on the window.  If that's true,
                then maybe drawVisibleCells is the proper method!  Run the drawRect test again and see….
          - Sure enough.  The drawRect passed the same area (863 x 359).
          - As a test, instead of painting our icon, paint a big green rectangle in that area.  Maybe I can see that?  
          - I can't make it paint.  I am using the following code in the swizzled method:
			    CGContextRef myContext = [[NSGraphicsContext currentContext] graphicsPort];
			    CGContextSetRGBFillColor (myContext, 0, 1, 0, 1);
			    CGContextFillRect (myContext, CGRectMake(rect.origin.x, rect.origin.y, rect.size.width, rect.size.height));
          - Is there some other way to get a better context?  Is someone repainting after I do?  I should at least see a flash, but I don't!
          - I want to change the code to the following, but I can't find the UIKit framework on my system????
			    CGContextRef myContext = UIGraphicsGetCurrentContext();
			    CGContextSetRGBFillColor (myContext, 0, 1, 0, 1);
			    CGContextFillRect (myContext, CGRectMake(rect.origin.x, rect.origin.y, rect.size.width, rect.size.height));
          - Research on the web says I need to reinstall Xcode.  Here we go….   Installed iTunes update.  Installing Xcode 4.3.1 from the Mac App store.
          - Wow!  That user experience sucks.  It just sits there and says "Installing", but what is it doing????  I liked the downloaded version better.
          - OK.  Found the downloads page.  It is 1.53 GB.  I guess I'll go do something else……
          - Xcode 4.3.1 installed, but still no UIKit!   Where did it go?
          - OK.  Apparently UIKit is for iOS, and AppKit is for Mac.  Live 'n learn.  But where is UIColor?  Or what replaces it?
          - Apparently that's entirely the wrong code for Cocoa.  It should be something like the following:
			[[NSColor redColor] set];
		    NSRectFill([self bounds]);    
          - I tried that with the drawRect function.  It didn't work again.  :(
      o (3/12/12) Try something different.  Some of the classes deal with nodes, and others with images.  Perhaps they are
         storing images to be used with the nodes?  Maybe I can find the messages that set the images, and brand them
         at the point that they are created, then maybe I can loop through the node tree on a timer setting the proper
         brands for the files?
         - That might work if we only needed to brand once, but to rebrand we would need to create a new instance variable
            dynamically to hold the part of the image under the brand, unless the images are built up of layers.
         - Could we just change the layer?  And have the brand layer be on top of the image?
         - Apparently this is possible.  I grepped for "layer" and there are lots of hits.
         - While researching CALayers (Core Animation), I found a class called NSImageView.  Apparently you can have "layer-backed" NSImageViews.
         - I grepped for "ImageView", and found TIconImageView, which is based on TImageView!   That class has three interesting methods: canChangeIcon, setImage and drawRect.
         - First try swizzling TIconImageView::drawRect.
         - Arrrghh!  Got no hits on drawRect.  However, I tried it again, this time doing everything I could think of with the Finder UI.  I got a hit!  And it painted a red icon!
           However, the red icon was in the upper left corner of the "Get Info" window.  At least that's something.  And this time the "Get Info" worked!  However, I don't
           know what I did to make it work, and why it hasn't worked in the past???
         - So, I need to move away from TIconView.  Apparently that class has nothing to do with the QuickLook icons.
         - Sample code with drawRect, setImage, setImagePath: https://developer.apple.com/library/mac/#samplecode/MyPhoto/Introduction/Intro.html#//apple_ref/doc/uid/DTS10003692
         - Look at TImageView.h.  That inherits from NSImageView, which inherits from NSView.  This is a view for a single image.  Only one interesting method: setImage.
           No drawRect.  No drawRect in NSImageView either.  However, NSView has a drawRect.  Try swizzling NSView::drawRect and painting it red.  I expect to see
           red everywhere!
         - I saw some red!  However, not in the right places.  Now various backgrounds are red.  The "get info" window's background is red.  The preview backgrounds are red, but
           not the preview itself, and all of the QuickLook images are still normal.
         - Try NSImage again.  They must be drawing the images with that.  I never got a hit before, but maybe I should try the other methods.
? – drawAtPoint:fromRect:operation:fraction:
? – drawInRect:fromRect:operation:fraction:
? – drawRepresentation:inRect:
         - Again, it only painted red in the "get info" window in the upper-left corner, and when dragging an item out of the side box.
         - Try FScript again.  Maybe I can see more info?
            . The top view is TFlowView.
            . The main list view area is TIconView (as I have expected????)
            . The large list view area is TIconView too.  Sometimes F-Script shows the whole listview as TIconView, and sometimes it shows it as the individual table cells.
            . An interesting method: TMeetingRoomIconViewCell.h drawImage:
            . I found a really interesting site.  QuickSilver (https://github.com/quicksilver/Quicksilver#readme).
            . That guy makes a QuickLook image for his own use.  See his code in the root/Downloads.
            . His code uses NSBitmapImageRep.  I grepped for that and found TThumbnailImageRep (derived from NSBitmapImageRep).
            . Probably some unknown finder code calls one of the methods in this class (e.g., initWithCGImage:).
            . That class returns an NSImage.  I could badge the image before returning it, but would they cache the modified image? 
            . If they always called one of these methods every time they painted, then that method would work.
            . During research, I noticed that code needs to lock the NSImage before changing the color and painting.  I added graphics save-state and locking code.
            . I tried the NSImage::drawInRect:fromRect:operation:fraction swizzle.  It painted successfully, but it badged the lower left corner of the icon in the upper left corner of the "get info" window.
            . Are there any other trials that need that code?  I checked all of them and added the save-state and lock code.
            . I tried TIconImageView::drawRect again.  It painted the entire icon in the upper left corner of the "get info" window,
            . I tried NSVIew::drawRect again.  It painted the "get info" window background, as before.
            . So, it doesn't seem that these additions have helped.  Reset again…
            . Check out  TPreviewViewController.
            . Check out TQLPreviewView, TQLPreviewViewController, and TQLPreviewViewExtractor.
            . For later: TQLQuickLookToolbarItem.
            . One of the panes in the "vertically sliced" directory view is TBrowserTableView.
            . Apparently the TIconView and TFlowView are using CALayers???  Study that.
            . Tutorial on CALayer (iOS): http://www.raywenderlich.com/2502/introduction-to-calayers-tutorial
            . The only classes implementing drawLayer are the TDesktop* and TDesktopIcon* classes?  Is TDesktop a layer over TIconView?
            . Very interesting from the CALayer guide at: https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/ProvidingCALayerContent.html
		When using Cocoa views you must subclass NSView or UIView and implement drawRect: in order to display anything. However CALayer instances can often be used directly, 
		without requiring subclassing. Because CALayer is a key-value coding compliant container class, that is you can store arbitrary values in any 
		instance, subclassing can often be avoided entirely.
            . Core Animation architecture: https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/CoreAnimationArchitecture.html#//apple_ref/doc/uid/TP40006655-SW1
	     . CALayer constraints, for positioning the layer: https://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/CoreAnimation_guide/Articles/Layout.html#//apple_ref/doc/uid/TP40006084-SW1
            . TView is set up as an NSView with layers.  It implements setWantsLayer.
            . NSView.layer is the CALayer backing layer.  That CALayer has a sublayers array which lists all of the sublayers.
            . Hook TIconView::drawRect again, and determine the number of layers.  There are no layers!!!!!   ARRRRRGGGGHHH!
            . Try hooking the TDesktopIcon::drawRect to look at its layers.  No dice.  No hits.   ARRRRGGGGHHH!
            . Try TOutlineView::drawRect to determine the number of layers.  No hits.   Why so few hits????
            . Try hooking something else, other than drawRect.  I wonder if these classes are being initialized?
            . How about TOutlineView::setLayer:?  That never hit either!!!!!   What next?
          - (3/13/12) Refactored the code to clean it up and get rid of debugging and duplicate code.
            . Start working top-down.  TIconView is the area with the icons.  It must be using layers.
            . TIconView < TImageBrowserView < IKImageBrowserView.
            . IKImageBrowserView has backgroundLayer and foregroundLayer methods.  I checked those.  They are nil.
            . IKImageBrowserView is used to house multiple images and movies.  How are the cells enumerated?
            . IKImageBrowserView has dataSource property.  That is the IKImageBrowserDataSource reference.
            . The IKImageBrowserDataSource implements the numberOfItemsInImageBrowser property.
            . The definition of the numberOfItemsInImageBrowser property is: - (NSUInteger) numberOfItemsInImageBrowser:(IKImageBrowserView *) aBrowser;
            . The image browser (me) asks the datasource how many items (I) will have, passing the image browser (me) as a parameter.
            . Rerun the test and see if I can determine how many items the TIconView has.
            . Yippee Skippee!  There are 38 items in the Applications.
            . What is the representation of one of those items?  Researching…
            . FINodes contain references to the IKImageBrowserDataSource(s):
				FINode-FINodeAdditions.h:#import "IKImageBrowserDatasourceItemPrivate-Protocol.h"
				FINode-FINodeAdditions.h:@interface FINode (FINodeAdditions) <QLPreviewItem, IKImageBrowserDatasourceItemPrivate>
				IKImageBrowserDatasourceItemPrivate-Protocol.h:@protocol IKImageBrowserDatasourceItemPrivate
            . When we hit TIconView::drawRect (the current debugging context), we are painting the entire view.
            . TIconViewController also has: - (_Bool)shouldDrawNode:(const struct TFENode *)arg1 atIndex:(unsigned long long)arg2;
             . There are two "setDataSource" methods on TIconViewController: 
				- (void)setDataSource:(id)arg1; 
				- (id)initWithDataSource:(id)arg1 andViewSettings:(id)arg2 targetPath:(const struct TFENodeVector *)arg3 browserController:(id)arg4;
             . Hook them and ask the data source object to print itself.  setDataSource got no hits.
             . I created a new Finder window, and both hooks were hit!  The data source being set is a TBrowserViewDataSource.
             . The TBrowserViewDataSource specifies the controller, which is TBrowserViewController. 
             . TBrowserViewController has an itemCount property.  
             . It also has a number of viewContextMenu* and showContextMenu* methods.
             . There is also a openQuickLookNode, and quickLookSharedPreviewViewForPreviewNode, and getQuickLookNodes.
             . Also ensureCGSurfaceUpdateOnDraw, and iconSizeForView, and iconSize,.
             . Where can I find the list of nodes?????  I don't see it in TBrowserViewController, or in TBrowserViewDataSource.
             . However, there is a getVisibleNodes in TBrowserViewController.  If I assume that the items in the data source are TFENodes, that should be all I need.
             . So, how can I find and paint the image associated with a TFENode?
             . I think I would hook TIconView::drawRect and at that point, enumerate the nodes, find the bounds of each node, and the path of each node, and draw the
               badge into the proper node bounds.  That seems possible, but I haven't been able to draw such that I can see anything changed!!!
             . The other way would be to enumerate the windows and nodes on each window on a timer, draw to the nodes in some way under a focus freeze, and then
               invalidate the area drawn.  Hopefully the badge would show on the screen.
             . I haven't found any evidence of layers.  The count is always zero.
             . However, maybe I should create a new Finder window.  Maybe the layer would be set then.  Try that. 
             . I opened a new window, and TOutlineView::setLayer didn't hit.
             . How about trying TIconImageView while opening a new window?  Try that.
             . That didn't work on the main icons, but it painted the "get info" icon red again.
          - (3/14/12) Working on IKImageBrowserView, and related items.
             . An IKImageBrowserView has and IKImageBrowserViewDataSource.  That is the model.  It contains the data to display.
             . An IKImageBrowserView has many IKImageBrowserItem(s).
             . Each of the IKImageBrowserItem(s) holds a pointer to the image to display (imageRepresentation).  It also holds the type of the image (imageRepresentationType).
             . I want to catch Finder at the point where it has completed drawing, and then draw myself:
               o Where is that?  TIconView::drawRect?  That is the drawing function for the entire pane.
               o I would like to catch it at the cell level.  Is that TIconViewCell?  Which is derived from IKImageBrowserCell.
               o Is there a drawRect at the cell level?  There should be, but where?
               o TIconViewCell has an invalidate method.  That should make it redisplay if we need to brand it when status changes (assuming we can find it).
               o Since TIconViewCell is derived from IKImageBrowserCell, then it has all of the methods defined there.
               o Two interesting IKImageBrowserCell methods:
                   - layerForType:  This returns the CALayer used for drawing.  It can be background, foreground, selection or placeholder.
                   - representedItem:  This is the item that is displayed.  The representationType should specify the class (e.g., NSImage?)
               o From the image-browser-appearance sample, IKImageBrowserView has a drawRect.
               o That sample also creates the CALayer used for the cell drawing.
               o An idea:  Even if a method derived from NSView doesn't have a subclassed drawRect method, maybe I could add one?
               o From the sample, the cell's foreground CALayer is filled with a CGImage via the layer's setContents() method.
               o I can't find a use of setContents in Finder.
               o From the sample, the view's drawRect calls each of the IKImageBrowserCell's layerForType function.  The layerForType function provides the images via SetContents that will be drawn.
               o It seems that the app adds a new piece of data to the datasource, then calls the IKImageBrowserView's reloadData member.  That member queries the datasource about how many items there are.
                  If a new cell is needed, the framework will call IKImageBrowserView's newCellForRepresentedItem member.  That member can be overridden to alloc and init a
                  specific app cell class derived from IKImageBrowserCell.  In the sample app's case, that is the ImageBrowserCell, derived from IKImageBrowserCell.
               o So, given an IKImageBrowserView::drawRect event, how in the *&^(*&^ do I enumerate the cells and paint them?
               o Or, can I dynamically add a drawRect for a cell?  Start with how to find the cell collection.
               o It turns out that TIconView has a newCellForRepresentedItem member!  It actually has two definitions, but only the first is a subclass of IKImageBrowserView:
				- (id)newCellForRepresentedItem:(id)arg1; 
				- (id)newCellForRepresentedItem:(id)arg1 useSubClass:(BOOL)arg2;
                o So, IKImageBrowserView asks TIconView for a new cell, but IKImageBrowserView really holds the collection, not the Finder app code.
                o However, TIconViewController implements the IKImageBrowserItem protocol, and I can find out how many cells there are via numberOfItemsInImageBrowser.  Then
                   I can retrieve the items (cells?) via TIconViewController::imageBrowser:itemAtIndex.
                o If my assumption is correct, that an item is really a cell, then I can enumerate the cells.
                o Since those are items, at least I can find other info, like the image representation type, and the imageRepresentation, and imageUID.
                o I'll start with that.
                   . Hook TIconView::newCellForRepresentedItem and print the input arg1 and returned id.
                   . Hook TIconViewController::numberOfItemsInImageBrowser and trace the number.  Also loop through that count and call TIconViewController::imageBrowser:itemAtIndex:, tracing.
                o newCellForRepresentedItem arg1 is a FINode.  The method was called by IKImageBrowserView.  The super method returns a finder_IKFinderCell.
                o numberOfItemsInImageBrowser returned 0!  The IKImageBrowserView passed in is a TIconView.  Why no items?????
                o I ran it again, and this time put it on the proper icon view in the Applications folder and got 38 items again.
                o The caller of this method is IKImageBrowserView(ImageBrowserDatasource)!
                o All of the items are FINodes!  Of course I don't have the FINode definition.   ARRRRGGGGHHH!
                o I wrote the code to print out the class hierarchy of the FINode.  I got it and put it in the DTrace folder.  
                o Interesting: A FINode is not an IKImageBrowserCell, as I had hoped.  However, it includes all of the methods added by Finder via the
                   FINode-FINodeAdditions.h header file, which I have.  And my printout includes all of the FINode methods and properties!
                o Now I can enumerate these things, but how do I get the IKImageBrowserCell which is what is actually drawn (I think)??????
                o Print out the info for some of the FINode methods and properties.
                o Here are some of the FINode results:
				3/14/12 1:37:58.469 PM Finder: isInIconView: _.
				3/14/12 1:37:58.469 PM Finder: imageLabel: 0.
				3/14/12 1:37:58.469 PM Finder: previewItemLocalizedDescription: Document.
				3/14/12 1:37:58.470 PM Finder: previewItemDisplayName: .DS_Store.
				3/14/12 1:37:58.470 PM Finder: previewItemURL: file://localhost/Applications/.DS_Store.
				3/14/12 1:37:58.470 PM Finder: previewItemTitle: .DS_Store.
				3/14/12 1:37:58.473 PM Finder: imageRepresentationType: <IKImageBrowserPromisedRepresentationType>.
				3/14/12 1:37:58.473 PM Finder: statusInfo: <(null)>.
				3/14/12 1:37:58.473 PM Finder: imageUID: <Icon 5951d8a0 0x7fff7ca4cb40>.
				3/14/12 1:37:58.473 PM Finder: imageLabel: <0>.
				3/14/12 1:37:58.473 PM Finder: imageTitle: <.DS_Store>.
                o I found a definition of TFENode and TFENodeVector at: http://paste.lisp.org/display/94546
				typedef struct {
					NodeRef fNodeRef;
					CFTypeRef dummyValue1;
					CFTypeRef dummyValue2;
					CFTypeRef dummyValue3;
					CFTypeRef dummyValue4;
				} TFENode;
				typedef struct {
					TFENode *_M_start;
					TFENode *_M_finish;
					TFENode *_M_end_of_storage;
				} _Vector_impl;
				typedef struct {
				    _Vector_impl _M_impl;
				} TFENodeVector;
				TFENodeVector vector= {0}; // uses bzero to initialize all members to 0
                o Here's one with a class definition: https://llvm.org/svn/llvm-project/llvm/tags/RELEASE_28/test/FrontendObjC++/2010-08-02-NonPODObjectValue.mm
                o Paint icon labels: http://code.google.com/p/fileview/source/browse/trunk/fileview/FVFinderLabel.m
                o One thing to try: Hook IKImageBrowserCell* methods.
                o Aha! TIconViewController derives from TBrowserViewController, and the latter implements getCellForNode: (TFENode *).
                o That should get me the TIconViewCell.
                o Interesting: TBrowserViewController implements the reloadData method.  When called, that triggers IKImageBrowserView to update all its cells and setNeedsDisplay to repaint.
                   As noted above, IKImageBrowserView will then drive all of the cells to provide their images, which IKImageBrowserView will then render under the covers.
                o TBrowserViewController also includes itemcount, showContextMenu, ensureCGSurfaceUpdateOnDraw, iconSizeForView, iconSize.
                o Interesting: DesktopImage sample shows how to get the selected items.
                o IKImageBrowserDatasourceItemPrivate-Protocol.h has an imageToDrawForCell (id) arg1 method.
                o Try this:  Hook the TIconViewController::reloadData method.  In the hook, enumerate the cells and print the layer info.  Maybe there is a background layer? 
          - (3/15/12) I had a better idea overnight.  There is no reason we can't add a method, rather than just replacing methods.  Add a method to TIconViewCell.  That should be
            the object that is created in TIconViewController's newCellForRepresentedItem.  Add the layerForType method.  Th ImageKit framework should try to find that method
            on the created cell, and if it is not found, pass it up the chain to the super, which would be the cell the ImageKit created.  Try that.
                o Interesting description of the internals of Objective C for debugging: https://www.cs.indiana.edu/classes/c304/ObjC.html
                o A great description of Objective C meta-classes: http://cocoawithlove.com/2010/01/what-is-meta-class-in-objective-c.html
                o I added the TIconViewCell::layerForType method.  Everything looks right, but it didn't hit????
                o Instead, swizzle IKImageBrowserCell::layerForType and see if that hits.
                o I got hits on that.  Background and Foreground, but the layer returned is null:
				3/15/12 7:42:24.904 AM Finder: IKImageBrowser::layerForType: called.
				3/15/12 7:42:24.904 AM Finder: IKImageBrowser::layerForType: arg1. IKImageBrowserCellBackgroundLayer.
				3/15/12 7:42:24.905 AM Finder: IKImageBrowser::layerForType: Returning (null) produced by super.
				3/15/12 7:42:24.905 AM Finder: IKImageBrowser::layerForType: called.
				3/15/12 7:42:24.905 AM Finder: IKImageBrowser::layerForType: arg1. IKImageBrowserCellForegroundLayer.
				3/15/12 7:42:24.905 AM Finder: IKImageBrowser::layerForType: Returning (null) produced by super.
                o Print out some of the cell info.
            - (3/16/12) Back onto the swizzling project.  Look at the DTrace for DB.
            - I ran that in the DTrace directory.  logDBAddingFile.txt.  I really need the Finder trace while doing that.
            - Try hooking TIconImageView::setImage, and TIconImageView::drawRect:.  Neither of those had any hits.
            - I see IKImageBrowserView::drawRect … IKImageBrowserView::drawVisibleCells.
            - This is an important entry:
 				 0  26410               objc_msgSend:entry [<nil> drawWithComponentMask:]
				              libobjc.A.dylib`objc_msgSend
				              DropboxBundle`dropboxDrawImp+0xc
				              Finder`0x000000010ac193e9+0xdb
				              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawVisibleCells:]+0x53a
				              Finder`0x000000010ac10f92+0x6d
				              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawWithCurrentRendererInRect:]+0x13d
				              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawRect:]+0x324
				              Finder`0x000000010ac0fde0+0xa69
 				             AppKit`-[NSView _drawRect:clip:]+0xeae
				              AppKit`-[NSView _recursiveDisplayAllDirtyWithLockFocus:visRect:]+0x62f
				              AppKit`-[NSView _recursiveDisplayAllDirtyWithLockFocus:visRect:]+0xa5b
				              AppKit`-[NSView _recursiveDisplayAllDirtyWithLockFocus:visRect:]+0xa5b
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x408
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSThemeFrame _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x10e
				              AppKit`-[NSView _displayRectIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:]+0x1293
 				             AppKit`-[NSView displayIfNeeded]+0x68c
            - Dropbox has hooked some Finder drawing method (drawRect:?), probably at the cell level, since we are drawing visible cells.  Dropbox is sending a drawWithComponentMask: message.
            - In the next entry, IKImageBrowserCell::drawWithComponentMask: handles the message and sends a delegatesImageManagementToDatasource messages:
 				 0  26410               objc_msgSend:entry [<nil> delegatesImageManagementToDatasource]
				              libobjc.A.dylib`objc_msgSend
				              ImageKit`-[IKImageBrowserCell drawWithComponentMask:]+0x8d
				              DropboxBundle`dropboxDrawImp+0xc
				              Finder`0x000000010ac193e9+0xdb
				              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawVisibleCells:]+0x53a
				              Finder`0x000000010ac10f92+0x6d
				              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawWithCurrentRendererInRect:]+0x13d
				              ImageKit`-[IKImageBrowserView(ImageBrowserDrawing) drawRect:]+0x324
				              Finder`0x000000010ac0fde0+0xa69
				              AppKit`-[NSView _drawRect:clip:]+0xeae
				              AppKit`-[NSView _recursiveDisplayAllDirtyWithLockFocus:visRect:]+0x62f
				              AppKit`-[NSView _recursiveDisplayAllDirtyWithLockFocus:visRect:]+0xa5b
				              AppKit`-[NSView _recursiveDisplayAllDirtyWithLockFocus:visRect:]+0xa5b
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x408
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSView _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x16bd
				              AppKit`-[NSThemeFrame _recursiveDisplayRectIfNeededIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:topView:]+0x10e
				              AppKit`-[NSView _displayRectIgnoringOpacity:isVisibleRect:rectIsVisibleRectForView:]+0x1293
            - Neither drawWithComponentMask: nor delegatesImageManagementToDatasource is documented.
            - That is the beginning of the process.  Lots of traces are probably just Dropbox letting super do its job.
            - Eventually, super is done.  Then it looks like Dropbox is called at dropboxLayerForTypeImp.  That is obviously its layerForType method!  So Dropbox has
              subclassed a layerForType method!  That is what I was trying to do.   TODO: Try that with a test app.
            - FScript can dynamically add classes: http://www.fscript.org/documentation/CreatingCocoaClassesWithFScript/index.htm
            - Test app.  Use IconBadge, and just change the target app from Finder to the test.  Use one of the sample programs as the target.  One that does not subclass layerForType.
            - Before the test app:  The most obvious choice for the cell is TIconViewCell.  I want to see if they are used.  I hooked TIconViewCell::drawTitle.  It didn't hit.
            - When IKImageBrowserView asks for the new cell object, what is the type of the object returned?  I have already done that!
            - I hooked TIconView::newCellForRepresentedItem.  TIconView's implementation of that method returns a finder_IKFinderCell.  I never paid any attention to that.
            - Reimplement that hook, and print out all of the stack and class hierarchy info for the finder_IKFinderCell.
            - Eureka!  That's it.  finder_IKFinderCell is derived from IKFinderCell, is derived from IKIconView, is derived from IKImageBrowserCell.
            - I saved the file in the DTrace directory as FinderSwizzleTIconView--newCellForRepresentedItemPrintStackAndHierarchyForFinder_IKFinderCell.txt.
            - Hook the finder_IKFinderCell::draw method.  Let it draw.  Then see if I can get the image, overlay a badge and have it draw again.  Then try overlaying the badge first.
            - Where can I find the image?  That should be IKImageBrowserCell::imageToDrawForCell.  Print out the class name of that object at the hook.
            - Big problem:  Looks like it involves forwarding.  I can hook finder_IKFinderCell::draw (that's the only method).  That class derives from IKFinderCell, which
              derives from IKIconCell, and then IKImageBrowserCell.  However, when I drive the original implementation of finder_IKFinderCell::draw, I get the following:
				3/16/12 3:28:48.766 PM Finder: -[IKImageCell SW_finder_IKFinderCell_draw]: unrecognized selector sent to instance 0x7fab9eaaa630
            - Apparently, one of the classes took the message and forwarded it to IKImageCell???  I don't understand forwarding.  Look into it…..  Another timewaster…
            - Try adding that method (SW_finder_IKFinderCell_draw) to IKImageCell, and just pass it on.  Will that work????
            - That actually worked, but I tried to just pass it to a "draw" method on IKImageCell.  It doesn't have one.
            - When I drive the original finder_IKCell::draw method, I wonder why the forwarding mechanism (whatever it is?) is passing along the renamed selector name
              (SW_finder_IKFinderCell_draw)???  What if I just call my implementation "draw"?  Would it leave the name alone then?  Try it.
            - I see.  That won't work.  To swizzle, I have to add a method with a different name (than "draw", the overridden method), then exchange the implementations.
              My overridden implementation gets control when others send the "draw" message, and my method sends the "SW_finder_IKFinderCell_draw" message to the
              object to cause the original implementation to be executed.  The trouble is: Somehow the original implementation is using the changed method name in the
              forwarding process.  What do I do now???
            - How about this?  Hook TIconView::drawRect.  Set a global to say that method is "busy working".  Then hook some cell-level method.  But which one????
            - TIconView is the controller for all of this.  I notice that TIconView::drawRect ends up with IKImageBrowser::drawVisibleCells.  Could that method be driving
              TIconView::drawVisibleCells?  Hook it and see.  Also, hook TIconView::shouldDrawCell:.   Also drawBackground.  And DrawBackgroundPattern. And ViewWillDraw.
               And setDelegate.  Print the type of the delegate.
          - (3/17/12) Do the above, but first see if IKIconCell::drawImage (or others) are hit.  DB hits that.  The DB trace shows no IKImageCell hits.
            . That hit.  The argument is an IKImageWrapper:
			3/17/12 6:03:28.173 AM Finder: IKIconCell::drawImage: arg1: IKImageWrapper 0x7fba33492410 [path:(null) dataRep:(null) bitmapRep:(null) proxy:(null) openglID:1 cachedSize:{64, 64} volatileType: 4 volatileRep:(null) quality:2].
            . The stack shows that drawImage is called by IKImageBrowserCell::drawWithComponentMask:  I have seen that a lot.  Hook that.  It takes an int and returns void.
            . That is hit as expected.  The arg1 is always 511.  See if I can get IKImageBrowserCell::imageFrame, and paint it red.
            . I can get imageFrame, and I tried to paint it red, but it didn't happen (again)!  ARRRRGGHHH!  I can see the proper icon coordinates in the trace.
            . Maybe I need to invalidate.  Try that.  That didn't work either!  And I really expected it to work!  Why is this so difficult?
            . They MUST be using layers somehow.
            . I found this here: http://code.google.com/p/imedia/source/browse/trunk/IMBImageBrowserCell.m?r=947
             // Draw the image itself. In the case of an IMBNodeObject (which is represented as a large folder icon)             // we should draw a small badge icon on top of the large folder icon. This si used to distinguish various              // kinds of subnodes visually (e.g. iPhoto events, albums, etc)...             //- (void) drawImage:(id)inImage             //{             //      [super drawImage:inImage];             //                   //      id datasource = self.dataSource;             //                   //      if ([datasource isKindOfClass:[IMBNodeObject class]])             //      {             //              IMBNode* node = (IMBNode*) datasource;             //              NSImage* icon = node.icon;             //              NSRect frame = [self imageFrame];             //              CGFloat x0 = 20; //NSMidX(frame);             //              CGFloat y0 = 20; //NSMidY(frame);             //              CGFloat dx = 16.0;             //              CGFloat dy = 16.0;             //              frame = NSMakeRect(x0-0.5*dx,y0-0.5*dy,dx,dy);             //              [icon drawInRect:frame fromRect:NSZeroRect operation:NSCompositeSourceOver fraction:1.0];             //      }             //}            . Maybe this will work?  First find out the type of the datasource.  It's a FINode.  No surprise.
            . Does a FINode have and icon instance method?  Not that I can see.
            . Print the IKImageBrowserCell::cellState.  Looking for IKImageStateReady (value 2).  That means the thumbnail image has been prepared and is ready to display.
            . Also print isInIconView, previewItemURL, imageRepresentationType, imageUID, nodeRef (OpaqueNodeRef ), imageToDrawForCell, 
            . Interesting. cellState is 2.  Good.  However, isInIconView blows up, because the system thinks the self class is IKImageCell!  I hooked IKImageBrowserCell.
              More message forwarding going on?  Print the self class, and get a full class hierarchy for IKImageCell.
            . Interesting.  I hooked IKImageBrowserCell::drawWithComponentCell.  However, in the hook, the self class is finder_IKFinderCell, and the self superclass is
              IKFinderCell, and if I try to send the isInIconView to what I thought was a FINode (self), Finder crashes and says that IKImageCell doesn't support the isInIconView
              message!   What a mess.  Lots of message forwarding going on???
            . Just try to get the icon anyway.  Maybe it will be found.  FINode doesn't have an icon.  However, when coding this I realized that I needed to use the datasource
              (FINode) to print the stuff above, not self, although what I found out about self is certainly interesting.
            . Good stuff: isInIconView is TRUE.  imageRepresentationType is IKImageBrowserQuickLookPathRepresentationType.  imageUID is IconPreview.  
            . imageToDrawForCell wasn't found, because it needs a parameter.  Try [datasource imageToDrawForCell:self].  That worked, but it is null. 
            . Searching for IKImageBrowserQuickLookPathRepresentationType, I found this code: http://imedia.googlecode.com/svn-history/r844/trunk/IMBObjectThumbnailLoadOperation.m 
            . SparkleShare uses static badging.  Here's the code: https://github.com/hbons/SparkleShare/blob/master/SparkleShare/Mac/SparkleBadger.cs
            . DB hooks layerForType.  That is called when IKImageBrowserCell calls drawOverlays.  "Overlays" sounds nice.  Hook IKImageBrowserCell::layerForType and
              provide an overlay layer.  Get the code from the sample.  I made need to know that I am doing this for a particular type of node/cell.  A higher-level hook could set a
              global "busy" flag so this could be determined.
            . I hooked IKImageBrowserCell::layerForType:.  Here is an example trace:
			3/17/12 9:44:34.973 AM Finder: IKImageBrowser::layerForType: called.
			3/17/12 9:44:34.973 AM Finder: IKImageBrowser::layerForType: type: IKImageBrowserCellForegroundLayer.
			3/17/12 9:44:34.973 AM Finder: IKImageBrowser::layerForType: Returning (null) produced by original overlaid method implementation.
			3/17/12 9:44:34.973 AM Finder: IKImageBrowser::layerForType: cellState: 2.
			3/17/12 9:44:34.973 AM Finder: IKImageBrowser::layerForType: frame: x: 678.571429. y: 228.000000. w: 132.000000. h: 108.000000.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: imageAlignment: 0.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: imageBrowserView: <TIconView: 0x7faf63dd9590>.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: imageContainerFrame: x: 678.571429. y: 228.000000. w: 132.000000. h: 108.000000.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: ImageFrame: x: 712.000000. y: 268.000000. w: 64.000000. h: 64.000000.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: indexOfRepresentedItem: 35.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: isSelected: 0.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: opacity: 0.000000.
			3/17/12 9:44:34.974 AM Finder: IKImageBrowser::layerForType: representedItem: <FINode 0x7faf62e05fb0>.
			3/17/12 9:44:34.975 AM Finder: IKImageBrowser::layerForType: selectionFrame: x: 708.000000. y: 264.000000. w: 72.000000. h: 72.000000.
			3/17/12 9:44:34.975 AM Finder: IKImageBrowser::layerForType: subtitleFrame: x: 678.000000. y: 235.000000. w: 132.000000. h: 11.777344.
			3/17/12 9:44:34.975 AM Finder: IKImageBrowser::layerForType: titleFrame: x: 727.000000. y: 247.000000. w: 33.000000. h: 16.000000.
            . Modify the code to provide an overlay image.  Implement the code if the original implementation returns null (as above).
            . Doesn't work yet, but I found this in my research: 
		- add an overlay layer with setForegroundLayer: (that's the easiest solution but it is SnowLeopard only).
            . I seem to recall that these layers must be enabled somehow before they will work.  Researching…
            . I think this is the reference.  I might have to dynamically add and subclass IKImageBrowserCell like this: http://stackoverflow.com/questions/4880916/can-ikimagebrowserview-display-multi-line-titles
            . Finally!  The big icons are badging properly!  I implemented the foreground CALayer in IKImageBrowserCell::layerForType, and asked it to redisplay itself!
            . I found 4 128x128 icons on the web.  Only one of them has a transparent background.  They work, including the transparent one, but the icons don't get larger
              when I make the Finder icons larger.  Maybe that's because I only filled in the 128x128 slot in the .icns files?
            . Find four 512x512 images and add those to the .icns files.  Do the icon sizes change now?
          - (3/18/12) Cleaning up the code, deleting debug code, and duplicate code.
            . Looked at appledoc and installed it.
            . Some of the listview icons don't appear (.png, .pdf, .jpeg, etc.), and the "Get Info" function is broken when swizzling the listview.
            . The "get info" function is broken as soon as I reference [self node] to get the TFENode.  It seems that just sending the node message to self break it.  Why?
            . Could it be because DropBox is running too?  No.  I stopped it, and the simple reference to [self node] seems to break it.
            . When TIconAndTextCell::drawIconWithFrame is hit, self is the following: TColumnCell < TListViewIconAndTextCell < TNodeIconAndNameCell <
              TIconAndTextWithActionCell < TIconAndTextCell <TTextCell < NSTextFieldCell < NSActionCell < NSCell < NSObject.
            . node is defined from self in TNodeIconAndNameCell.  In fact, it is a TFENode.  Maybe I could go up the super chain and get the node value directly?
              That's a deep subject.  See the reference: Supersequent method invocation: http://cocoawithlove.com/2008/03/supersequent-implementation.html
            . This is wierd.  Now self is TIconAndTextCell at the same invocation!  Maybe I need to check the self class???
          - (3/19/12) Keep dictionaries of the self class before and after driving the original implementation.
            . That test showed that there are two classes that are presented, and they don't seem to change self before and after the call to the original implementation.  The
              two classes are TColumnCell and TIconAndTextCell.  TColumnCell has the node definitions in the hierarchy.  TIconAndTextCell doesn't.
            . Try limiting the processing to the TColumnCell class.
            . In this test I saw TListViewIconAndTextCell and TColumnCell, but not TIconAndTextCell.  Also I saw no list view icons.  Repeat the test, but ask if the
              self class implements node before sending the message.
            . That fixed the "get info" problem!  However, the pdf icons are still not appearing.  
            . Make a test directory with just a few pdf files.  Delete all of the Dropbox folder files.  Add a single .pdf file in list view mode and run DTrace to capture the messages.
            . Dropbox function runMachine looks like it is the timer that schedules cell display.  There is also a method scheduleCellDisplay.
            . Dropbox hooks TListViewIconAndTextCell::drawIconWithFrame.  They are keeping a variable lastPath from some other previous hook.
            . It looks like all they do is set the lastPath (setLastPath) at that hook.  They will use it at a later hook?
            . The timer loop does something to cause an [NSWindow displayIfNeeded] message.
            . They call a function "getCellURLFromAccessability".  Looks like they are scanning the class hierarchy.
            . It looks like they are hooking TableView and setting a delegate to get events from the table view???
            . I ran another test.  They are hooking TSidebarItemCell::setImage, and calling a function called isURLToDropbox.
            . That results in a call to DesktopServicesPriv::NodeIs.
            . Dropbox is hooking TSidebarItemCell::setImage, and sending a setImage message (fielded by NSImageTextFieldCell), and then a setObjectValue message
              (fielded by NSImageCell::setObjectValue).  The setObjectValue: message provides an NSImage object.  Maybe the setImage message causes the setObjectValue:
              message?
            . There is no setImage method in TSidebarItemCell.  Dropbox must be swizzle-adding that method to TSidebarItemCell.  Try that and see if I get a hit.
            . Researching: I found a site that shows setImage: http://stackoverflow.com/questions/6335871/nsimagecell-change-image-problem
			id dataCell = [self dataCellWithID:@"cellID" andRow:listRow];
			if (dataCell && [dataCell isKindOfClass:[NSImageCell class]]) {
			    NSImageCell *statusIconCell = (NSImageCell *)dataCell;        
			    [statusIconCell setImage:[NSImage imageNamed:[self syncIconNameForStatus:syncState]]];  
			    [[statusIconCell controlView] setNeedsDisplay:YES];
			}
             . I tried adding TSidebarItemCell::setImage, and looking up the chain for the setImage implementation to invoke.  The hook never hit.
             . I tried hooking NSImageView::setImage.  That never hit.
             . I tried hooking TImageView::setImage.  That never hit.
             . Hooking NSImageTextFieldCell::setImage.  That hits, but crashes.  Working on that for a couple of hours now…  The stack shows that NSTableView
               calls Finder, calls our hook.  The crash happens as soon as we call the original implementation.  The self class is TSidebarItemCell.  That class doesn't have
               a setImage method, which might be why the crash is happening.  Maybe I need to use the superSequent method?  The next class up the hierarchy is
               NSImageTextFieldCell.  That class has our added (swizzled) method SW_NSImageTextFieldCell_setImage:.  It also has the (swizzle-overlaid) method setImage:.
               Both of the swizzle methods have the same signature.  Try the superSequent method.  That worked!  No more crashes.  Now it does the same thing it did
               before.  I just need to badge the image.
             . I think I badged the image and then set it, but it didn't show.  Maybe I need to force a redraw.  There is no setNeedsDisplay in the hierarchy.  There is a controlView.
               That controlView should be an NSView, and it should support setNeedsDisplay.  Try that.
             . That executed, but the badge didn't display.  It seems that I need to catch it in the draw* methods, but that's not what Dropbox seems to do.  Study the Dropbox
                trace again.
             . We ARE in the middle of a drawRect:!  That results in a setImage from Finder.  Dropbox hooks that and looks up its URL to see if it is a file it cares about.
               Dropbox then sends a setImage: message to NSImageTextFieldCell.  Dropbox then sends a setObjectValue: message to NSImageCell.  Maybe that's what I am
               missing.  Try to send that message, but how did Dropbox get the NSImageCell?  That's not in the hierarchy.  Maybe it's not in the particular trace I am looking at?
               Add code to test if self responds to that message, and if so, send it.  Try that.
             . That executed, but it didn't help with the badging.  
             . Dropbox is also hooking TListViewIconAndTextCell::drawIconWithFrame.  It seems to send an isViewBased msg to NSTableView(NSTableViewViewBased).
               Dropbox then sends a controlView message (to query the current controlView?).  Then it queries the Dropbox URL.  
          - (3/20/12) I hooked TListViewIconAndTextCell::drawIconWithFrame, and did the same processing as in TIconAndTextCell::drawIconWithFrame.  That worked!  Now
               I am badging the redrawn icons (.pdf, .jpeg, .png, etc.).
           - (3/20/12) Switch to a project to write a manual test program that will allow selection of a file, and buttons to badge the file with various status icons.  The test
             program should also have a mode where it automatically changes status every 1/2 second and rotates the status through the entire list of possibilities.  This
             program will test the ability of the badging system to notify Finder to redraw the icon when the status is changed.
             . Sending Finder a refresh event: http://stackoverflow.com/questions/8892246/how-to-refresh-finder-window
             . GCD threads for long-running tasks: http://stackoverflow.com/questions/4645481/sheets-and-long-running-tasks
             . The manual test program works, and it is badging list-view icons, but the large icons are not badging.  It turns out that the node method is not available for
               IKImageBrowserCell objects.  How can I find the corresponding node, so I can find the associated path?
             . Make a new stack and class hierarchy dump at IKImageBrowserCell::layerForType:. 
               o Called by IKImageBrowserCell::drawBackground.  self is finder_IKFinderCell.  This is the one that was involved with the message forwarding!  YIKES!
               o From my notes above, the [self representedItem] is a FINode!  I should be able to get the path from there.
               o It works!  Now only the Flow-list view doesn't refresh when the badge is changed.
           - (3/21/12) I'm guessing that the Flow-list view is getting different hits on the TListViewIconAndTextCell::drawIconWithFrame hook.  Run it again and list the self
             classes that hit.
             . Two classes hit (TListViewIconAndTextCell and TColumnCell).  I tried ignoring TListViewIconAndTextCell.  That didn't badge at all.  Then I tried ignoring
               TColumnCell.  It worked as before.  I deleted the "ignore" code.
             . Great MacOSx tips: http://www.macosxtips.co.uk/index_files/category-terminal.php
             . That bug turned out to be an Apple bug.  Finder doesn't react to the Apple Event.  Dropbox has the same issue.
             . Context menu reference: http://osdir.com/ml/cocoa-dev/2009-08/msg01498.html
             . I pushed it to the cloud.  Badging works.  The badges are in the proper place.  Apple bug exists.  I am ignoring it.  The badge quality needs some work.
             . What's next?
           - (3/22/12):
             . Fixed the registerName bug.  It was using a name server on the entire local LAN loop!
             . Working now on the root service that will inject Finder on behalf of users.
               o Added a new option to IconBadge (-service).  This will run a /Library/LaunchDaemons launchd service as the root user.
               o Accepts user registrations and unregistrations.
               o Injects the Finder for that user.
               o Watches all Finders for all registered users.
               o Reinjects Finders if Finder is restarted.
             . Changed direction on the implementation of the Finder server communication and processing.
               o Use the HTTP communication used in ClAppDelegate.
               o Finder will tell the the user's Cloud app when it has started.
               o The user's Cloud app will then enumerate the entire directory setting badges for the files.
               o What if Finder crashes?  The Cloud app won't know.  The badge messages will just be ignored.
               o When Finder restarts, the Service will reinject Finder on the user's behalf.
               o Finder will send the user's Cloud app a restart message.
               o The user's Cloud app will rebadge everything.  
               o There may be a stray single badge message received.  The Finder server will ignore this until it receives the initial Cloud directory rebadge batch.
               o Do we need responses from the HTTP requests?  Check out th capability of this transfer mechanism.  We may need to implement responses
                  as separate messages in the other direction.
               o Launchd plist editors: http://superuser.com/questions/36087/how-do-i-run-a-launchd-command-as-root
               o Base64 codec: http://cocoawithlove.com/2009/06/base64-encoding-options-on-mac-and.html
               o Object serialization: http://cocoaheads.byu.edu/wiki/nscoding
               o More Base64: http://www.cocoadev.com/index.pl?BaseSixtyFour
               o I changed back to using Distributed Objects (DO).  I couldn't make a debug environment that worked, and the URL approach puts an ugly dialog
                  in front of the user's face if a process is not running to catch it.
           - (3/23/12):
             . Study GCD.
             . A good guide to GCD: http://cocoasamurai.blogspot.com/2009/09/guide-to-blocks-grand-central-dispatch.html
             . KeyValueCoding (KVC): http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueCoding/Articles/Compliant.html#//apple_ref/doc/uid/20002172-BAJEAIEE
             . KeyValueObserving (KVO): http://developer.apple.com/library/mac/#documentation/Cocoa/Conceptual/KeyValueObserving/Articles/KVOCompliance.html#//apple_ref/doc/uid/20002178-BAJEAIEE
             . KVO+Blocks: http://blog.andymatuschak.org/post/156229939/kvo-blocks-block-callbacks-for-cocoa-observers
             . More KVO+Blocks: https://gist.github.com/1370212
             . I'll use NSOperationQueue, rather than the low-level GCD.  That fits in with the KVO+Blocks.
             . I'll need a "User" object.
             . The User object will be:
               o Created at User registration.
               o Deleted at User un-registration.
               o Responsible for monitoring the user's Finder process.
               o Responsible for injecting (or re-injecting) the user's Finder process.
               o Responsible for opening a DO connection to the user's Cloud process.
               o Responsible for notifying the user's Cloud process that Finder has restarted.
               o Responsible for terminating itself on any error registering to the user Cloud process.  When the user's Cloud process
                  restarts, the Cloud process will re-register the user, which will create the User object again.
               o Responsible for cleanly terminating itself when a un-registration message is received.
             . The server will accept messages from multiple users.  Currently only RegisterUser and UnregisterUser.
             . RegisterUser will pass the userName and pid.
             . UnregisterUser will pass the userName.
             . The Finder monitoring task will be running on an independent thread.
             . Finder monitor:
               o Polls on a timer.
               o Able to locate the PID of the Finder process associated with the user.
               o Watch the Finder's PID.
               o If the Finder's PID vanishes, set the Finder PID to NULL.
               o If we locate the Finder's PID, and it is different from the saved PID, send a FinderChanged message to the Cloud process.
               o If an error occurs while sending the Cloud message, terminate the user object.
             . Any error noticed by the monitor will execute a block on the main thread, passing a pointer to the user object involved.
               The block will call the terminate method on the user object.  That way, all terminations will be on the main thread.
             . The main thread will start and stop the monitors.
             . How do I locate finder for a particular user?  That took me about 2.5 hours!  I finally have code that walks all of the processes, printing the process name,
               pid, uid, and the username!
             . If a RegisterUser message arrives, and the user is already registered, terminate the current user object, then instantiate and initalize the new one.
             . In-memory database:
               o (NSDictionary) Users: registered usernames vs. UserObjectRefs.
               o UserObject: The user object.  Properties:
                  - pidFinder
                  - pidCloud
                  - etc.
             . DO registered names:
               o Cloud_<username>: The Cloud.app for <username>.
               o IconBadgeServiceApi: Daemon.
             . A good NSOperationsQueue example: http://www.chrisboyd.net/2011/10/demo-async-uiimage-loading-using-nsoperation/
             . And the code: https://github.com/frsh/AsyncImageDemo/tree/master/AsyncImageDemo
             . I replace the NSOperations stuff with a simple timer.  I don't think we need a separate thread.
             . Timer event pseudo-code:
                   if the FinderDown countdown timer is active
                     decrement the countdown counter
                     if counter <= 0
                       ; Finder has been down too long
                       send an error to the cloud app indicating that Finder is down
                       terminate the timer
                       notify the daemon to unregister this user
                       return
                     endif counter <= 0
                   endif the FInderDown countdown timer is active
                   find this user's Finder instance.
                   if Finder found
                     reset the FinderDown countdown timer
                     get the Finder pid
                     if Finder's pid == ours
                       @@@ do nothing
                     else Finder's pid != ours
                       ; FInder's pid has changed.
                       inject Finder
                       if no error injecting
                         send a message to the user's Cloud app to reattach to the Finder service and rebadge all of the cloud folder files
                       else error injecting
                         send an error message to the user's Cloud app indicating that a Finder injection error occurred.
                         terminate this user and notify the daemon remove this user's registration
                       endelse error injecting
                     endelse Finder's pid != ours
                     save Finder's pid as ours
                   else FInder not found
                     if Finder's pid > 0
                       ; Finder has just died.
                       set our Finder pid to -1.
                       set a countdown timeout for Finder to come back up
                     else FInder's pid <= 0
                       ; The finder-down countdown timer will take care of this case.  Do nothing.
                     endelse Finder's pid <= 0
                   endelse Finder not found
             . Thought testing:
               o At system startup, the daemon is loaded as root.  There will be no users.  The daemon just sits there.
               o The first cloud app starts.  Cloud starts his DO server. Cloud registers with daemon. The daemon will locate the user's Finder, and send
                   cloud a refresh Finder command.  Cloud will register with Finder's server, Cloud will get the refresh message, and will enumerate the cloud
                   folder to Finder, refreshing the badges.  Cloud will badge as file system changes occur.
               o Finder restarts.  The daemon will discover this and send a message to cloud to refresh Finder.
               o Normal operation.  Cloud restarts.  Cloud will register with daemon.  That will unregister first, then do a normal registration and initialization.
                  Daemon will send the refresh message, and everything is as in a normal startup.
               o One note: On a startup, the first message to Finder from cloud should be a delete cloud dictionary message.  That should cause the Finder
                  server to refresh and repaint all Finder windows.  That will remove all badges from view.  Then cloud sends the complete folder enumeration
                  to be newly badged.
               o Normal operation.  Daemon dies.  Launchd will restart it.  Cloud will not discover this without keep alive messages.  If Finder goes down, cloud
                  will receive errors trying to badge.  Cloud could just ignore these errors.  In this Finder-error state, Cloud could periodically attempt to reconnect
                  with Finder.  When successfully connected again, Cloud could send the initial rebadging sequence.  Since Finder comes back up quickly when
                  it restarts, I wonder if Cloud will ever determine that it went down?  Will the messages go through, or will they succeed?  Test that.
            - (3/24/12):
              . Refactoring the daemon code, and reworking the design.
              . Running scripts with NSOperationQueue: http://cocoawithlove.com/2010/11/cocoa-application-for-running-scripts.html
              . Everything is coded.  Beginning testing.
            - (3/25/12):
              . Lost all of my notes on the root login.  :(
              . Debug pause in agent: if (1) {     fprintf(         stderr,          "Process %ld waiting for debugger.\n",          (long) getpid()     );     pause(); }
              . The first thing I tried was CloudApp as the user root.  The problem with that is: The root user is in a different login (or bootstrap) environment.
                It is trying to inject the user's Finder, and the user is trying to find the daemon's server, and the daemon is trying to find the user's server, and
                both of them are in different bootstrap environments.  Not easy.  So I decided that I could make the daemon a simpler user agent, and I went down
                that path for a long time.  User agents are in /Library/LaunchAgents.  However, I finally saw this post: http://marc.info/?l=launchd-dev&m=120153045213668
                All user agents have NO privileges.  ARRRGGGHH!   So I guess I am back to running it as a daemon, and trying to figure out how the daemon
                can get access as a privileged process in the user's bootstrap environment.
              . Reference on launch: https://developer.apple.com/library/mac/#documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/DesigningDaemons.html#//apple_ref/doc/uid/10000172i-SW4-BBCBHBFB
              . The bible on daemons and agents: https://developer.apple.com/library/mac/#technotes/tn2083/_index.html#//apple_ref/doc/uid/DTS10003794
              . From the above:
			In some cases it is helpful to impersonate the user, at least as far as the permissions checking done by the BSD subsystem of the kernel. A single-threaded daemon can do this using seteuid and setegid. These set the effective user and group ID of the process as a whole. This will cause problems if your daemon is using multiple threads to handle requests from different users. In that case you can set the effective user and group ID of a thread using pthread_setugid_np. This was introduced in Mac OS X 10.4.
              . Maybe I can use launchctl bsexec:
				https://developer.apple.com/library/mac/#documentation/darwin/reference/manpages/man1/launchctl.1.html
				http://osdir.com/ml/darwin-dev/2009-03/msg00046.html
				http://old.nabble.com/Re:--Un-loading-user-agents-on--Un-install-p19741630.html
				http://groups.google.com/group/macenterprise/browse%5Fthread/thread/f6dfb166217b14a2
http://stackoverflow.com/questions/2515314/launch-agent-from-daemon-in-user-context
http://lists.macosforge.org/pipermail/launchd-dev/2011-January/000890.html
http://superuser.com/questions/263544/launchd-doesnt-give-apache-xampp-all-priviledges-at-startup
              . Best so far: Daemon threads can be setuid, setgid: http://www.unix.com/man-page/OSX/2/PTHREAD_SETUGID_NP/
            - (3/26/12):
              . It looks like pthread_setugid_np() sets the uid, not the euid.  That will lose root privileges. http://lists.apple.com/archives/perfoptimization-dev/2008/Jan/msg00039.html
              . Some Samba source code doing this: http://opensource.apple.com/source/samba/samba-235.6/patches/pthread-setugid-np-credential-switching?txt
              . Better, whole module: http://opensource.apple.com/source/samba/samba-235.6/samba/source/smbd/sec_ctx.c
              . The code is using these functions to assume user mode, then pop back to root, in order to switch to another user context.  Server-type processing.
              . White paper on setuid: http://static.usenix.org/publications/library/proceedings/sec02/full_papers/chen/chen.pdf
              . Idea from: http://www.exploitsdownload.com/search/osx/.  RSYNC bug allows execution of any program because egid was left as "wheel".
              . Maybe the problem I am having is that I am trying to do this on a per-thread basis, and the pthread_setugid_np() function requires that all of the id's are set the same?
              . No.  How about if I set the uid's to the user, but set the gid's to "wheel"?   That should work(?).  The uid should select the user context, but the gid should provide the
                permission to patch Finder(?).
              . I don't think that will work.  The "wheel" group will allow me to set the effective uid to root, but I need to do that on the thread.  Can I do that?
              . Interesting quote: The process needs to be born with some kind of root privileges, e.g. suid root executable. The code can release the root privileges at start and pick the 
                effective root privileges at runtime when needed.
              . Login hook tech note: http://developer.apple.com/library/mac/#technotes/tn2228/_index.html
              . Setuid program reducing privileges: http://us.generation-nt.com/rfc-lttngtrace-available-non-root-help-201130771.html
              . Make FinderOverride and Injector setuid and setgid executables:
                o sudo chown root:wheel FinderOverride
                o sudo chmod o-rwx FinderOverride
                o sudo chmod u+rws FinderOverride
                o sudo chmod g-w FinderOverride
                o sudo chmod g+rs FinderOverride
                o And the same for Injector…
                o Actually, do this only for Injector, because FinderOverride runs in the Finder process.
              . Another idea, maybe better: Use this setuid/setgid approach with a user agent instead of a deamon.  That way, the program loads in the user's
                context, but should be able to elevate it's own euid to root.  Try that.
              . To install:
                o Build IconBadge project in XCode.
                o In terminal: ~/Source/ShellScripts/InstallService.sh.
              . To run:
                o In terminal: ~/Source/ShellScripts/RunService.sh.
                o In XCode: Set breakpoints on, and place a breakpoint at Iconbadge/main.m: main: after the pause.
                o In XCode: Attach to the CloudApp process.  That should immediately hit the breakpoint above.
              . The user agent works!  And it reinjects Finder when it recycles.
              . Integrate the GUI test into the Cloud app.
              . Cloud.app design:
                o AgentMonitor:
                   - Provide the Cloud.App server to receive messages from the Agent.
                   - Process messages from the Agent.
                   - Support a delegate to notify the rest of the app of the received messages and other events (e.g., refreshFinder message).
                   - Monitor the Agent using KeepAlive messages (on a separate thread).  Reconnect with the Agent as necessary.
                   - Register and unregister the user with the Agent.
                   - Provide a method to asynchronously send a message to the Agent. Accept a block parameter.  Drive the block with success or failure, and the info.
                   - All messages will be sent via GCD queue.
                   - Use try/catch everywhere to handle exceptions.
                   - Provide startup and shutdown methods.
                   - Implement as a singleton.
                   - The main object (CLAgentService) will spin off another object (CLAgentMonitor) on a separate thread to monitor and communicate with the user Agent.
              . Good GCD tutorial: http://www.fieryrobot.com/blog/2010/06/27/a-simple-job-queue-with-grand-central-dispatch/
            - (3/27/12):
              . Testing…
              . Went to Apple store and bought iMac and two Thunderbolt monitors.
              . Debugging the crash that happens when I kill agent.
              . Setting up the iMac.
            - (3/28/12):
              . Setting up the iMac.  Most procedures OK now.
              . Added try/catch in service when launching monitor.  That didn't help the crash.  Debugging the crash.  Stopped, and added it to TODO.
              . Reference copying a block to solve ARC block crash: http://stackoverflow.com/questions/7404653/arc-getting-exc-bad-access-from-inside-block-used-in-delegate-method
              . More on that: http://stackoverflow.com/questions/9223049/referencing-an-nsoperation-object-in-its-own-completion-block-with-arc
              . Synchronous/asynchronous URL request: http://blog.slaunchaman.com/2011/07/19/asynchronous-synchronous-requests-effortless-networking-code/
            - (3/29/12):
              . eBook on XCode 4: http://redirect.rigwig.org:8081/tim/Computer%20Knowledge%20MegaCollection%20v1.0/The%20Actually%20Useful%20Programming%20Library/Objective-C%20-%20Cocoa%20-%20OS%20X%20-%20Xcode/Mastering%20Xcode%204%20Develop%20and%20Design%20-%20Nozzi%20-%20Peachpit%20(2012)/Mastering%20Xcode%204%20Develop%20and%20Design%20-%20Nozzi%20-%20Peachpit%20(2012).pdf
              . Refactoring the DO names to be in the form <serverName>_<userName>.  XCode screwed up with the global renames????  Trying to recover.
              . Successfully recovered and refactored.
              . Solved a bug in startup where the core services were being started twice.
              . The agent and user are working now with the refactored DO names.
              . Next: Make a clickable test to badge files.   Replace the onClick for the main toolbar Cloud folder.  Start a thread that just flips the badges between two files.  Hook it
                up to the CLAgentService API.  Also, hook up the delegate to know when to refresh the Cloud folder status to Finder, and put in the code in CLAgentService to reestablish a
                connection to Finder on the refreshFinder message.  After the Finder connection is restarted, send the refreshFinder message to the delegate.
            - (3/30/12):
              . Added logic to retry connection to finder.
              . Updated the startup logic to start the core services just once.
              . Got my Windows VM image to load.  Configuring it and updating it.
              . Finished the command line tests of the debug version of CloudApp. Debug control with plist works.  -u, -i -a, and -t work from the command line.
              . Tested the client app badging.  It works!  I pushed everything up.
              . Switched to finding the cause (and a fix for) the crashes when Agent and/or Finder are recycled.
            - (4/2/12):
              . Set up the new 3TB Time Machine backup drive, and managed to delete my Windows VirtualBox virtual machine.  Recovering that from the original image on my other external drive….
              . Working on the server-stop crash.
              . Build a simple test jig.  Server and client processes.  Client just sends messages on a timer.  Server just logs the messages.  See if that crashes.
              . Good info on self and blocks: http://stackoverflow.com/questions/4352561/retain-cycle-on-self-with-blocks
              . Fixed the Cloud.app crash when terminating the agent.
              . Working on another crash of agent when terminating Finder.  It dies when it is trying to retrieve the injector ending task status.
              . I fixed the crash.
            - (4/3/12):
              . The Seagate drive drivers lock up Finder.  Working on a fix for that.  Fixed it.
              . Still trying to recover the deleted Windows 7 VM….
              . Pushed the changes for fixing the two crashes.  Also made changes to clean up the git status, deleting and adding files.
              . Started working on the project to display better icon images:
                o Create separate jpg icon files with the following sizes: 16, 24, 32, 48, 64, 96, 128, 192, 256, 384, 512.  This has progression 8, 8, 16, 16, 32, 32, 64, 64, 128, 128.
                o The images should be transparent in the larger sizes, and opaque in the smaller sizes.
                o Load the images into an array at initialization.
                o Select the image to display in real time according to the size desired.
                   - If there is no image with greater size than what we need, choose the largest image.
                   - Otherwise, choose the image just larger than what we need, and let the framework size it down slightly.
                   - That should produce the best quality.
                o Also work on the placement and sizing according to the type (listview/iconview) and the size of the icons selected by the user.
                o Define a class to represent each of the images:
                   - File name on disk.
                   - Unflipped CGImage reference.
                   - Flipped CGImage reference.
                   - Pixels per height and width.  e.g., 16.
                   - Method to initialize and load the class object.
                o Should this object derive from CGImage?  The code uses NSImage and CGImage.  Can I standardize on CGImage?  No.
                o Drawing a CGImage: http://stackoverflow.com/questions/3424103/drawing-image-with-cgimage
                o Another time-waster: 3 hours+.  getlogin() was returning "_spotlight", instead of "robertstevens".  NSUserName() fixed it.
                o The Cloud program isn't badging.  Why not?  I got it to badge, but the image is upside down.  Then I got it flipped, but not vertically through the mid-line.
                o I installed the bob@cloud.com account on the iPad, but I couldn't get it to install on the Mac.
             - (4/4/12): Connect 2012 and our team dinner at Chima.
             - (4/5/12):
                o I got the badging working with CGImage only (no NSImage).  Now load in all of the proper images and implement the display algorithm.
                   - Design the classes and load them up into an ordered array by pixel count.
                   - Call the class BadgeImage.
                o The variable-sized icon badging works great, and looks great!
             - (4/6/12):
               o Now work on the tests.
                  . Restart the Mac multiple times and make sure that all three processes initialize correctly and handle the race conditions.
                  . Add "crash" messages to Finder and Agent, and have the tests crash one, the other, or both, and recover.
                  . Add tests for Agent.  
               o To run tests: Select IconBadgeTests target, then menu Product/Test, or Cmd+U.
               o Existing tests are successful, but they are only directed at Finder, and assumes that Finder is already injected and running.
               o Fixed a bug in yesterday's refactored code that prevented connection between Cloud and Finder.
               o Tests to add for agent:
                  1.  Install the agent.  This is necessary to make sure that the plist is in place for subsequent tests.
                  2.  Stop the CloudApp agent.  Should succeed whether already stopped or not.  It will not be restarted because it is uninstalled.
                  3.  Run the uninstall.  Test that it is uninstalled.  Should succeed whether already uninstalled or just uninstalled.
                  4.  Kill Finder.  Should succeed in any case.  Finder will be restarted by launchd.
                  5.  Test connection to the agent server.  Should fail because it is not running.
                  6.  Install the CloudApp agent.  Should succeed.
                  7.  Test for agent running.  Should fail because agent hasn't been started.
                  8.  Start the CloudApp agent.  Should succeed.
                  9.  Test that the agent is running.  Should succeed.
                  10. Test for connection to the wrong agent host name.  Should fail.
                  11. Test connection to the proper agent host name.  Should succeed.
                  12. Test an unimplemented message to agent.  Should fail.
                  13. Send a keep-alive message to an unregistered user.  Should fail.
                  14. Send a registerUserName message to register the user.  Should fail because we haven't initialized the user DO server.
                  15. Start the user DO server.  Should succeed.
                  16. Send a registerUserName message to register the user.  Should succeed now.
                  17. Test the keep-alive message.  Should succeed now.
                  18. Send a crash message to the agent.  Should cause an exception.  The agent should be subsequently restarted by launchd.
                  19. Wait 2 seconds for the agent to be relaunched.
                  20. Send a keep-alive message.  Should fail because the connection was broken and the user is no longer registered.
                  21. Clear the refreshToFinderReceived flag.
                  22. Send a registerUserName with the wrong login name.  Wrong pid.  Should fail.
                  23. Send a registerUserName with the wrong pid, but the correct login name.  Should fail.
                  24. Send a registerUserName with the correct pid, but the wrong login name.  Should fail.
                  25. Send a registerUserName with the correct pid, and the correct login name.  Should succeed.
                  26. Send a keep-alive message for this user name.  Should succeed.
                  27. Wait 2 seconds. (for Finder to be injected and a refreshToFinder message to be received).
                  28. Check for the receipt of the refreshToFinder message.  Should be received by now.  Should be successful.
                  29. Check to see if the Finder server is running.  It should be.
                  30. Send a telNumber command to Finder.  It should fail with an error.
                  31. Send a setBadgeType: signature to Finder.  It should fail with an error, because it also requires the withPath: parameter.
                  32. Send a getBadgeCount message to Finder.  It should return with success and a zero count.
                  33. Send a clearAllBadges message to Finder.  It should succeed.
                  34. Clear the refreshToFinderReceived flag.
                  35. Send an ohSnap message to Finder to crash it.  It should succeed.  LaunchD should restart Finder.
                  36. Wait 2 seconds for the Finder to be relaunched.
                  37. Check for the receipt of the refreshToFinder message.  Should be received by now.  Should be successful.
                  38. Send a getBadgeCount message to Finder.  It should succeed and return a zero count.
                  39. Send a setBadgeType:forFileAtPath: message.  It should succeed even if the file is not present in the file system.
                  40. Send a getBadgeCount message to Finder.  It should succeed and return a count of one.
                  41. Send a getBadgeType:forFileAtPath: message for the same file as above.  It should succeed and return synced.
                  42. Send a setBadgeType:"none":forFileAtPath: message for the same file as above.  It should succeed.
                  43. Send a getBadgeCount message to Finder.  It should succeed and return a zero count.
                  44. Send an unregisterUserName message to agent with the wrong user name.  It should succeed.
                  . Send an unregisterUserName message to agent with the correct user name.  It should succeed.
                 o Wait on the tests.  Badge the existing Cloud directory first.  How best to enumerate the directory recursively?
                   . I will get a flat array of the files and directories by scanning the directory recursively.
                   . Loop through the flat array badging the files.
                   . Do that under a lock.
                   . If a user action comes in while this bulk operation is underway, add the user file path into a separate set.  
                   . Under the lock, before badging a file, see if it is in the user set.  If so, don't badge it.
                   . After iterating over the whole array, delete the array and the user set.
              - (4/7/12):
                o Time waster: Just getting my MacBookAir set up and paired with the three Bluetooth devices took over an hour.
                   That, plus installing XCode updates, and syncing my code base…   I should have gone to work. 
                o The startup Cloud directory enumeration and badging works now.
                o I started downloading Moutain Lion to install on my MacBookAir.  I will test the badging on Mountain Lion.  It doesn't work on Gus' system.
                o It works on Mountain Lion on my machine, but not on Gus' or Steve's.
                o 8:30 - 2:30
              - (4/8/12):
                o 6:30 - 20:00 (2 hours personal)
                o The BuildStaging directory is being created.  Why is Gus' machine throwing errors?  Does he not have admin rights when he is building?
                o Changed "error" to [error localizedDescription] everywhere when used with NSError.
                o Setting up the unit test XCode environment: http://twobitlabs.com/2011/06/adding-ocunit-to-an-existing-ios-project-with-xcode-4/
                o Time-waster (2.5 hours).  Trying to find the main bundle from the test bundle.  I was trying to use bundleForClass, with a class from the main bundle,
                   and got led down the garden path by examples from the web, and problems resulting from those examples.  In the end, I just got the test path
                   and went relative to that to get the other path, in order to find the scripts that I needed for test.
                o Good info on DO sync: http://www.cocoabuilder.com/archive/cocoa/168017-distributed-objects-question.html
                o More good info on DO sync: http://web.archiveorange.com/archive/v/SEb6aXy6AzRrBdfsowUI
                o 23 tests working.
              - (4/9/12):
                o Time waster (2 hours+). SenTest won't run all of the tests.  It stops at test 007.  Maybe the XCode 4.4 project files are changed?
                o Now testing works again.  I installed Mountain Lion and XCode 4.4.
                o Wrote the code to find the login user name for a particular pid.  Implemented the check in the agent to make sure that the pid matches the user name.
                o All 23 tests work again, and I have a small demo for MarkT, who should be visiting us for lunch today.
                o Finished all 44 tests, and they work.  This completes the unit and functional testing of the agent and Finder processes.
                o Debugged the problem connecting with Finder with Gus on his machine.  It has to do with the permissions for Injector.
                o 6:30 - 19:45            
              - (4/10/12):
                o 6:15 - 18:30
                o LaunchD .plist generator: http://spotmac.lima-city.de
                o (4/10/12) Is the Agent in the wheel group (really?)?  No, it is the standard user logon.
                o (4/10/12) Badging doesn't work on Gus' or Steve's machine.
                o (4/10/12) Make getpwuid thread-safe.  Use getpwuid_r() everywhere.
                o (4/10/12) Remove "set -x" in the shell scripts.  
                o Fixed crash due to removed retain.
                o Great info on NSException handling: http://macdevcenter.com/pub/a/mac/2007/07/31/understanding-exceptions-and-handlers-in-cocoa.html?page=3
                o WaitForDebug.plist is in IconBadge/Resources:
                   . Copy it to the target Resources directory.
                   .  /Library/Application Support/Cloud/CloudApp.app/Contents/Resources
                   . Unload and load.  See the message in Console.
                o (4/10/12) Uncomment messages in CLAgentService.m:beginAgentServices.
                o (4/10/12) Test for memory leaks.
              - (4/11/12):
                o 6:15 - 18:30
                o AppleEvent sample code: http://developer.apple.com/library/mac/#samplecode/MoreAppleEvents/Introduction/Intro.html
                o I proved that the AppleScript "tell application "Finder" to update every item in front window" doesn't work.
                o I spent the morning trying to find an AppleScript reference for Finder.  No dice.  It seems that support for AppleScript is very spotty.
                o I am dropping the research on the AppleScript approach.  I'll start looking for a lower-level "invalidate" method.
                o Good info on NSView forcing a redraw: http://stackoverflow.com/questions/7648047/force-a-window-to-redraw-itself-using-core-graphics
                o Try a different approach.  The Finder DO server runs on a separate thread, and events come in at different times then when we are
                   actually badging the icons with our images.  I need to be able to call the particular view's setNeedsDisplay method.
                o First write a test that will enumerate each of the visible Finder windows, just once, on the server thread.  Find the application (sharedApplication).
                   Find the windows for that application.  Then find the contentView for each of the windows.  Call setNeedsDisplay on each of the views.  See if that works.
                o That worked.  All badging is now updated, even the ListView/FlowView window!   Pushed!
                o Looking at the retain logic.  Removing them caused a crash.  It turns out that it the obtuse KVO mechanism.  The KVO event was calling back to the
                   server, and the server was killing the user and releasing it, then the KVO returned to the user, but no user!  I need to use notifications instead. 
                   They are one-way, and guaranteed (locally).
                o Researching notifications. 
              - (4/12/12):
                o 6:00 - 18:00
                o Had to rebuild the Finder class-dump.  It's not on this new iMac.  Find it in Projects/DTrace/FinderClassDumpMountainLion
                o I researched the TBrowserWindow and TBrowserWindowController classes.  I think I can find the target path, but that needs more work.
                o I wrote the code to use notification between the agent server and user classes, but it was still crashing.  I finally determined that the mode of notification
                   I was using was still synchronous, like KVO.  I changed the mode to use the ASAP queued notification.  Now the unit tests work again.
                o I also fixed a bug that was resulting in the server not being able to reinject finder.  The NSOperation can't be reused once it is complete.
                o Made NSError+Categories.* to remove duplicate NSError creation code.
                o Changed the Finder server code to run the Finder refresh on the Finder main thread (to prevent threading issues).
                o Everything is working fine with no retains.
                o Pushed changes.
                o Changed the int return codes to NSError ** and pushed.
                o Added documentation and prettied things up with @pragmas.
                o Fixed the user code to reset the agent state when an error message is received from the agent.  The user will now try to reconnect with the agent.
                o Investigated the typing delay in the initial cloud dialog.  It is not due to any of the shell integration code.
                o Well along the way of finding the paths associated with the various Finder windows.
                o Vector memory: http://books.google.com/books?id=gYNVsCaxfYgC&pg=PA378&lpg=PA378&dq=vector+start+finish+end+of+memory&source=bl&ots=KLTHo6cQnK&sig=PogEXQXfz7YVOw1Vs2Eqx04zsAM&hl=en&sa=X&ei=cUeHT9vUIYuo8QT54p2cCA&sqi=2&ved=0CCcQ6AEwAg#v=onepage&q=vector%20start%20finish%20end%20of%20memory&f=false
              - (4/13/12):
                o 6:00 - 18:15
                o I realized that there are some Finder views like the "All My Files" view that list files from everywhere, including the Cloud directory.  We want to show those files as badged.
                o I ditched that effort in favor of limiting the number of requested repaints.  I will paint immediately, but only N times in each second.  I sent an email to Gus, Steve and Phil about that.
                o Timer limiting pseudo-code:
                          ; data
                            MAX number of repaints per second
                            countdown number of repaints allowed
                            repaint pending flag
                          ; timer
                          if repaint pending
                            set repaint pending = NO
                            cause a repaint
                          endif repaint pending
                          reset paints allowed to MAX
                          ; badge operation
                           if paints allowed count > 0
                             cause a repaint
                           else paints allowed count <= 0
                             set repaint pending
                           endelse paints allowed count <= 0 
                 o Another time waster:  XCode crashes repeatedly blowing up the stack while indexing.  That cost 1.5 hours.  I finally solved it.  It is a bug in the indexer.  Saw somw
                    of my pseudo-code
                 o Phil had a suggestion to evenly space the refreshes.  Change the pseudo-code to the following
                           ; data
                              Constant: kTimeBetweenRepaints: e.g., 0.33
                              timer active flag
                           ; timer pop
                             cancel the timer
    			        cause a repaint
                             clear the timer active flag
                           ; badge operation
                             if timer not active
                               set timer active flag
                               set a timer
                               cause a repaint
                             endif timer not active          
                  o Interview with Chuck.
                  o Error message: The managed object model version used to open the persistent store is incompatible with the one that was used to create the persistent store.
                     . Delete the file /Users/robertstevens/Library/Application Support/com.citrix.core_data      
                  o The throttling of the Finder window refresh works properly, and the tests succeed.
                  o Working the whole afternoon on load testing.  I got the manual test to work sending a badge every millisecond.
                  o I implemented that logic in the Cloud.app and hooked it up to the Open Cloud Folder menu item.  Shooting various problems with the load that is created.
                     The normal test works, but when I crash Finder, it doesn't recover.        
              - (4/14/12) Sat:
                o 9:30 - 16:00, 17:15 - 20:30
                o Time waster: 45 minutes.  Setting up the MacBookAir for the load test.  I thought I had broken the system because I couldn't get Console to work.  I had modified
                   a plist file to change the default behavior of deleting messages over 500 per second to printing them all.
                o Finally got the system set up properly and found a bug having to do with access of self in a block.  However, it's still failing illogically.  I think I know the reason.
                   I'm accepting tons of badges, and loading them into memory.  The blocks are executing later and not paying attention to the Finder connection state.  Actually,
                   the block that is executing later has an old copy of the state on the stack.
                o I don't think I can accept just any number of badges.  We could run out of memory.  But how many badges do I accept?  Any number I pick would be wrong.
                   The problem is that I don't have application knowledge.  
                o One way would be to buffer up to 1000 badges, and then stop the API synchronously.  However, I really don't want to ever stop the API.
                o I think that means that the use must queue up all of his badges, and run them into the API  synchronously, using a separate thread to do it?
                o Actually, I could change the test to send 1000, then add an API call to put a marker block on the queue, which would send an event back to the test to
                   send another 1000 when the first 1000 are done.
                o Then I need a way to block the execution of the queue thread when Finder is down, so the badges start to flow again when Finder is up again.
                o I could use a mutex for that.
                o Finder-down is noticed in many places.  The timer thread might notice it.  The queueFinderSend thread might notice it when attempting to send a badge.
                o It is always the timer thread (main thread) that notices when Finder is ready again.
                o Perhaps I could create and pre-lock a mutex at initialization.  Then if the queueFinderSend thread has a problem sending a message, it would just block on the
                   pre-locked mutex, and try the same badging operation when it acquires the mutex.
                o But how do we get the mutex locked again by the timer thread before the queueFinderSend thread retries the badge operation?  This seems like a classic flip-flop
                   thread pattern.  What is the simplest pattern I can find to implement this?
                o Use NSConditionLock.  The timer thread is responsible for setting the FINDER_UP condition.  Both threads are responsible for setting the FINDER_DOWN
                   condition:
                          ; initialization
                            id condLock = [[NSConditionLock alloc] initWithCondition:NO_DATA];
                          ; queueFinderSend thread:
                            loop attempting to badge
                               [condLock lockWhenCondition:FINDER_UP];
                               try badge
                               if error
                                  [condLock unlockWithCondition:FINDER_DOWN];
                               else no error
                                  [condLock unlock];
                                  break;
                               endif no error
                            endloop attempting to badge
                          ; timer thread
                            ; When connected to finder:
                                [condLock lock];
                                [condLock unlockWithCondition:FINDER_UP];
                             ; When noticing that finder is down:
                                [condLock lock];
                                [condLock unlockWithCondition:FINDER_DOWN];                             
                o Allow only a maximum number of badges to be queued.  Count the badges as they come to the API.  Increment a count.  When
                   it reaches the maximum, return a MAXIMUM_BADGES_QUEUED return code to the user.  The user should stop sending badges.
                   The first such return code will also add a dispatch_sync block to the queueFinderSend queue.  This block will reset the count, and will
                   drive an event to the user via the delegate.
                o The badging works now, and I can reliably? (5 tries) kill Finder and have it reconnect.
                o I can use the NSTaskDidTerminateNotification to notify when NSTask completes: https://developer.apple.com/library/mac/#documentation/Cocoa/Reference/Foundation/Classes/NSTask_Class/Reference/Reference.html
                o Big time waster:  NSTask won't run injector!
                o Actually, I think it is running injector, because Finder injects, but injector puts out no debug log entries.  It is being compiled in debug mode, with DLog statements.  Why no logs?????
                o When I run it from the command line, it prints to the terminal, but somehow NSTask is blocking the logs.  Maybe I need to set NSTask stderror???
              - (4/15/12) Sun:
                o 6:30 - 13:30
                o Backslash escape blanks in a path:            
              NSArray *arr = [[[NSBundle mainBundle] pathForResource:@"injector" ofType:@""] componentsSeparatedByString:@" "];
              NSString *launchPathWithEscapedSpaces = [arr componentsJoinedByString:@"\\ "];
                o NSTask source code: http://www.quantum-step.com/download/sources/mySTEP/Foundation/Sources/NSTask.m
                o Print to XCode console AND Console.app: http://parmanoir.com/Redirecting_NSLog_with_NSLogConsole
                o Still HUGE time-waster (2 hours so far this morning).  NSTask seems to launch injector, but doesn't see it complete, and doesn't notify the agent user object.  That
                   causes a retry of the launch of injector, but now it doesn't seem to run.  At least NSLog isn't working, and Finder doesn't respond to the 2nd and subsequent injector launch
                   attempts.  Maybe if I cause injector to crash?  At least then I would be sure it is working.
                o It's crashing, so it is being launched.  Why can't I get debug logging?????   ARRRGGGHHHH!
                o Redirecting NSLog (stderr): http://www.atomicbird.com/blog/2007/07/code-quickie-redirect-nslog
				//    int fd = creat ("/Users/robertstevens/Source/Trash/my_log", S_IRUSR | S_IWUSR | S_IRGRP | S_IROTH);
				//    close (STDERR_FILENO);   // this closes descriptor 2 (stderr)
				//    dup (fd);                 // this dups the file onto the lowest file descriptor (2)
				//    close (fd);              // this closes the original file descriptor
				//    NSLog(@"this will be written to my_log");                
                o Finally, it appears that I can't use NSTask in NSOperation: http://www.cocoabuilder.com/archive/cocoa/293896-nstask-in-nsoperation.html
			NSTask relies on a runloop. Since you have no control over what thread
			your operation runs in, you can't run a runloop on your operation's
			thread, and therefore cannot use NSTask in this manner.

			You will need to spawn your NSTasks on the main thread (or at least a
			thread you own, not one owned by NSOperationQueue or GCD). When you
			get your -taskDidTerminate: notification *on the main thread*, you can
			enqueue another operation to handle the result of the task completing.         
                o NSLog gets sent to asl_log: http://www.cocoabuilder.com/archive/cocoa/198249-logging-mechanisms-in-cocoa.html
                o Write to ASL (Apple Logging):
			    aslclient client = asl_open(/*ident*/ NULL, /*facility*/ "Injector" /*or other reasonable facility string*/, ASL_OPT_STDERR);
			    asl_log(client, /*msg*/ NULL, ASL_LEVEL_NOTICE, "printf-style format; interpolates values, such as %i", 42);
			    asl_close(client);
                o Mostly everything works, but there is still an occasional crash in CloudApp, and an occasional hang? in Cloud.
              - (4/16/12) Mon:
                o 6:15 - 18:30
                o Finder kills recover and don't cause agent or cloud crashes.
                o Backup to network drive: http://opensoul.org/blog/archives/2009/01/14/network-time-machine-backups-to-another-mac/
                o More on Backup to network drive: http://apple.stackexchange.com/questions/28208/time-machine-backup-on-another-mac-in-my-network
                o All three kill tests work perfectly!  I submitted it.
                o I need to check the status of the user app from agent, and kill the badges for that user when Cloud goes down.  Use the existing proxy and send a (new) keepAlive
                   message to Cloud.  If it breaks in any way, send a clearAllBadges message to Finder, and unregister the user.
                o That works, but Finder didn't refresh, so the badges stayed there until the user causes the window to refresh manually.  Add a refreshWindows message to the
                   Finder API.  I will also need to put logic into the user to send a refreshWindows message some amount of time after the last badging operation, if a new badging
                   operation doesn't come in within that amount of time.  Actually, that was just a bug.  The throttling timer wasn't processed on a clearAllBadges request.
                o It's all working now, and submitted!
                o Working on problems with the unit tests.  hasRegisterBeenRequested is messed up.
              - (4/17/12) Tue:
                o 6:15 - 17:45
                o 18:00 - 20:30 Education, FlaDotNet, Microsoft, FTL, HTML5      
                o Finally ended the hunt for the cause of the crash at the end of the unit tests when the user app (test app) is terminated.  It seems that I needed to retain the proxy
                   obtained from rootProxyForConnectionWithRegisteredName:
			Some leaks, and places where objects could leak if the timing was
			right, in Distributed Objects have been fixed in 10.5. This may mean
			that you may no longer get away with something you used to get away
			with due to the leak. Not retaining the root proxy you get from the
			connection, if you're going to hold onto it, seems to be a common
			pitfall.   Web site: http://www.cocoabuilder.com/archive/cocoa/216768-10-5-and-root-proxies.html
                 o The unit tests work now.
                 o All of the tests work now, but I had to place an extra retain on the agent user objects to prevent an agent crash.  I submitted this version.  It works well.
                 o I need to refactor the creation of the user object, and pass the retention ownership of the user object to the dictionary.  I don't think this will prevent the crashes,
                    but it is a more standard pattern.
                 o The refactoring is done.
                 o I also passed the processing of the unregisterUserName to the user object for proper handling.
                 o The tests are broken because the registerUserName action calls unregisterUserName.
              - (4/18/12) Wed:
                o 7:00 - 18:30
                o Fix the broken tests.  It is not simple.  There are two choices when a registerUserName comes in: 1) If the user is already registered, call unregisterUserName, then
                   register the user as we have before.  There may be two issues with that.  One, we are kicking out an error on the unregister, and two, the unregister may take some time?
                   2) Just verify that the user that is coming in is the same user, and allow reconnect.  On the reconnect, send back a refreshToFinder message somehow.  Research
                   these options.
                o That is done, and all tests pass.  The agent crash on user release is still there, occasionally.
                o Meeting with discussion of sync problems.
                o Change the design to spin off a separate NSOperation thread for each user.  That thread should have a run loop.  All of the existing code will run on that thread.
                   The run loop will run in an external loop, checking for a run loop exit request.  The other code will clean up, and will set the run loop exit request.  The run loop
                    will run for an additional N seconds, then terminate.  Actually, I think I can do it without the thread.  Maybe I should try that first?  When users are placed into the watch
                    dictionary, also put in a countdown of seconds.  In the timer loop, when a watched user is seen, count down the seconds, and remove the user from the watch
                    dictionary when the countdown is complete.
                 o I changed the server timer processing to delay the user release by 5 seconds.  That didn't work.
                 o Steve pointed out that my user dealloc releases, and sets to nil.  Perhaps that releases twice?   Working on that.
              - (4/19/12) Thu:
                o 6:15 - 18:15
                o Meeting with more discussion of sync state machine.
                o Fixing the double-release fixed the agent crash.  I pushed the code.  All tests work beautifully.
                o Test with two users.  Create a new regular user.  Build the app with the load-test badging.  Copy the Cloud.app bundle into the user's Applications 
                   folder.  Execute the app, start the load badging, and perform the kill tests.  Leave it running, and switch to my own user.  Perform the tests under
                   my user.
                o Multiple users work great!  In fact, OsX automatically starts the agent for the new user, so the user is not even prompted for credentials to install!
                   I tested with an admin user, and with a regular user.
                o Started reviewing the code.
                o Changed file names for consistency and pushed.
              - (4/20/12) Fri:
                o 6:15 - 
                o Reviewed the code.  Removed all retains.  All tests 
work.  Renamed variables and modules for consistency.
                o Started the Windows client project.  Watched 1.5 videos on MvvmLight.
              - (4/21/12) Sat:
                o 9:30 – 16:00
                o Watched more videos and read documents on MvvmLight.
                o Which development platform should I use? WPF?  Silverlight?  Silverlight is asynchronous, and would provide support for Windows Phone 7.  But where is Windows Phone 7 going?  Will we support that?  I believe Silverlight is delivered through the browser, and there is an “out of browser” mode for Silverlight.  Is that what we want?
                o Silverlight 5 features: http://www.silverlightshow.net/items/10-Laps-around-Silverlight-5-Part-10-of-10.aspx
                o More SL5: http://justlikeamagic.com/2011/05/18/new-in-silverlight5-elevated/
                o SL5 Multiple Windows: http://trelford.com/blog/post/sl5multiwindow.aspx
                o Cross-platform WPF, SL and WP7: http://trelford.com/blog/post/sl5multiwindow.aspx
                o MvvmLight: http://www.galasoft.ch/mvvm/
                o SL5 supports full-trust out-of-browser operation.  It even supports P/Invoke, file system access, and Win32.
                o SL5 is also easier to get running on Windows Phone 7.  
                o SL5 is asynchronous, and supports part of the TPL (Task Programming Library).
                o SL5 supports multithreading.
                o MvvmLight supports SL5.
                o Windows Phone will use SL, or a slightly-modified version.
                o SL5 Multiple Windows: http://trelford.com/blog/post/sl5multiwindow.aspx
                o SL5 Elevated Trust: 		.
                o SL5 will be supported until 2021.
                o It seems that SL (or some version thereof) is still a major strategy at Microsoft.
                o SL5 support goes all the way back to XP: http://www.microsoft.com/getsilverlight/Get-Started/Install/Default.aspx
                o SL5 OOB app can be installed via setup (or via supported browsers): http://www.codeproject.com/Articles/179756/Installing-Silverlight-OOB-Application-using-a-Set
                o MvvmLight supports Windows 8: http://blog.galasoft.ch/archive/2011/10/03/mvvm-light-toolkit-for-windows-8-preview-mvvmlight-win8.aspx
                o Conclusion: We should probably use SL5 and MvvmLight.  That code base has the best likelihood of being supported across the desktop and mobile.
                o Problems with the IE9 downloader.  I used Opera to download the MvvmLight sample program.  Updating VS2010 to support SL5.
                o I got everything installed, and the sample SL5 app builds.  It looks like a good base, because it uploads files to a web server.  Expression Blend 4 and VS2010 both work.
              - (4/22/12) Sun:
                o 7:00 – 19:00
                o Installed MvvmLight V4 Beta 1
                o Installing the .Net frameworks and supporting VS2010 libraries.
                o Two views in one window: http://www.codeproject.com/Articles/323187/MVVMLight-Using-Two-Views
                o Rounded corners in SL: http://dvanderboom.wordpress.com/2010/11/06/dynamic-clipping-of-rounded-corners-in-silverlight/
                o Window control OOB: http://programming4.us/multimedia/2018.aspx
                o Sample code to paint an entire window with custom controls: http://www.silverlight.net/learn/overview/out-of-browser-applications/out-of-browser-applications-(silverlight-quickstart)
                o Book with OOB stuff: http://www.springerlink.com/content/mlk750562rrk1r50/
                o Trying to get a window with a full image to display with rounded corners.  So far, close, but no cigar.
                o Animated drop shadows: http://msdn.microsoft.com/en-us/library/ms753350(v=vs.90).aspx
                o Custom chrome window OOB: http://www.codeproject.com/Articles/68955/Silverlight-4-How-Can-I-Create-a-Customized-OOB-Wi
                o I have a chromeless window and a standard window working with the standard Cloud main screen image.  No buttons or other windows.
               - (4/23/12) Mon:
                 o 6:30 – 18:30
                o Get a Windows development environment set up at work.  First, install a VirtualBox VM and install Lion.  Then maybe I can use that to open the VM image and do something
                  to make it convertible to VMWare.  
                o I couldn't do that.  VirtualBox won't even run.
                o I tested RDP.  That doesn't support multiple monitors.
                o I decided to go back to the physical machine.  I installed VMWare Standalone Converter.  Hopefully, I can take an image and get it running on Mountain Lion.
                o Can I disable the "Silverlight" controls on an OOB app?  Researched that.
                o Good OOB AppManifest.xml documentation: http://www.silverlightshow.net/items/Silverlight-3-as-a-Desktop-Application-Out-of-Browser-Applications.aspx
                o Apparently we CAN disable the Silverlight context menu for the OOB app.
                o Can we build a setup installation package that will also install the Silverlight runtime?
                o Installing an OOB app via a setup project: http://www.codeproject.com/Articles/179756/Installing-Silverlight-OOB-Application-using-a-Set
                o But can we also include the Silverlight plugin itself in the setup package?
                o Another custom OOB installer: http://www.c-sharpcorner.com/uploadfile/dbd951/silverlight-oob-application-installer/
                o Another one: http://timheuer.com/blog/archive/2010/03/25/using-sllauncher-for-silent-install-silverlight-application.aspx
                o Another one: http://weblogs.asp.net/alnurismail/archive/2010/05/24/a-distributable-exe-silverlight-oob-application.aspx
                o Microsoft Deployment document: http://www.microsoft.com/silverlight/resources/
                o Comparing SL OOB and WPF with ClickOnce: http://stackoverflow.com/questions/5314346/clickonce-versus-windows-gadget-versus-silverlight-oob
                o Installing an OOB app for all users on a machine: http://forums.silverlight.net/t/220344.aspx/1
                o Manually installing SL via an open source installer: http://www.dotnetheaven.com/Blogs/4285/a-simple-silverlight-oob-application-installer-using-nsis.aspx
                o Mac SL install package: http://www.microsoft.com/silverlight/handlers/getsilverlight.ashx
                o SL vs. WPF features: http://msdn.microsoft.com/en-us/library/cc903925(v=vs.95).aspx
                o Excellent description of SL OOB app capabilities: http://www.silverlightshow.net/items/Mastering-LOB-Development-for-Silverlight-5-Out-of-Browser-OOB-Applications-.aspx
                o Jounce framework: http://www.wintellect.com/CS/blogs/jlikness/archive/tags/silverlight+5/default.aspx
                o Jounce at CodePlex: http://jounce.codeplex.com
                o SL 5 features: http://www.gianlucacucco.net
                o MvvmLight supports WinRT.
                o OOB app in systray: http://stackoverflow.com/questions/6887747/how-to-minimize-silverlight-application-to-system-tray
                o More OOB app in systray: http://firstfloorsoftware.com/blog/hosting-silverlight-outside-the-browser
                o Native Extensions for SL, supports task bar, etc.; http://archive.msdn.microsoft.com/nesl
                o Feature requests for SL 5: http://geekswithblogs.net/JoshReuben/archive/2010/09/13/silverlight-5.0--wpf-5.0---not-quite-there-yet.aspx
                o Great examples of creating child windows: http://geekswithblogs.net/JoshReuben/archive/2010/09/13/silverlight-5.0--wpf-5.0---not-quite-there-yet.aspx
                o NESL support minimize to system tray!:  http://archive.msdn.microsoft.com/nesl
                o Blend tutorials: http://expression.microsoft.com/en-us/cc184874
                o I have the Windows dev machine imported into a VMWare Fusion VM on the Mac, and operating full screen across the 3 monitors.  Yet to be proven: performance.
                o Installing updates, etc.
  o (4/24/12) Tue:
    - 6:00 - 18:00
    - Cocoa objc_msgSend debuggging: http://www.friday.com/bbum/category/science/technology/apple/mac-os-x/
    - Installing Expression, git and the rest of the development environment.  Got it installed.
    - Fixed a bug with the VM.  The comboboxes were erasing as the mouse goes over them.  That was not usable.
    - Downloaded the PictureUploader sample for MvvmLight and SL5. 
    - Both MvvmLight and Jounce are MIT licensed.
    - Description of ViewModelLocator: http://stackoverflow.com/questions/5462040/what-is-a-viewmodellocator-and-what-are-its-pros-cons-compared-to-datatemplates 
    - Building the main window with Blend and VS2010.
    - Awesome button building: http://www.codeproject.com/Articles/64937/Building-Better-Buttons-in-Expression-Blend-Silver
    - I built a button, but it is without actions and states at the moment.
    - I used these instructions: http://codeflow49.blogspot.com/2009/10/step-by-step-shiny-button-template-with.html
    - Got the Samsung notebook.  I set it up, but it runs Windows 7 Home Premium.  I need to upgrade it to Professional to be able to connect to the domain.
  o (4/25/12) Wed:
    - 6:15 - 18:30
    - Installing Win7 Enterprise on the Samsung laptop.
    - Finishing the shiny button tutorial.
    - A completely wasted day working on hardware and PC setup.  We installed the SSD in the iMac, and the Samsung laptop is working properly, although not
      nearly completely set up.
  o (4/26/12) Thu:
    - 6:30 - 18:30
    - I got the Blend buttons working and showing the proper color.  They aren't the right shape, and they don't animate enough, but I'll wait for Rion
    - Installing Visual Studio on the Samsung.
    - MVVM Validation snippet extensions: http://www.basarat.com/2011/02/mvvmlight-extensions-part-snippets.html
    - About RelayCommand: http://blog.galasoft.ch/archive/2009/09/26/using-relaycommands-in-silverlight-and-wpf.aspx
    - MVVM Light tutorial with unit testing: http://www.codeproject.com/Articles/166688/Using-MvvmLight-with-XAML-Silverlight-4-or-WPF
    - A very thorough example: http://www.codeproject.com/Articles/82298/A-Sample-Silverlight-4-Application-Using-MEF-MVVM
    - Also: http://issuevision.codeplex.com/
    - A WPF page slide transition: http://www.codeproject.com/Articles/197132/Simple-WPF-Page-Transitions
    - A Silverlight sliding panel demo: http://www.windowspresentationfoundation.com/Tutorials/SlidingPanels/SlidingPanelWIthToggleBtn/
    - Animation in Silverlight: http://weblogs.thinktecture.com/cnagel/2010/03/easing-animation-with-wpf-and-silverlight.html
    - Great site for sophisticated code: http://www.silverlightshow.net/items/Animated-navigation-between-Pages.aspx
    - I downloaded and played with several animated page navigation samples.  The link above was the best.
    - I asked Gus and Steve about whether we need sliding windows.  They think it should fit with the native OS, but be good looking.  After all,
      it's only an installation program.
    - Maybe we should go all the way back to Windows Forms?  Let's think about that first.
    - What do we have to support?
      . Forward to Windows 8 desktop.
      . All the way back to XP
      . Windows Metro tablets and Windows Phone 8.
      . Windows Phone 7
      . Problem with Windows Forms.  It's Win32.  That is not supported on Metro and Windows Phone 7.
      . It seems like Silverlight is still the way to go:
        o It gives us all of the options (static windows, animation)
        o It gives us Windows Phone 7.
        o (slightly modified) It gives us Metro.
        o It limits the API in use to a very small platform.
      . Keep at it, but forget the sliding navigation for now.
      . Use a fixed sized window, like on the Mac.
      . Forget MVVM.  Too complicated for this.
      . Build the meat of the client into a Silverlight class library.
      . Build unit tests to the class library.
      . For the first step, investigate Silverlight navigation.
      . Silverlight navigation: http://msdn.microsoft.com/en-us/library/cc838245(v=vs.95).aspx
  o (4/27/12) Fri:
    - 6:15 - 17:15
    - I built the CreateNewAccount form.
    - Navigation works.
    - MvvmLight works for RelayCommands and Messaging.
    - Working on validation and how to present the errors to the user.  Use the IDataErrorInfo interface?
    - Interesting post on error handling: http://www.silverlightshow.net/items/Data-Driven-Applications-with-MVVM-Part-III.aspx
    - I need to use a 1-1 View-ViewModel relationship.  Right now all of the views go to one ViewModel.  The Model will hold the data.  Done.
    - Working out the details of validation, using the post above.
  o (4/28/12) Sat:
    - 7:30 - 16:00
    - Installed Expression Blend and VS2010 tools for Silverlight 5 on my laptop.
    - Nice validation resource: http://www.codeproject.com/Articles/75962/Validation-in-Silverlight
    - Maybe better MVVM validation pattern: http://stackoverflow.com/questions/5282919/data-validation-in-silverlight-4
    - And: http://outcoldman.ru/en/blog/show/260
    - I think I am finally at a place where I can code validation.  I will make the validation run only when the user clicks the OK button.
      Unfortunately, the LostFocus method just doesn't work, and it it did I couldn't use it because we shouldn't validate when the user clicks
      the "back" button.
  o (4/29/12) Sun:
    - 5:30 - 15:30
    - Fill in the validation code in the ViewModel, and go back to the View to present the errors.
    - Validation of the CreateNewAccount form is complete, and checked in.
    - Study the Mac SDK.
    - Study .Net HTTP asynchronous communication.
    - Here is a great post on async HTTP: http://pfelix.wordpress.com/2011/08/05/wcf-web-api-handling-requests-asynchronously/
    - Microsoft has implemented WCF Web API to make HTTP a first-class citizen. Also called ASP.NET Web API.
    - Open source REST sample app: http://restbuckson.net/
    - JSON handler: http://blog.alexonasp.net/post/2011/07/26/Look-Ma-I-can-handle-JSONP-(aka-Cross-Domain-JSON)-with-WCF-Web-API-and-jQuery!.aspx
    - WCF Web API sample code: https://github.com/pmhsfelix/WcfWebApi.Preview5.Explorations
    - Another good post with lots of examples on WCF Web API: http://www.bizcoder.com/index.php/2012/01/09/httpclient-it-lives-and-it-is-glorious/
    - Silverlight and web sockets: http://www.codeproject.com/Articles/220350/Super-WebSockets-WCF-Silverlight-5
    - WebSocket framework under Apache license: http://superwebsocket.codeplex.com/
    - A project using superwebsocket: http://www.codeproject.com/Articles/220350/Super-WebSockets-WCF-Silverlight-5
    - An HTTP parser: https://github.com/bvanderveen/httpmachine
    - A JSONP handler: https://github.com/AlexZeitler/WebApi.JsonP
    - HTTP Strict Transport Security; install via NuGet.
    - RESTful HTTP Facilitator with examples cross-platform and cross-site: https://github.com/amirrajan/Restful
    - Fluent HTTP Async Cross-platform: https://github.com/prabirshrestha/FluentHttp/
    - Synchronous HttpWebRequest example: C:\Users\BobLaptop\Downloads\SilverlightSampleApp\RestSamples
    - More on WCF Web API with asynchronous example: http://mattduffield.wordpress.com/tag/wcf-web-api/
    - Codeplex for ASP.NET Web API: http://wcf.codeplex.com/wikipage?title=WCF%20Web%20API%20is%20now%20ASP.NET%20Web%20API
    - Home page for ASP.NET Web API: http://www.asp.net/web-api
    - HttpClient released, and with OAuth example: http://www.asp.net/web-api/samples
    - Async JSON sample: http://code.msdn.microsoft.com/Introduction-to-HttpClient-4a2d9cee
    - Using JSON.net sample: http://code.msdn.microsoft.com/Using-JSONNET-with-ASPNET-b2423706
    - Using OAUTH sample: http://code.msdn.microsoft.com/Extending-HttpClient-with-8739f267
    - Downloading a file sample: http://code.msdn.microsoft.com/HttpClient-Downloading-to-4cc138fd
  o (4/30/12) Mon:
    - 6:15 - 17:15
    - Porting the CLSettings modules.
    - Cocoa to WP7 mapping tool: http://wp7mapping.interoperabilitybridges.com/Library.aspx?filterpath=iPhone-iOS_4_2-Foundation-NSArray&source=[ALL]
    - Meeting (Gus, Steve, Mike, Phil):
      . Almost there with .2
      . Indexing architecture too slow compared to Google.
      . What's pending in Server?
      . What does it take to get to 0.2?
      . Workloads:
        o Account Management
          - AC
          - UA
          - OAUTH
        o Sync
          - MDS
          - PUSH
          - Upload/Download
      . Database (partitioned or global): A priority research item.
      . Discussion about buckets.  Do we ask user for preferred location?
    - Working on CLSettings….
    - EDUCATION: FAU HPCC & GPU Users Group, 6:30 - 8:30:
      . Machine learning.
      .  
  o (5/1/12) Tue:
    - 6:15 - 17:15
    - Working on CLSettings.  Everything's a research item!!!
    - CLSettings compiles now!
    - Working on the panel buttons for choosing the amount of storage (with Blend, without much success).       
  o (5/2/12) Wed:
    - 6:15 - 18:30
    - Use the standard buttons because Rion is redoing that screen.
    - I need to present a user dialog.  This can only be done by the view.  Research that.
    - A great dialog source: http://blog.roboblob.com/2010/01/19/modal-dialogs-with-mvvm-and-silverlight-4/
    - Installed Mountain Lion Dev Preview 3 and update, and XCode 4.4 update.
    - However, in contrast to the dialog above, the dialog should be in the view: http://compositewpf.codeplex.com/discussions/69088
    - I'll use a simple one from Laurent referenced on this page: http://mvvmlight.codeplex.com/discussions/209338
    - A simple examle of displaying a list via MVVM: http://www.windowsphonegeek.com/articles/Working-with-a-simple-ViewModelLocator-from-MVVM-Lite
    - I completed a 2.5 hour time-waster: A binding was failing.  I didn't look in the output window!   DUH!
    - I completed another 1 hour time-waster: The wrong button was being fired.  That was driving into the setter logic, and the debugging breaks were
      set to ignore all exceptions.  The setter logic was getting a FileNotFoundException trying to open the Cloud folder.  That drove into code that
      navigated to an unknown screen (not coded yet).
    - The SelectStorageSize dialog is being instantiated twice.  That causes messages to be subscribed twice, and displayed twice.  I fixed that.  The
      Navigation messages must be unique.
    - The _LocalSettings file must be created.  Not true.  The debugger was stopping on a first-chance exception.
    - I'm at a good point now.  The Settings work, and navigation works with the SelectSize dialog.  Commit this and push it.
    - Interview with a front-end JavaScript developer.
  o (5/3/12) Thu:
    - 7:30 - 19:00
    - Had to rework the whole CLSettings module to make proper properties that would persist properly.  That's working now.
    - Reworking modules to properly set focus, and to use NavigatedTo events to initialize the dialog properties. 
    - Finally fixed the SetupSelector code to handle radio buttons properly.
    - Description of selecting messages to receive: http://stackoverflow.com/questions/3393286/how-to-use-mvvm-light-with-tokens
    - RadioButtons and Converters: http://www.codeproject.com/Articles/81960/Binding-RadioButtons-to-an-Enum-in-Silverlight
    - Researched a candidate: Robert Banegas, an entrepraneur.
    - Stuck: XAML can't find a converter for the radio buttons.  I'm trying to select a particular radio button via an enumeration.
  o (5/4/12) Fri:
    - 8:00 - 18:45
    - Working on the converter issue.  Got past the hang-up over the not finding the converter resource.  It works.
    - Working on making the radio button hit size larger: http://stackoverflow.com/questions/7252927/increasing-the-hit-size-of-a-radio-button
    - Now the full-cover radio buttons work beautifully!  Submit this.
    - Working on fixing the SelectSetup dialog to use the new unselected mask and full area radio button hit area.
  o (5/5/12) Sat:
    - 7:45 - 15:30
    - Got the SetupSelector dialog working with the full-box radio button hit area, and the unselected full-box screen.  Beautiful!
    - Good article on parsing e-mail addresses: http://haacked.com/archive/2007/08/21/i-knew-how-to-validate-an-email-address-until-i.aspx
    - The UI works well.  I added the default enter button everywhere, and tabs work.  Pushed this Sunday morning.
  o (5/6/12) Sun:
    - 7:00 - 14:00
    - 17:00 - 20:30
    - The GUI is complete with all of the required patterns.
    - The next goal is to get this user registered with the server.  To do that I will need to add the HTTP support.  That should
      be added in an SDK with a proper API. That should just be a class library, but I read somewhere that standard class libraries
      are not supported in Silverlight???  That would be bad.  This API needs to be used by any application.  Research this.
    - Class library requirements: http://forums.silverlight.net/p/168532/379808.aspx.
    - Basically, I have to have two class library projects.  One Silverlight, and the other a full .Net library.  The Silverlight
      library must use only Silverlight references.  The full library will use the normal .Net references.  If a particular
      module has no dependencies on one or another, it can be defined in one library and referenced in the other using "Add as Link".
    - I should make the class library as a Silverlight class library, and reference it from the Silverlight application.  A .Net
      application can reference this library, but not the other way around: http://stackoverflow.com/questions/465460/sharing-c-sharp-code-between-windows-and-silverlight-class-libraries
    - Here's how one guy targets multiple platforms (old): http://abdullin.com/journal/2009/1/4/how-to-target-multiple-net-frameworks.html  
    - Portable Class Libraries might be better: http://msdn.microsoft.com/en-us/library/gg597391.aspx
    - Here's an old MSDN Mag Retargetablility article: http://msdn.microsoft.com/en-us/magazine/cc163387.aspx
    - A walk-through of building a Silverlight Class Library: http://stuff.seans.com/2010/06/04/silverlight-4-project-types-part-iii-silverlight-class-library/
    - I found the Async CTP!  This allows asynchronous programming.  It changes the VS compilers: http://msdn.microsoft.com/en-us/vstudio/hh378091
    - HttpClient is part of the Metro API (adds PATCH support): http://www.silverlightshow.net/news/Windows-8-Patch-Support-in-HttpClient.aspx
    - I'm trying to find out whether I can use HttpClient on Silverlight....
    - It is available via NuGet: http://blogs.msdn.com/b/henrikn/archive/2012/02/20/asp-net-web-api-and-httpclient-available-on-nuget.aspx
    - File download with HttpClient example: http://www.sharpgis.net/category/Silverlight.aspx
    - I installed Async CTP into Visual Studio.
    - .Net OS support: http://msdn.microsoft.com/en-us/library/8z6watww.aspx
    - Silverlight future: http://www.zdnet.com/blog/microsoft/will-there-be-a-silverlight-6-and-does-it-matter/11180
    - Silverlight installation experience white paper: http://www.microsoft.com/en-us/download/details.aspx?id=15072&hash=7GpYSVQUaeaFdAgl56C%2b8QJKzKK9XRlcc5cl9dNuKTh3j5Qd6odj%2beDLLG5sDUNeXm6OhLixvqu85uh4TJ9irw%3d%3d
    - Silverlight works back to XP: http://forums.silverlight.net/t/252601.aspx/1
    - Request for HttpClient on Silverlight: http://wcf.codeplex.com/workitem/21
    - I installed HttpHelper into the project: http://mattduffield.wordpress.com/tag/wcf-web-api/
    - Another link: https://github.com/facebook-csharp-sdk/http-helper
    - I wanted in the worst way to use the new HttpClient support in Asp.Net Web API.  It isn't supported.  It is supported in .Net, and in Metro, but not in SL5.
      I could write it in a .Net library and use P/Invoke to get to it, but I decided against that.  I will use the HttpWebRequest API which is supported in
      .Net and SL, but not in Metro.  :(
    - Use one of the HTTP helper classes, and use async calls.
    - I will build a Silverlight Class Library.  We can port this to other platforms, possibly converting it to a Portable Class Library.  I won't take the time
      to build a portable library now.
    - Setting up a Silverlight full-trust application: http://silverlightedweb.blogspot.com/2011/12/how-to-get-unrestricted-access-in.html
    - I'm adding strings.  Localization: http://www.pochet.net/blog/2010/06/10/localization-of-xaml-files-in-silverlight/
      . And here: http://msdn.microsoft.com/en-us/library/dd941931(v=vs.95).aspx
      . Install this resource generator: http://www.pochet.net/blog/2010/06/07/code-generators-for-generating-strongly-typed-resource-classes-for-visual-studio-2010/
      . It remains to specify the resources so they can be accessed via XAML, but they should now be accessible via code.
      . How do I do that?  Tomorrow...
  o (5/7/12) Mon:
    - 6:15 - 19:15
    - Coding the next portions of the user interface, dealing with merging the cloud folder.
    - Completed the setup of localization and inserted the first message!
    - Decided I need to have more complex dialogs.  I found this: http://blog.roboblob.com/2010/01/19/modal-dialogs-with-mvvm-and-silverlight-4/
    - I need to display a nice looking dialog with an image icon, multiple lines of text with different fonts, a caption, and multiple buttons with different styles.  Try using the above post to create that.
    - The dialog works!  And it can be wired from the ViewModel, although that is probably a bad thing: http://compositewpf.codeplex.com/discussions/69088
    - However, wiring dialogs from the ViewModel is what the Mac client does, and it makes porting a lot easier.
    - Now lets see if I can make a decent looking dialog with and image, different text, etc.
    - Great JetPack themes for Silverlight: http://www.microsoft.com/en-us/download/details.aspx?id=14590
    - Also: http://www.silverlight.net/content/samples/sl4/themes/jetpack.html
    - Great example of how to bind Title= on a page to a DependencyProperty: http://stackoverflow.com/questions/2662938/ag-e-parser-bad-property-value-silverlight-binding-page-title
    - The new dialog works great!
    - A different approach to localization: http://stackoverflow.com/questions/3665823/load-resources-resx-from-folder-in-silverlight
    - Working on a problem reading the strings from resource.resx.
  o (5/8/12) Tue:
    - 6:15 - 18:45
    - I reworked the custom message box dialog for spacing, and reworked the buttons to be rectangles.  It works better now.  I can control everything I need I think.
    - Time-waster:  I need to install Async CTP into Visual Studio, but I can't because I have the Ultimate version installed, and Citrix removed that installation image from Apps.
    - I uninstalled VS2010 Ultimate, and reinstalled VS2010 Team SystePremium Edition.
    - I also installed VS SP1, updates, Async CTP, and the localization custom build utility.
    - Big time-waster.  About 4 hours.
    - While that was happening, I studied XAML, and watched a really interesting video about Convention over Configuration, and Co-Routines.  This is a great
      app architecture, and I wish I had started with that architecture.  It would make the code much simpler.  However, I have all of the patterns in place, so I will continue...
      . http://channel9.msdn.com/events/MIX/MIX10/EX15
      . www.caliburnproject.org
      . www.bluespire.com
      . devlicio.us/blogs/rob_eisenberg
    - I got the localization strings working.  Now I can proceed.
    - Another big time-waster.  After installing the new VS environment, my new dialog is throwing an exception trying to load it.  I built the MvvmLight
      framework from source, and I am debugging it.  I don't know if it is environmental, or something I changed...  It doesn't seem like it is the XAML.  Blend loads it fine.
      MvvmLight is saying that the IOC can't find the type in the cache.  It registers it fine.  Some kind of recursion?  It looks like the goForward code calls
      the IOC.getInstance.  That resolves fine and calls the EditUserModalDialogView() constructor.  That calls InitializeComponent, which loads the XAML.  The XAML loader
      somehow results in a recursive call to IOC.getInstance.  That doesn't hit the breakpoint in the ViewModelLocator.EditUserModalDialogView property, but results in
      an exception that points to the GetInstance call in that property's get function as the culprit!   ?????   That's fixed.  Only about an hour....  It was my
      fault.  I had added some code to fix several compiler warnings in the EditUserModalDialogView code-behind.  I had tried removing those changes, but apparently
      I didn't remove them correctly.  Restoring the code from a backup fixed the problem.
    - Now there are several problems in the dialog.  A long text string isn't properly wrapped in the body.  The separator is showing to the right of center, and the
      buttons are too much to the left.  For the buttons, instead of the StackPanel, I should put them in a 4-column grid.  The first column will be fixed (empty) with
      30 points.  The 2nd and 4th columns will have the buttons (Auto).  The 3rd column will be empty with "*" sizing.
    - Finally!  It all works!  And it looks very good.  Time to move on...
    - Silverlight has toast notification suupport: http://timheuer.com/blog/archive/2009/11/22/silverlight-4-notification-window-queue-sample.aspx
    - Dispatcher BeginInvoke example: http://stackoverflow.com/questions/9321684/cannot-update-silverlight-ui-from-asynchronous-method-completed-callback
    - I researched the issue of notifications back to the same class, queued vs. immediate.  I can use MvvmLight's DispatcherHelper and SL5 Tasks.
    - Interesting: The Mac client displays a folder selection dialog that looks like mac\SavedSource\ChooseAPlaceToStoreYourCloudFiles.tiff.  That is a folder
      chooser dialog that allows a big long message at the top.  I guess that's a Mac thing.  Does Windows have something like that?  Yes it does.  It's the
      FolderBrowserDialog.
    - Silverlight 5 trusted apps and file system access: http://msdn.microsoft.com/en-us/library/ee721083(v=vs.95).aspx
    - Silverlight 5 sample file explorer: http://www.c-sharpcorner.com/uploadfile/dbd951/sample-of-a-file-explorer-using-silverlight-5/
    - Ouch!  It seems that the SL5 OpenFileDialog can select files, but not folders!!!!  Do I have to make my own????
    - It is possible to use PInvoke to run the standard Windows folder selection dialog, but that might appear ugly.
    - Silverlight TreeView example: http://amjadsilverlight.wordpress.com/author/amjadsilverlight/
    - PInvoke examples: http://www.gamedev.net/page/resources/_/technical/general-programming/inter-process-communication-ipc-introduction-r2865
    - I will need to write a COM program, or an ActiveX DLL to host a WPF program that can extend Silverlight functionality where needed.  FolderBrowserDialog
      will be the first function added.
  o (5/9/12) Wed:
    - 6:15 - 18:45
    - For now, just build a new folder location dialog without the folder explorer.
    - I may need to establish some parameters for launching a View-ViewModel.  Apparently Silverlight uses Query Strings for passing page arguments,
      just like HTML.  See: http://www.informit.com/articles/article.aspx?p=1854714&seqNum=3
    - Another MVVM package: Jounce: http://www.wintellect.com/cs/blogs/jlikness/archive/tags/Jounce/default.aspx
    - One way to pass parameters: http://geoffwebbercross.blogspot.com/2012/04/mvvm-light-passing-params-to-target.html
    - Another way: http://geoffwebbercross.blogspot.com/2012/04/mvvm-light-passing-params-to-target_12.html
    - Watch Laurent's Deep Dive into MVVM again: http://channel9.msdn.com/Events/MIX/MIX11/OPN03
    - Here is a walk through of passing parameters via navigation: http://hirenkhirsaria.blogspot.com/2012_04_01_archive.html  
    - Unregistering message subscription in ViewModel: http://stackoverflow.com/questions/7036873/when-to-dispose-viewmodel-in-mvvm-light
    - More on unregistering message subscription: http://mvvmlight.codeplex.com/discussions/259098
    - An ActiveX control exposing a WIndows Forms user control, which hosts a WPF user control: http://documentation.microfocus.com/help/index.jsp?topic=%2Fcom.microfocus.eclipse.infocenter.studee60win.sp02ws01%2FGUID-0BBFFEEB-4DC6-4B5F-AFC5-6A211E826D42.html     
    - Also WPF can, in turn, host other ActiveX controls: http://msdn.microsoft.com/en-us/library/ms742735.aspx 
    - Maybe we don't need WPF, since the view will just show the standard Windows Forms folder selection dialog.
    - Windows Forms is used with WPF to show a folder selector here: http://syumulnetwork.blogspot.com/2011/09/myth-self-note-5-c-wpf.html
    - I ran into a bug with the FolderSelectionSimpleView.  I implemented it as a dialog, but SimpleIoc was locating the original dialog, not this new one.
      I inspected the MvvmLight IOC source code, and his unit test showed me the proper way to register multiple classes, all implementing the
      same IModalWindow interface.
    - Now the FolderSelectionSimpleView/ViewModel works and looks great!
    - Time to move on...
    - The next thing will be to actually perform the installation.  The Mac client uses an application delegate like this:
          CLAppDelegate *delegate = [NSApp delegate];
          NSError *error = [delegate installCloudServices];
    - I should do the same thing.  Create a singleton class with methods that perform and support installation.
    - The CLAppDelegate singleton skeleton is coded and it works.
    - The installCloudServices method returns an NSError object.  This error object encapsulates rich information about the error.
      It seems I need a similar pattern in Windows.  I will just make one.  NSError has I will make one with the following members:
      . (string) Error domain
      . (int) Error code
      . (string) String resource key used to retrieve the localized error string from the assembly resources.
      . (Dictionary<string, object>) Error information.
      . Call this class CLError.
    - While coding the installation, I realized I need a nice logging class.  Research...
    - Trace works now.  It logs to date-time named files in C:\Trash\Trace.  It also logs to the VS Output window.
    - Now I have to implement a call like the following:
            [self performSelector:@selector(startCloudAppServicesAndUI) withObject:nil afterDelay:2];
    - The caller is running on the main thread, called from SetupSelectorViewModel.  The target method should execute
      on the main thread after a delay of two seconds.
    - An interesting implementation of delayed BeginInvoke: http://blog.codethaumaturgy.com/tag/silverlight/
    - Another approach using timer: http://stackoverflow.com/questions/8094307/creating-a-delay-on-silverlight
    - Discussion of late-bound dynamic invocation: http://www.dotnetfunda.com/articles/article1428-invoking-of-delegates-in-net-part-ii.aspx
    - Delayed execution using TPL: http://www.codeproject.com/Articles/194249/Task-Parallel-Library-6-of-n
    - I decided to build a task-based extension to Dispatcher that would produce code similar to the Cocoa code:
                   Dispatcher.DelayedInvoke(TimeSpan.FromMilliseconds, () => { doStuff(); }));
  o (5/10/12) Thu:
    - 6:15 - 18:45
    - Another time-waster (1.5 hours).  My Dispatcher extension method wouldn't compile.  Finally solved it.  I had to write it like this:
                   Deployment.Current.Dispatcher.DelayedInvoke(TimeSpan.FromMilliseconds, () => { doStuff(); }));
    - The NSError equivalent (CLError) is working now.
    - The Cloud folder creation is coded.
    - The detection of multiple instances is coded.
    - I purchased Automagical (the Objective C to C# conversion utility) on the P-card.  I spent about 1.5 hours on it, and can't get
      it to do the simplest conversion.  I have asked for technical support.
    - The tour dialogs are complete.
    - Fixed a build bug on the Mac client.  The SenTestingKit.h file was not found.  This broke when I installed the new XCode release 4.4??
    - Reviewed the Mac client IconBadge changes and reran the unit tests.  There were a number of mostly refactoring changes that need
      to be pushed.  I committed the changes locally.  They are ready to push, but I don't want to do that while everyone is in CA.
    - I designed the tour to be five views.  They will all use the same ViewModel.  How should the ViewModel control the Views?  It should be
      really simple.  The ViewModel will have a PageNumber property.  The Tour1 view will be the initial navigated-to page.  Its buttons
      will be wired to commands in the ViewModel, and all other tour views will have their buttons wired to the same commands.  The
      ViewModel will take the commands, inspect and modify the PageNumber property, and will navigate to the proper tour page.  At the
      end of the tour, the UI will be done.
    - How do I remove the view entirely when the tour is over?  I think I just navigate to a null page.  That would be a navigation:Page
      with an invisible content.  Test that.  It doesn't work.  It shows as a normal window with a white background.
    - But that's not what I want anyway.  An invisible application is no good.  It can't be controlled, and it appears in the
      taskbar.  It needs to minimize itself to the system tray with a menu, status and toasts.  I already researched that above.
      Search for "minimize".
    - Minimizing an application to the system tray: http://www.codeproject.com/Articles/27599/Minimize-window-to-system-tray
    - Researching that again.  I might have to resort to WPF!   :(  Silverlight is a risk item, but if it is possible, it
      would keep our executable small, and it would mostly work on WP7, Metro, and WP8.
    - I downloaded the Silverlight NESL open source project source code.  That supports minimizing to the system tray.
  o (5/11/12) Fri:
    - 6:15 - 18:45
    - I decided to switch to WPF.  Silverlight is good, but it has issues, and may have more.  I should be able to
      overcome the issues, but WPF is a standard Windows app, so I should be able to do anything.  The major Silverlight
      issues are:
      . Right-click anywhere on the window brings up a Silverlight context menu.
      . No direct support for minimizing to the system tray.
      . No support of a folder selection dialog.
    - Will switching back to Silverlight be difficult?
      . MvvmLight supports WPF and Silverlight.
      . All of the UI, notification, and validation patterns have been developed on Silverlight.  Keeping those patterns
        should allow easy conversion back to Silverlight.
      . The sync engine should be straight C# code, applicable to either.
    - I will change the directory structure to support building in either.  Almost all of the code will be in a common
      directory, using preprocessor instructions to build differently for each platform.
    - Test the existing UI first, commit and push, then start working on WPF.
      . Continue command -> new or merge dialog
      . I said select a new location -> enter new location dialog
      . I selected C:\Users\robertste\test and clicked continue -> sent conflict resolved message
      . That issues a recursive call to goForward
      . Use a delayed method call here.
      . This delayed method call will need a parameter (the dictionary).  That is new.  Build it and test it.
      . I'm having trouble compiling the delegate.  This seems to be the answer: http://stackoverflow.com/questions/968709/anonymous-methods-and-delegates
      . And more delegates: http://msdn.microsoft.com/en-us/library/ms173176.aspx
      . That fixed it.
    - Started the WPF conversion.  I copied the Silverlight directory to win-client20120511SilverlightFinal.  Then I made a WPF project called
      win-client in the original win-client directory, and added all of the existing code to the project.  It fails immediately on XAML navigation:frame.
      Apparently the navigation is different between Silverlight and WPF.  WPF uses NavigationWindow.  Research that.
    - WPF/Silverlight differences: http://msdn.microsoft.com/en-us/library/cc903925(VS.95).aspx
    - Apparently WPF doesn't implement iNotificationDataErrorInfo.  That causes my Silverlight validation to break (compilation).
    - Interesting cross WPF/Silverlight Validation Toolkit: http://validationtoolkit.codeplex.com/ Problem: GNU GPLv2 license.
    - 
    - WPF Change list:
      . The main App.xaml and App.xaml.cs are different, and just a stub.
      . App.xaml points to NavigationPage.xaml.
      . NavigationPage.xaml loads MainPage.xaml.
      . "navigation:Page"a in all of the top level navigation pages changes to "Page".
      . In XAML, change ValidatesOnNotifyDataErrors to ValidatesOnDataErrors.
  o (5/12/12) Sat:
    - 9:00 - 14:00
    - 16:00 - 17:00
    - Interesting Validation toolkit: http://fluentvalidation.codeplex.com/wikipage?title=CreatingAValidator&referringTitle=Documentation
    - Implementing INotifyDataErrorInfo.  This works in Silverlight, but is missing in WPF.
    - Another validation toolkit.  This one has an error template that we could override: http://www.codeproject.com/Articles/32814/Total-View-Validation
    - Navigation in WPF: http://msdn.microsoft.com/en-us/library/ms750478.aspx
    - One good way to navigate in WPF: http://stackoverflow.com/questions/9290269/mvvm-light-toolkit-galasoft-for-wpf-navigation-through-windows
    - I will use the method above to navigate.
    - Another (strange?) way to do navigation in WPF: http://www.lapthorn.net/archives/600
    - I have the INotifyDataErrorInfo validation mostly compiling OK.
    - I ran into another problem: Navigation in WPF is quite different than Silverlight.
    - I have a compilation error.  The OnNavigatedTo and OnNavigatedFrom events aren't supported.
    - A Page (view) has a NavigationService.  A NavigationService supports the Navigated event.  The Navigated event handler gets event args:
      . Content: Root node of the target page's content.
      . ExtraData: Optional user defined data.
      . IsNavigationInitiator: Did the current navigator initiate the navigation?
      . Uri: Target page.
      . WebResponse: Can be used to retrieve HTTP response headers.
      . Documented here: http://www.lapthorn.net/archives/600
    - None of this looks pertinent.
    - I think I can just use the NavigationService.Navigated event, and not worry about the event args.
    - However, Silverlight doesn't use a NavigationService, so I will need to retrieve that at page load time???
    - I got the OnNavigatedTo event handler coded and built.
  o (5/13/12) Sun:
    - 6:30 - 14:00
    - 15:00 - 16:30
    - IsolatedStorageSettings is a Silverlight thing.  It is not supported in WPF.  Researching Settings in a WPF application environment.
    - Implemented IsolatedStorageSettings for WPF.  CLSettings builds now.
    - There are issues with the PasswordBox control in WPF.  Silverlight treats that as a DependencyProperty, so it can be bound to, and the
      password is in the clear to the code.  This makes validation easy because the validator can look at the actual text and determine whether
      it meets the password strength required, etc.  Researching this...
    - Creating an attached property for PasswordBox: http://blog.functionalfun.net/2008/06/wpf-passwordbox-and-data-binding.html
    - I think there are two problems here:
      . The Password field is not a DependencyProperty, and so is not bindable for validation, etc.  The code above should help with that.
      . In ForceValidation(), I use GetBindingExpression(PasswordBox.PasswordProperty) for the Silverlight PasswordProperty DependencyProperty.
        Then I locate the parent of that binding expression with bindingEpression.ParentBinding.  Then I check to see if that element
        has specified ValidatesOnNotifyDataErrors (which also needs to be changed to ValidatesOnDataErrors).  The problem is: The PasswordBox
        control doesn't have a PasswordProperty, and the code above won't help that.  Also, the code above does not add a binding expression
        to the PasswordBox.Password property, so there is no binding expression to find!  There must be a solution to this.  Research....
    - Another guy using the above code: http://stackoverflow.com/questions/2999779/data-validation-on-wpf-passwordboxtype-password-re-type-password
    - Another guy using the above code as well: http://stackoverflow.com/questions/8942259/error-handling-in-wpf-passwordbox
    - Here is a derivation of the above code: http://www.wpftutorial.net/PasswordBox.html
    - This might be the solution.  It is a bindable password custom control that is implemented as a Decorator of PasswordBox: https://gist.github.com/468331
    - Try that solution.  It is coded and it builds.  Hopefully that will work.
    - Didn't work.  The trouble with this Decorator solution is that it doesn't expose all of the other properties and DependencyProperties of PasswordBox, because
      it is derived from Decorator.  I might be able to make it work by adding all of the other PasswordBox properties, but that seems like a lot
      of work, and it would be fragile.
    - Some detailed info about bindings: http://www.hardcodet.net/2008/04/wpf-custom-binding-class
    - This adds a DependencyProperty to a control: http://stackoverflow.com/questions/1088906/adding-a-custom-dependency-property-to-a-control-template-in-xaml
    - Good tutorial on DependencyProperties and AttachedProperties: http://www.wpftutorial.net/dependencyproperties.html
    - Overriding a DependencyProperty: http://stackoverflow.com/questions/9319328/hiding-a-dependency-property
    - In the case of the WPF PasswordBox Password property, it is defined as a property, but not as a DependencyProperty.  I would like to turn
      it into a DependencyProperty.  It seems that I need to add the DP because it doesn't already exist, but I need to access the existing
      Password property in the new DP getters and setters.  Try that.
    - My first try at that didn't work, because I couldn't derive from PasswordBox.  It is a sealed class!!!!  ARRRGGGHHH!
    - I found a completely different secure password approach deriving from an UN-sealed TextBox and it worked: http://www.codeproject.com/Articles/30976/Passwords-in-WPF-How-to-find-yours-and-how-to-prev
    - Down to 24 errors.  Fixing navigation will remove most of those.  On to navigation...
    - With MVVM, the ViewModel is not supposed to actually navigate, because that would imply knowledge of the views.  Instead, the ViewModel
      sends a messasge to the View, and the View actually navigages.  That is the way it is implemented for Silverlight.  A navigation message
      handler in the View currently looks like this:
                Messenger.Default.Register<Uri>(this, "PageSelectStorageSize_NavigationRequest",
                                   (uri) => ((Frame)(Application.Current.RootVisual as MainPage).FindName("ContentFrame")).Navigate(uri));
    - I have already changed the views to locate the NavigationService (above).  The navigation service supports the NavigateTo() method:
                NavigateTo(new Uri(@"/PageXXX",UriKind.Relative)); 
    - I will just change the navigation to use this syntax.  The new syntax is this:
                Messenger.Default.Register<Uri>(this, "PageSelectStorageSize_NavigationRequest",
                                   (uri) => { this.NavigationService.Navigate(uri); });
    - Done.  Now down to 6 errors.
    - The last? build problem is the inability of the code-behind to see the named common:SecurePasswordBox 
    - WPF Snoop tool: http://blois.us/Snoop/
    - It builds!
  0 5/14/12 Mon:
    - 8:30 - 18:30
    - Debugging the WPF application.
    - Trip to the Boca Raton Apple store, and lunch at 5 Guys.
    - Interviewed David Bruck.  We hired him as contract-to-hire.
    - The home page shows, and I can navigate to the CreateAccount page, but I am debugging an exception in the MvvmLight command code when I try to navigate back to the home page.
  0 5/15/12 Tue:
    - 6:15 - 18:30
    - I solved that bug.  It was an invalid cast first-chance exception that was resulting in a different exception way down in the framework code.
    - Possible solution to the current validation problem:  http://stackoverflow.com/questions/127477/detecting-wpf-validation-errors
    - Validation in WPF tutorial: http://blogs.msdn.com/b/bethmassi/archive/2008/06/27/displaying-data-validation-messages-in-wpf.aspx
    - I finally fixed the validation.  I had to implement IDataErrorInfo.  The ValidationToolkit should be deleted, except for the errorTemplate.  We will
      need to rework even that!
    - I ran into another problem with the pesky secure password fields.  The binding was passing the encrypted passwords to the ViewModel.  That
      didn't validate.  I changed the design to use the password field Set function to send a message to the view, which retrieved the clear password
      and set it to a write-only ViewModel property Password2.  Since all of that was synchronous, the validation is now performed on Password2 in the
      same Password setter.
    - Now the next problem....  The dialogs don't work.  Surprise!
    - This is the same problem as before?  The SimpleIOC lookup fails and throws an exception.  I tried looking for the type IModalWindow with the proper key.
      That located the service, but it also caused a recursion trying to instantiate an instance of the target modal dialog view.
    - Tomorrow....
  0 5/16/12 Wed:
    - 6:30 - 17:30
    - Interestin very simple IOC built from scratch: http://www.remondo.net/building-simple-ioc-container-csharp/
    - Current bug: SimpleIOC isn't working properly to get the CloudMessageBoxView instance.
      . In DoGetService, the instance doesn't exist yet in _instancesRegistry.
      . The service type (Dialog.Abstractions.Wpf.Intefaces.IModalWindow) is found in _interfaceToClassMap.
      . So we build a new empty dictionary and add the dictionary to the _instancesRegistry using the service type key above.
      . We look to see if the dictionary (instances) contains the parm key ("dialog_box_CloudMessageBoxView").  If so, we would return that instance.  It doesn't exist yet.
      . So we go about building an instance.
      . We look to see if _factories contains our service type.  It does.
      . In the factory for our service type, we look to see if it contains our parm key.  It does.
      . So we do this:
                instance = _factories[serviceType][key].DynamicInvoke(null);
      . That results in an extended recursion on the view constructor and usually crashes VS.
      . I found the problem.  The dialog views were constructing themselves as the DataContext, not the ViewModels.
    - Next problem:  The dialog does not appear over the SetupSelector view.  The dialogs are created by the Extended WPF Toolkit: http://wpftoolkit.codeplex.com/SourceControl/list/changesets
    - I downloaded the WpfToolkit source, built it, and I am debugging to find the solution.
    - David Bruck joined us today.  I spent some time with him, building his machine and explaining the project.  He will start with a badging demo.
    - Styled pop-up control hosted in a UserControl: http://rachel53461.wordpress.com/2011/08/20/popup-panel-for-wpf/
    - Another modal UserControl: http://lexa.tatalata.com/?p=305
    - Data binding using ViewSources: http://code.msdn.microsoft.com/windowsdesktop/Wpf-ViewSource-Example-on-210f2cd2  
    - Tool to inspect visual and logical trees: http://www.codeproject.com/Articles/21495/Understanding-the-Visual-Tree-and-Logical-Tree-in
    - Still working on the dialog.  It seems that they don't work because they haven't been added to the element tree.  I'm modifying the Extended WPF Toolkit and
      the dialog support to pass the Page's LayoutRoot grid as the parent container for the dialog.  I should finish that in the morning.  I hope it works.
  0 5/17/12 Thu:
    - 6:15 - 17:45
    - EDUCATION: GCUG Guest Suites, Boca, 6:30 - 8:30: Using Windows 8 HyperV to spin up and actively move VM resources.  Amazing!
    - The dialogs are working now.  WPF was laying them out in the first row of the grid only, and the layout was somehow painting just a slice down the left.  David helped me
      see that and we stretched the dialog out over all of the row and column definitions of the grid.
    - Now the first dialog paints a dotted rectangle in the upper left corner, same size as the dialog.
    - Now I am fighting with a failure to navigate (SetupSelector navigating to PageTour1 after showing a couple of dialogs).
    - I know what the bug is.  The general dialog box is used multiple times without being disposed.  Each time it adds a Closed callback, so the OnClosed event
      is driven multiple times, and the ViewModel attempts to navigate twice.  But how to fix it?  Tomorrow....
  0 5/18/12 Fri:
    - 6:15 - 18:45
    - One-shot lambda event handler: http://stackoverflow.com/questions/2150581/one-shot-events-using-lambda-in-c-sharp
    - I fixed that "navigation twice" bug.  I used the one-shot lambda approach above.  Showing the dialog adds a Closed event handler.  When the Closed event handler
      fires, it does its job, and then removes itself from the RoutedEvent chain.
    - Now work on the next bug.  The first dialog displays a dotted line the same size as the dialog, but in the upper left corner of the window.  This must
      be a bug in WPF?  It seems that it is the default "focus" indicator.  Perhaps it wouldn't show if I give something else the focus?  Like the containing grid?
      That was David's suggestion.  Try it.  I tried it before the Show.  That didn't work.  Perhaps in the ChildWindow?  I tried it after setting the WindowState to Open.
      That didn't work.
    - XAML tutorial: http://www.wpftutorial.net/XAML.html
    - I spent about 6 hours on this problem, trying to get DependencyProperties to fire correctly.  I can't get it to work.  I used a simple workaround: Set the
      actual FocusedElement property to point to btnOK in the code-behind.  That works now.  The right button now has the dotted line around it, and the
      big ugly dotted line is gone.  Yay!
    - I spent some time making the dialogs size properly with a minimum width and height so the fields are always visible.
  0 5/19/12 Sat:
    - 7:00 - 15:00
    - Assembly info: http://srikanthtechnologies.com/articles/dotnet/globalassembly.html
    - I made another pass over the dialog layout.  They look good now.
    - Pushed the changes, in two batches.
    - I researched the question of how to implement the API (managed or unmanaged).  I came to the conclusion that ours is a brand new API with no users
      out there.  If they want to write in C++, they can use the new managed C++ compiler and access our API directly.
      see: http://msdn.microsoft.com/en-us/library/ms973872.aspx.
    - Design guidelines for class library developers: http://msdn.microsoft.com/en-us/library/ms229042
    - Implement Finalize and Dispose to clean up unmanaged resources: http://msdn.microsoft.com/en-us/library/b1yfkh5e
    - I read through the design guidelines for class libaries.  I decided to implement only asynchronous interfaces for lengthy operations.
      That will keep it compatible with Silverlight apps.  I will use the delegate callback pattern.
    - Errors will be delivered by exceptions bubbling up the stack.  This is the recommended way for frameworks.
    - Delegate callback example: http://www.myelin.co.nz/notes/callbacks/cs-delegates.html
    - Async Programming Model (APM) "Guy on a horse": http://social.msdn.microsoft.com/Forums/en-US/csharplanguage/thread/faa5da25-f50c-4a87-b1e8-ed7a6ec8cd71
    - Here is one way using TPL to capture the async exception and the async result: http://stackoverflow.com/questions/8748645/catching-an-exception-thrown-in-an-asynchronous-callback
    - I think we should drive the callback on the UI thread.  Our callback (after the async operation) will be on a worker thread, so I will use Dispatcher.Current.BeginInvoke()
      to drive the API-caller's callback on the UI thread, with the result code, and possible exception info.  That should work.
  0 5/20/12 Sun:
    - 9:30 - 16:30
    - Exceptions in Tasks: http://msdn.microsoft.com/en-us/library/dd997415.aspx
    - How to return an arbitrary object result from an asyncrhonous task: http://msdn.microsoft.com/en-us/library/dd537613.aspx
    - Chaining continuation tasks: http://msdn.microsoft.com/en-us/library/dd537612.aspx
    - Class library localization: http://stackoverflow.com/questions/1138934/c-sharp-class-library-localization.
    - I determined the asynchronous pattern we will use (see it in CLApiRegistration).  It provides for asynchronous tasks that return
      an arbitrary result object (perhaps just an int) and a potential exception object that may have been generated by the asynchronous task.
    - CLApiDevice and CLApiAccount are coded.
    - Research HttpClient again.  The support for that class is one of the major reasons I switch to WPF.
    - Here is an introduction: http://code.msdn.microsoft.com/Introduction-to-HttpClient-4a2d9cee
    - HttpClient requires the following NuGet packages to be installed in the project:
      . System.Net.Http: The main NuGet package providing the basic HttpClient and related classes
      . System.Net.Http.Formatting: Adds support for serialization, deserialization as well as for many additional features building on top of System.Net.Http
      . System.Json: Adds support for JsonVaue which is a mechanism for reading and manipulating JSON documents
      . I installed those on my home laptop.
    - HttpClient by example: http://alexmg.com/post/2009/04/07/Introduction-to-the-HttpClient.aspx
    - More HttpClient by example: http://www.bizcoder.com/index.php/2012/01/09/httpclient-it-lives-and-it-is-glorious/
    - It is possible to build up HttpContent post data like this:
                var postData = new List<KeyValuePair<string, string>>(); 
                postData.Add(new KeyValuePair<string, string>("Name", "test")); 
                postData.Add(new KeyValuePair<string, string>("Price ", "100")); 
                HttpContent content = new FormUrlEncodedContent(postData); 
    - Example of using a CancellationToken: http://stackoverflow.com/questions/4783865/how-do-i-abort-cancel-tpl-tasks
    - I'm researching ways to use the CancelationToken to allow the user of an API to specify a timeout for a particular
      operation.
    - Do it like this: var cancelTokenSource = new CancellationTokenSource(TimeSpan.FromSeconds(3)).
    - See http://www.sadev.co.za/content/net-45-baby-steps-part-2-task-timeout-cancellation
    - Change the API to allow the user to specify a timeout in seconds.
    - This function requires .Net 4.5.  Why not?  It will be released by the time we go out.
    - I installed .Net 4.5 on my home laptop.
    - For some reason, only the default CancellationTokenSource() constructor is available in .Net 4.5, even though the web
      docs say it should be there.  That was a small time-waster.
  0 5/21/12 Mon:
    - 6:15 - 18:00
    - Installed .Net 4.5 at work.
    - Installed the HttpClient NuGet packages.
    - Worked on very slow Mac performance.  Had to reboot the system.  The memory was very low.
    - Installed the Newtonsoft JSON library NuGet package on my work machine.  It uses the MIT license.
    - The server registration code is at code complete.  Time to test it...
    - processRegistration is the function that should communicate with the server to register the user.  Presently, the Windows code
      just moves on to select the storage size.  Change that to register with the server.
    - I worked with David to try to create a global IsBusy progress bar, the one shipped with the Extended WPF Toolkit.  We weren't
      successful doing that, so I will just add it to the pages that need to use it, and wrap all of the existing content on the page
      with the busy indicator control.  That's done.
    - Part of the global busy indicator trial was to create a global ViewModel and View.  The View was in NavigationWindow.xaml, and
      the ViewModel was in the App.Xaml resources.  Those resources load with the application and the properties in the ViewModel
      can be referenced in other code like this:
                  BusyIndicatorModel myBusyIndicatorModel = (BusyIndicatorModel)Application.Current.Resources["BusyIndicatorModel"];
    - The rest of the day I was coding the user registration.  Not quite complete.
  0 5/22/12 Tue:
    - 6:15 - 19:00
    - I found that I need the snazzy message box dialog to display only the OK button, so I will add a binding on the left
      button to make it visible or not.  Done.
    - I was successful at registering a user, but I am still trying to parse the JSON response using JSON.net.
  0 5/23/12 Wed:
    - 6:15 - 18:30
    - Deserializing JSON to a hierarchical Dictionary<string, object>: http://stackoverflow.com/questions/1207731/how-can-i-deserialize-json-to-a-simple-dictionarystring-string-in-asp-net
    - Using Linq with JSON: http://stackoverflow.com/questions/5033178/net-linq-to-json-with-newtonsoft-json-library
    - Registration works properly!
    - The first tour page now properly presents the user's first name in the greeting.
    - Removed duplicate resource manager code from CLAppDelegate.cs.
    - Startup with dynamic StartupUri choice: http://stackoverflow.com/questions/3439320/is-there-a-way-to-start-a-wpf-application-without-startupuri-that-doesnt-break
    - Another dynamic StartupUri choice: http://stackoverflow.com/questions/1945843/how-to-change-startupuri-of-wpf-application
    - Determine the number of app instances per user: http://benjsoft.blogspot.com/2011/01/c-ensure-that-single-instance-of-your.html#!/2011/01/c-ensure-that-single-instance-of-your.html
    - The test for "Cloud app already running for this user" is working.  It puts up a dialog with an OK button if the application is already running.
    - Next goal: Get isFirstTimeSetupNeeded() working.  If it is needed, put up the welcome dialog that is already working.  If not, don't put up any dialog at all.
    - Time-waster: 0.5 hour.  I saw the C:\Users cloud directory again.  I couldn't find where that was set.
    - Minimizing to system tray using WinForms assembly: http://possemeeg.wordpress.com/2007/09/06/minimize-to-tray-icon-in-wpf/
    - WPF context menu for system tray icon: http://social.msdn.microsoft.com/Forums/br/wpf/thread/01b6f20c-d4fb-4956-a3f6-d5e5d91bd239
    - System tray apps, complete?: http://www.simple-talk.com/dotnet/.net-framework/creating-tray-applications-in-.net-a-practical-guide/
    - WPF NotifyIcon support, without WinForms!: http://www.codeproject.com/Articles/36468/WPF-NotifyIcon
    - I installed it on my iMac (Hardcodet.Wpf.TaskbarNotification), via NuGet.
    - Some source that demos how to minimize to system tray?: http://archive.msdn.microsoft.com/TheNotifyIconExample
    - Minimizing to system tray with WinForms example: http://blog.qurbit.com/tutorials/getting-your-c-app-to-run-in-the-system-tray/
    - I found a minimize-to-tray sample that works fine.  I'll use it.
      . License: Freeware: http://www.broccoliproducts.com/profile.php
      . Documentation and download: http://www.broccoliproducts.com/softnotebook/trayicon/trayicon.php     
    - I got the SysTray Minimize support code (HookWrapper and TrayIcon) integrated and built.
  0 5/24/12 Thu:
    - 6:15 - 18:45
    - I got the application down into the system tray!  There is no task bar icon.  The system tray icon has a tooltip, and the app is running!
    - However, I am using the TrayIcon classes from www.broccoliproducts.com.  I need to use the NotifyIcon for WPF tray icons instead.  They are much more functional.
    - I moved the NotifyIcon for WPF project into the win-client directory to save the source, and fixed the references.  It is in the win-client\3rdParty subdirectory.
    - Create a demo service that will exercise the system tray capabilities, like toasts, menus, etc.  To do that, I will need to initialize the services (most of them dummy at this point).
    - Add the Exit menu item and make that functional.  It will cause the app to close all of the services and exit, cleaning up all of the resources.  That's the next goal.
    - I got all of the core services stubbed out, and the notification service has a test 1-second timer event on a separate thread to drive some tests of the
      pop-up toasts, etc.
    - Implementing the Taskicon NotifyIcon stuff....
  0 5/25/12 Fri:
    - 6:45 - 19:00
    - "James going-away lunch"
    - Team movie.
    - The notify icon should be added to the invisible window in XAML.  When the user clicks the preferences button on the system tray icon context menu,
      that will show the NavigationWindow and navigate to the proper page.  When the tour ends, the last NavigationWindow-based page should be unloaded
      and the InvisibleWindow should be shown, making the system tray icon visible.  Maybe I should always start the InvisibleWindow, initially with the
      system tray icon invisible.  NavigationWindow and InvisibleWindow need to be globally accessible.  Perhaps they should register themselves to
      CLAppDelegate.  When the NavigationWindow is shown, the application should be shown in the task bar again.
    - Invoking MvvmLight RelayCommand from code-behind: http://stackoverflow.com/questions/4136776/firing-relaycommand-from-codebehind-bound-to-vm
      . Do it like this: 
              var viewModel = (MyViewModel)DataContext; 
              if (viewModel.MyCommand.CanExecute(list)) {
                viewModel.MyCommand.Execute(list); 
              }
    - The NotifyIcon stuff works, but it puts up two icons, and the icons aren't fixed on the system tray toolbar.  They appear in the pop-up
      window.  Also, Gus doesn't like the fancy stuff.
    - Goals: 
      . Put up only a single icon.
      . Make everything standard Windows look.  Use the WindowsForms stuff if I have to:
        o Standard Windows tooltip.  Hover over the icon to see this text-only tooltip.
        o Standard Windows balloon tips.  These are programmatically triggered, fade and disappear automatically.  They point to the icon in the system tray.
        o Standard Windows context menu.  Right-click to see this context menu pop-up.
        o WPF-styled pop-ups for "growl" notification support.  These are programmatically triggered, and they fade and disappear automatically.  They can
          contain any WPF content.  They have only an "X" close button.
        o WPF-styled active window pop-ups.  Left-click on the icon and the window pops up.  It can have any WPF content and/or controls.  This one I won't hook
          up until we need it.
        o The icon should always be shown in the system tray.
    - I got the command bindings working on the context menu, but there are still two icons being created.
  0 5/26/12 Sat:
    - 7:30 - 16:15
    - Debugging bindings: <MenuItem Header="Show Cloud Window" Command="{Binding ShowPreferencesPageCommand, Converter={StaticResource DebugConverter}, ConverterParameter=A}">
    - New problem: The WindowInvisible is not being constructed before the services are initialized, causing an exception.  I need to wait
      for the window to be constructed before I continue with intialization of the services.  When just going to the tray, use the WindowInvisible Loaded event
      to send a queued and delayed event to CLAppInitialize to start the service initialization.  Currently, CLAppDelegate immediately calls startCloudAppServicesAndUI()
      if first-time setup is not needed.  I need to have this method fired some time after the WindowInvisible Loaded event fires.  That worked.
    - Now I have a single icon showing, and the context menu (fancy) works.  The test timer is firing every second.  
    - Next, find a way to put up a standard context menu, while keeping the fancy toasts as a substitute for growl support.
    - Another very nice pop-up window when you hover over the system tray icon: http://www.codeproject.com/Articles/36788/WPF-XAML-NotifyIcon-and-Taskbar-System-Tray-Popup
    - Here is someone trying to get a standard context menu using NotifyIcon for WPF:
      . http://stackoverflow.com/questions/9251665/tray-icon-context-menu-positioning-in-wpf-application
      . http://wyday.com/blog/2008/vista-menu-with-icons-in-c-sharp/
      . http://stackoverflow.com/questions/5055433/how-to-display-a-windows-7-style-context-menu
    - The standard context menu is working now, with icons!
    - Now show the standard tooltip.
    - The standard tooltip works, but it shows underneath instead of on top of the cursor.
    - Context menu position: http://www.hardcodet.net/projects/wpf-notifyicon
    - Embedding .Net controls into the standard balloon tooltip: http://www.codeproject.com/Articles/37912/Embedding-NET-Controls-to-NotifyIcon-Balloon-Toolt
    - Determining the NotifyIcon window coordinates: http://blog.quppa.net/2010/12/08/windows-7-style-notification-area-applications-in-wpf-part-2-notify-icon-position/
    - And part 3 of the above: http://blog.quppa.net/2010/12/09/windows-7-style-notification-area-applications-in-wpf-part-3-taskbar-position/
    - I got the standard tooltip working, and placed reasonably well, although the placement is not 100% optimum.
    - I made a change to the NotifyIcon for WPF library to make the tooltip placement better.
    - Next, show the standard balloon tips.
    - Next problem: The CLNotificationService wants to show the balloon tooltips, but it is the view that should do all of the UI!  :(  I'll have to create a
      custom balloon tooltip class with the info I need, and send it as a message to the view.  The view will use the info to start the tooltip.  The
      tooltip will fade on its own.  However, only the ViewModels know about their Views.  Yikes!  I think I will just go directly to the view with this
      one.  I'll use the MvvmLight messaging.
    - The standard balloon tooltips work!
    - Now test the fancy "growl" notifications.  That will require another data class, message, registration, send and final action in the view.
    - The fancy growl notifications work.
    - Now the only thing left is to pin the NotifyIcon to the system tray.  Tomorrow...
  o 5/27/12 Sun:
    - 7:00 - 16:00
    - Fix up the context menu layout, and add Check for update...  Also, figure out how to bind to the resource strings from XAML.
    - Binding XAML to enums: http://www.ageektrapped.com/blog/the-missing-net-7-displaying-enums-in-wpf/
    - System tray design guidelines: http://msdn.microsoft.com/en-us/library/windows/desktop/aa511448.aspx
    - The keyboard accelerators don't work, and the "&"s don't show as underlines.  The context menu is a WPF menu that looks like
      a Windows form's menu.  I will need to implement the keyboard accelerators in the WPF way at 508 time.
    - I tried to get the NotifyIcon always visible on the system tray.  I could probably make that happen, but decided against it.  It is
      the user's choice.  The Dropbox icon is not on the system tray either.
    - Get the exit path working.  That works now, and the application exits.
    - David will provide the remaining shell integration in his COM object: Explorer context menu.
    - Installed more git Visual Studio integration (Git Extensions).
    - I spent 1.5 hours in git hell, but the system tray changes were pushed.
    - What's next?  Working on the services?:
      . Badging
      . UI Activity
      . Indexing
      . Network monitoring
      . File system monitoring
      . Cloud folder monitoring
      . Sync
      . Notification
    - I initialized and terminated the BadgeNet COM object.  That required a small change to allow for restarts of the badging service.
    - I pushed the system tray changes.
    - RSync thesis: http://www.samba.org/~tridge/phd_thesis.pdf
    - I read through Phil's documentation of the MDS and Storage HTTP commands.  They were mostly unintelligible to me.  Minimial and
      unusable documentation.  Obviously the code will tell me what is really going on...
    - I researched syncing on the web for a while.  I didn't really find anything but RSync, which is GPL-licensed.
    - I think it is time to start studying and documenting the Mac client code.  I will sync it down to my laptop and start that process.
    - I completed the documenting of many of the services.
  o 5/28/12 Mon:
    - 6:00 - 12:15
    - All of the services, and about half of the CloudSDK public API is documented.
    - I think we can faithfully duplicate this code with a direct port to Windows.
  o 5/29/12 Tue:
    - 6:30 - 18:30
    - Wrote a status memo on the work this weekend.
    - Investigate the reimplementation of GCD on the Windows side.
    - GCD in C#: https://gist.github.com/451978
    - GCD in C: http://blog.quiscalusmexicanus.org/post/4916668260/grand-central-dispatch-for-win32-the-port      
    - Utility to convert line endings: sfk165: http://www.stahlforce.com/dev/index.php?tool=remcrlf&back=dev
            Open a dos cmd window and enter command :
              sfk165 lf-to-crlf [or addcr] [dir .ext1 .ext2] or [singlefile]
                  or
              sfk crlf-to-lf [or remcr] [dir .ext1 .ext2] or [singlefile]
    - Working on porting the CLSyncService.m module.  Maybe a bad choice of starting points because it pulls in the whole world.....
  o 5/30/12 Wed:
    - 6:15 - 19:00
    - DTOs and POCOs: http://rlacovara.blogspot.com/2009/03/what-is-difference-between-dto-and-poco.html
    - LINQ2SQL: http://www.sidarok.com/web/blog/content/2008/10/14/achieving-poco-s-in-linq-to-sql.html
    - Massive, dynamic DB access like ActiveRecord in Rails: https://github.com/robconery/massive
    - HttpClient stream download to file: http://code.msdn.microsoft.com/HttpClient-Downloading-to-4cc138fd
    - HttpClient stream upload to file: http://blog.alexonasp.net/post/2011/07/27/POSTing-Uploading-Files-using-the-WCF-Web-API.aspx
    - Priority queues: http://s291.codeinspot.com/q/1335328
    - Parallel tasks: http://msdn.microsoft.com/en-us/library/ff963549.aspx
    - Compare threading approaches: http://nitoprograms.blogspot.com/2010/08/various-implementations-of-asynchronous.html
    - New Async Methods: http://nitoprograms.blogspot.com/2010/08/various-implementations-of-asynchronous.html, and http://www.microsoft.com/en-us/download/details.aspx?id=19957
    - The above document (2nd URL) has a very fast method for down-streaming a file.
    - I need a stand-in for NSOperationQueue.  The mac client uses the following features:
      . A queue of uploads
      . A queue of downloads
      . For each, specifying the concurrency allowed.  Up to that many operations will be ongoing at once.  The rest will be queued.
      . For each, the ability to cancel all of the operations.
      . For each operation, progress call-backs.
      . For each operation, indivually cancel
      . For each operation, indivually completion callback.
      . Exceptions or other errors will drive the completion callback with NSError.
      . Results are provided with the completion callback.
    - I can use the TAP (Task-based Async Pattern) described above, but I need to wrap it in a queue and have a dispatcher.
    - I would like to keep the same code pattern so the port is straight-forward.
    - The patterns in use in the mac client are:
      . An upload or download operation is represented by CLHTTPConnectionOperation.
      . A download operation is created:
              __block CLHTTPConnectionOperation *downloadOperation = [self.restClient streamingDownloadOperationForStorageKey:event.metadata.storage_key
                                                                                                     withFileSystemPath:fileSystemPath
                                                                                                               fileSize:event.metadata.size
                                                                                                             andMD5Hash:event.metadata.hash];
      . Then set the download operation progress block:
               [downloadOperation setDownloadProgressBlock:^(NSInteger bytesRead, NSInteger totalBytesRead, NSInteger totalBytesExpectedToRead) {
                    // accumulate progress and update the UI
              }];
      . Then set the download operation completion block:
              [downloadOperation setOperationCompletionBlock:^(CLHTTPConnectionOperation *operation, id responseObject, NSError *error) {
                   // stuff to do on completion
              }];
      . Then add this download operation to a list of operations:
             [operations addObject:downloadOperation];
      . Then add all of the operations to the NSOperationQueue:
             [self.downloadOperationQueue addOperations:operations waitUntilFinished:YES];
      . Note the last waitUntilFinished:YES.  That actually blocks!!!!!!! until all of those huge terabyte files complete their upload/download!
      . So, what should I do?
        o Use the CLHTTPConnectionOperation mostly as is, because it is the POCO for the operation.  I'll have to connect it to HttpClient.
        o CLHTTPConnectionOperation will derive from CLNSOperation.
        o Make a new class (CLNSOperationQueue) to represent NSOperationQueue. Done.
      . Apparently the mac client uses the Start method like the Main method is intended, however the mac code works fine.
      . I think I will just implement the main method and change the code slightly.  Simpler...
      . Good example of TAP: http://www.codeproject.com/Articles/127291/C-5-0-vNext-New-Asynchronous-Pattern
      . An async document "lab" is in c:\source\Documents.
      . Time-waster: Trying to get the Async CTP installed in VS 2010.  Aborted.  Spent a lot more time installing VS2011 beta full
        premium version.
  o 5/31/12 Thu:
    - 6:15 - 18:15
    - VS2011 finally installed.  Installed documentation.  Got the async support working.
    - Completed the first pass of CLNsOperationQueue and CLNsOperation.
    - Working through getting a build, with a lot of commented-out code.
    - Split the ClientSdk to two projects: CloudApiPublic and CloudApiPrivate.  Win-Client -> CloudApiPublic, CloudApiPrivate.  CloudApiPrivate -> CloudApiPublic.
  o 6/1/12 Fri:
    - 6:15 - 17:15
    - 1.25 hour time waster.  The Mac used up all its memory and had to be restarted, then Windows needed to install 18 updates.....
    - Installed and played with CCloud (Comodo).  It's interesting, but I'm not overly impressed.  The cloud drive is a mounted drive, backed by the web.  e.g.: F:.
      And it is REALLY SLOOOOWWWWW!   Every operation waits forever to sync that folder with the cloud.  It doesn't appear to be file-system-backed.  Other
      features are good.  Drag anything and the cloud lights up.  Favorites, files, etc.  5 GB free.  My work email.
    - I finished the split-out of the CloudApi to public/private, and got the code to build with lots of it commented out.  I pushed it.
    - Huge time-waster!  After pushing everything, I needed to reboot the mac, so I suspended the Windows 7 VM, and restarted everything.
      When it came back up, (I'm guessing here), I may have clicked the wrong Windows 7 VM to start up, and that may have ben an underlying
      VM for the current VM????  In any case, when it came back up it was in the wrong "window" state, not like I had left it.  So I shut
      that one down and ran the other (proper?) MV from the Fusion GUI.  It refused to start.  Something about GUIDs not matching.  I did
      a lot of research, and it looked like it would be very difficult to recover, so I decided to go to Bootcamp and recover from my Acronis
      backups.  Just getting to Bootcamp required 8 hours of moving and deleting.  I started that and went home.  Wasted 6 hours today.
  o 6/2/12 Sat:
    - 6:00 - 14:30
    - The Acronis restores wouldn't work (software too old?), so the only thing left was to rebuild from scratch and lose my whole environment!!!
    - I'm not to happy with VMWare, Apple and Acronis right now.  :*(
    - I managed to get most of my environment re-installed, and fortunately I had pushed to git just before this happened, so I
      can build the project again with VS2011.
    - Time spent on that time-waster: 14.5 hours, with a lot more in the future as I fill out the lost environment....
  o 6/3/12 Sun:
    - 8:00 - 14:45
    - Installed VS2011 on my home laptop. That took 3.5 hours!!!!
    - I spent the rest of the day getting everything to build to my home laptop under 2011.  Fixed multiple problems....  I pushed the result.
  o 6/4/12 Mon:
    - 5:00 - 7:45 (home)
    - 8:45 - 18:30 (work)
    - Working on CLSyncService.cs.
    - Moved and set up in new space.
    - Investigated Ultrabac.  There are some problems.  The differential can't find the full backup.
    - More setup time on my environment.
    - Just a little work on porting...
  o 6/5/12 Tue:
    - 6:15 - 18:30
    - Porting CLSyncService...
    - Removed all stuff from the Cloud.
    - Installed PGP.
    - Tested Ultrabac.  It works and builds a .VHD file!
    - Installed Microsoft Virtual PC with XP mode.
  o 6/6/12 Wed:
    - 6:30 - 18:30
    - It builds again, with a lot of commented out code.  Commit this.
    - While coding the CloudApiPrivate, I needed to move Settings to CloudApiPrivate.  I did that.  I caused a lot of suck-in and build problems.  I pushed it to master.
    - Good example of MultipartFormData: http://stackoverflow.com/questions/10339877/asp-net-webapi-how-to-perform-a-multipart-post-with-file-upload-using-webapi-ht
    - Another example in Scenario6.xaml.cs in the HttpClient sample in Downloads.
    - JSON.Net documentation: http://james.newtonking.com/projects/json/help/
    - Working on the first SyncFromCloud HTTP request.
  o 6/7/12 Thu:
    - 5:00 - 7:30   (home)
    - 10:30 - 18:45 (work)
    - Sending authorization:
		var httpClient = new HttpClient(); 
		var url = new Uri("http://bing.com"); 
		var accessToken = "1234"; 
		var httpRequestMessage = new HttpRequestMessage(HttpMethod.Get, url); 
		httpRequestMessage.Headers.Add(System.Net.HttpRequestHeader.Authorization.ToString(), string.Format("Bearer {0}", accessToken)); 
		httpRequestMessage.Headers.Add("User-Agent", "My user-Agent"); 
		var response = await httpClient.SendAsync(httpRequestMessage); 
    - Sending multipart requests: http://stackoverflow.com/questions/10036445/how-does-one-correctly-implement-a-mediatypeformatter-to-handle-requests-of-type
    - HttpClient request/response extension methods: http://www.forkcan.com/viewcode/1211/Extension-to-the-HttpClient
    - The HTTP request is built.  Drive it asynchronously and then drive the completion handler.  Check for exceptions and handle them.  Refer to CLRegistration.
    - TaskCompletionSource: http://stackoverflow.com/questions/6884470/task-chaining-without-taskcompletionsource
    - And more: http://blogs.msdn.com/b/pfxteam/archive/2010/11/21/10094564.aspx
    - And maybe the solution: http://www.albahari.info/threading/threading.pdf
    - I reworked the GCD implementation to use templates.
    - The code is complete for SyncFromCloud.
  o 6/8/12 Fri:
    - 6:30 - 18:30
    - Mac-client raw view from Charles Proxy /sync/from_cloud:
           	POST /sync/from_cloud HTTP/1.1
		Host	192.168.1.55:8001
		User-Agent	Cloud/0.3 CFNetwork/588.2 Darwin/12.0.0 (x86_64) (MacBookAir4%2C2)
		Content-Length	54
		Accept	*/*
		Authorization	Token token="N7tUpFmClEsnClZf5RonTngV47E21WihdHhMEbjwvcg"
		Content-Type	application/json; charset=utf-8
		X-Cld-Client-Version	M03
		Accept-Language	en-us
		Accept-Encoding	gzip, deflate
		Connection	keep-alive
    - /sync/from_cloud request:
		{
			"path" : "\/",
			"sid" : "83697880505771\/62500"
		}		  
    - /sync/from_cloud request raw:
		POST /sync/from_cloud HTTP/1.1
		Host: 192.168.1.55:8001
		User-Agent: Cloud/0.3 CFNetwork/588.2 Darwin/12.0.0 (x86_64) (MacBookAir4%2C2)
		Content-Length: 54
		Accept: */*
		Authorization: Token token="N7tUpFmClEsnClZf5RonTngV47E21WihdHhMEbjwvcg"
		Content-Type: application/json; charset=utf-8
		X-Cld-Client-Version: M03
		Accept-Language: en-us
		Accept-Encoding: gzip, deflate
		Connection: keep-alive
		{
			"path" : "\/",
			"sid" : "83697880505771\/62500"
		}
    - /sync/from_cloud response:
		{"events":[],"pending_count":0,"sid":"267833267234883/200000","partial_response":false}
    - /sync/from_cloud response raw:
		HTTP/1.1 200 OK
		Content-Type: application/json; charset=utf-8
		Transfer-Encoding: chunked
		Connection: keep-alive
		Status: 200
		X-Powered-By: Phusion Passenger (mod_rails/mod_rack) 3.0.12
		X-UA-Compatible: IE=Edge,chrome=1
		ETag: "6ddb603e547cd0e0405a48ce60f19739"
		Cache-Control: max-age=0, private, must-revalidate
		X-Request-Id: af54ae24e52814f0c8c291120d3ebcdd
		X-Runtime: 0.045129
		Date: Fri, 08 Jun 2012 14:38:56 GMT
		X-Rack-Cache: invalidate, pass
		Server: nginx/1.0.15 + Phusion Passenger 3.0.12 (mod_rails/mod_rack)
		{"events":[],"pending_count":0,"sid":"267833267234883/200000","partial_response":false}        
    - Research on the Mac File system monitor:
	CLEventTypeAddFile
	CLEventTypeAddFolder
	CLEventTypeModifyFile
	CLEventTypeRenameFile
	CLEventTypeRenameFolder
	CLEventTypeMoveFile
	CLEventTypeMoveFolder
	CLEventTypeDeleteFile
	CLEventTypeDeleteFolder

	Need CLEvent:
	  Metadata
	    string Path
	    string ToPath
	    string FromPath
	    string Revision
	    string CreateDate
	    string ModifiedDate
	    string Hash
	    string Mime_type
	    string Sid
	    string Size
	    string Storage_key
	    string Version
	    string LastEventID
	    bool IsDirectory
	    bool IsDeleted
	    bool IsPending
	  SyncHeader
	    string Action
	    string EventID
	    string Sid
	    string Status
	  Action
	  IsMDSEvent

	o The file system monitor presents events only with the following information:
	  Dictionary
	    "event_count", 99999  // number of events in the group
	    "event_id", 99999     // last eid in group
	    "events", Array
	      Dictionary
		"event", string (event name: One of the CLEventType* strings listed above)
	        "metadata", Dictionary
	          if eventName is RenameFile/Folder or MoveFile/Folder
		    "from_path", oldPath of the item (without the Cloud folder root)
		    "to_path", path of the item (without the Cloud folder root)
		  else eventName is NOT one of RenameFile/Folder or MoveFile/Folder
		    "path", path of the item (without the Cloud folder root)
		  endelse eventName is NOT one of RenameFile/Folder or MoveFile/Folder
    - I got the wire image for both the Windows and Mac client, so I can compare the HTML directly.
    - I'm into test.
    - The Mac client appears to have a couple of problems in its event filter function.  It doesn't take out
      multiple duplicates, and it might not be accurate filtering using the hash.
    - David helped me rewrite the filter on Windows using Linq.
  o 6/9/12 Sat:
    - 7:15 - 12:30 (home)
    - Dictionary helper: http://sradack.blogspot.com/2007/10/dictionary-returns-null-instead.html
    - Stepping through the code.  I built a dictionary helper: Dictionary<>.GetValueOrDefault().  It tests for keys and
      prevents exceptions.
    - Sync depends on the index server which has not yet been started.  I will need to dummy it up as I test.
  o Lost this file 6/15/12.  Recovered to 6/9/12 Sat. evening.
  o 6/10/12 Sun:
    - 7:00 - 15:00 (plane)
    - Filling out CLSyncService.
  o 6/12/12 Tue (WWDC)
    - Filling out CLSyncService.
    - About 1/2 hour.
  o 6/13/12 Wed (WWDC)
    - Ditto, about 2 hours.
  o 6/14/12 Thu (WWDC)
    - Switched onto the Mac to get Finder context menu working.
    - About 2 hours.
  o 6/15/12 Fri (WWDC)
    - About 1 hour.
    - Run Applescript from ObjC: http://stackoverflow.com/questions/4909702/run-applescript-from-cocoa-application
    - Applescript reference: https://developer.apple.com/library/mac/#documentation/applescript/conceptual/applescriptlangguide/conceptual/ASLR_fundamentals.html#//apple_ref/doc/uid/TP40000983-CH218-SW2
    - Source to look through Finder windows, using FSRef: http://code.google.com/p/cdto/source/browse/main.m
    - 


    
      




        




  


- (3/15/12) Project redirection
    . Phil had a great idea.  Maybe the Mac FollowMeData project recently released did the file badging.  Actually,  it does!
    . However, it uses the custom icons.  If you copy the file out of the Cloud folder, the icon goes with the file.  Bad.
    . However, if we could remove the custom icon when the file moves out of the folder, then that would work!
    . Steve proved that he could use NSWorkspace::setIcon:forFile to change the icon on a desktop file or folder.  So that works.  He can do everything in Cocoa, using Apple's published APIs.
    . One problem: We are only looking at the file system events for the Cloud folder.  We get the file removed event, but we don't get the file created event when, say, moving a file from
       the cloud folder to the desktop.
    . Perhaps we could see that the file was removed, and watch for the file created event.  We should get that in the same event callback.  If we don't get the file created event, add
      the file to a watch list.  Subscribe to the global event stream (root) starting with that event, and watch maybe 100 events going forward.  If we see the same filename.ext, remove
      the badge because it was moved outside the Cloud folder.  Watch globally until the watch list is clear, or until we have seen a max number of events.
    . I will implement that code.
    . From Wikipedia: A file's inode number stays the same when it is moved to another directory on the same device, or when the disk is defragmented which may change its physical location. This also implies that completely conforming inode behavior is impossible to implement with many non-Unix file systems, such as FAT and its descendants, which don't have a way of storing this invariance when both a file's directory entry and its data are moved around.
    . Assume we get N events at a callback.
    . We need to determine which of the RENAME events relate to a file that was moved out of the Cloud directory.
    . Good example of multiple streams: https://bitbucket.org/boredzo/fs-notifier/src/bb3cbc42641c/Notifier.m
    . Doing it by watching the root and all events with source code: http://stackoverflow.com/questions/7300998/tracking-file-renaming-deleting-with-fsevents-on-lion; 
    . Pseudo-code for globals:
      global tracking array
      count of global events handled
      constant max count of global events handled
    . Pseudo-code for initialization:
      initialize the global tracking array to empty
    . Pseudo-code for handling Cloud directory events
     set startNodeId = 0;
     loop through the Cloud directory FS events
        … current logic.  Track whether we added or removed the file
        if this event has the rename flag
          get this file's inode
          if we removed the file
            add the inode to the tracking array
            if startNodeId == 0
		set startNodeId = this event ID.
            endif startNodeId == 0
          endif we removed the file
          if we created the file
            delete the inode from the tracking array if it is there
          endif we created the file
        endif this event has the rename flag 
      endloop through the events
      if the tracking array has elements
        if the global stream is not active
          indicate the global stream is active
          reset the count of global events processed
          start the global stream to watch for a create, starting with node startNodeId
        endif the global stream is not active
      endif the tracking array has elements
     . Pseudo-code for handling the Global FS events:
       loop through the events presented to this callback
          increment the events handled
          if this event has the rename and create flags set
            get the inode for this file 
            if this inode is in the tracking array
                remove the inode from the tracking array
                if this is a file
                  send event to remove the badge from the file
                else this is a directory
                  send event to remove the badge from the directory
              endif this is a directory
            endif this inode is in the tracking array
          endif this event has the rename and create flags set
          if the tracking array is empty, or if we have exceeded the max event count
            mark the global event stream as stopped
            stop the global event stream
          endif the tracking array is empty, or if we have exceeded the max event count
      endloop through the events presented to this callback
    . (3/16/12) DUH!  I finished this, and the first test made me realize that the inode ID won't work.  By the time we get the first event, the move has already happened, and we can't find the file to get its inode.
    . Go back to the swizzling project, at least until Steve, Phil and I can talk.  See above.


    


                


 - (3/11/12) Reverse Engineer DB
    . DB is written in python.
    . (3/7/12) PyRetic: http://code.google.com/p/pyretic/downloads/detail?name=pyREtic_0.5.1.zip&can=2&q=
    . Also UnPyc.     . Use pyREtic to reverse-engineer.  This is an in-memory decompiler.  It loads the application (DB) into its own environment, and then allows the user to probe the target.
    . (3/11/12) All work in the DB directory: /Applications/DB.app/Contents/MacOS
    . pyREtic presentation (Flash): http://prezi.com/kmyvgiobsl1d/pyretic-rich-smith-blackhatdefcon-2010/
    . Added a module DB.py:
		#!/usr/bin/python
		import sys, os
		sys.path.append("/Applications/DB.app/Contents/MacOS/pyREtic")
		print sys.path
		from pyREtic import REpdb
		REpdb.set_trace()
    . Downloaded the pyREtic package and installed it as the pyREtic directory in ./MacOS.
    . Renamed DB's python module to python.original, because DB's version was causing errors.  I am using the MacOS version of python.
    . Run "python DB.py".  That takes you to the REpdb.py prompt.
    . Commands at the REpdb prompt:
		import DB  <== imports the DB module into the debugging environment
		obj_mirror(DB)  <== allows DB.py to act as a proxy for the original DB
    . Commands at the REpdb prompt: auto_remap "/Applications/DB.app/Contents/MacOS/DB"
    . That asks you which python version to load.  DB uses 2.5.4.  pyREtic will download that for you.
    . The python 2.5.4 download failed with a socket error.
    . The log is saved in /Users/robertstevens/Source/Projects/DB.
    . DB presentation video on DB and Python: http://ontwik.com/python/pycon-2011-how-DB-did-it-and-how-python-helped/
    . Very handy logging function (later): http://vgable.com/blog/2010/08/19/the-most-useful-objective-c-code-ive-ever-written/
    . Great article about how to generate type definitions for class_addMethod: http://www.mikeash.com/pyblog/friday-qa-2010-11-6-creating-classes-at-runtime-in-objective-c.html
    . I'm trying to swizzle NSImage::drawInRect:fromRect:operation:fraction.
    . I believe I swizzled it correctly, but it never hits!!!!   ARRRRGGHHH!  This is frustrating……  Done for the day (3/11/12)
    
- Project to create a bundle via xcode
     . Using a script: http://stackoverflow.com/questions/2578496/creating-my-own-bundle-in-xcode-for-iphone-application
     . Apple doc on bundles: https://developer.apple.com/library/mac/#documentation/CoreFoundation/Conceptual/CFBundles/AboutBundles/AboutBundles.html
     . Good doc on special build requirements: http://www.musicalgeometry.com/?p=1237
     . Shell script to take both sides of a git conflict: http://stackoverflow.com/questions/2637747/get-position-in-class-hierarchy
 - Merging two project files (.pbxproj):
     - I don't have to do this.  Just add a new file and select a project file!   Works like a charm.  That's good Xcode!  :)
 - SMJobBless overview: http://qc-dev.blogspot.com/2010/07/installing-helper-tool.html - 
 - SMJobBless sample: https://developer.apple.com/library/mac/#samplecode/SMJobBless/Introduction/Intro.html#//apple_ref/doc/uid/DTS40010071
  - (3/7/12) Running Windows under VmWare on the Mac: http://codebetter.com/petervanooijen/2011/08/11/running-visual-studio-and-resharper-on-a-mac/



ICONBADGE API (3/1/12)
  o (3/2/12) NOTE: Totally reworked.  See IconBadgeApiProtocol.h
  o Messages:
      - AddNamedBadgeFiles
          . Dictionary of named badge files:
              o Key: NSString: ID of the badge.
              o Value: NSString: Full path of the badge (icon) file.
          . Existing badges will be replaced by the new badge.  This is not an error.
          . New badges will be added.
          . Return: Dictionary of Keys vs. NSError objects.  If the dictionary is empty, there were no errors.  Otherwise, each
            of the errors is included in the return:  Key: ID of the badge that failed.  Value: NSError describing the error.
      - DeleteNamedBadgeFiles
          . Array of badge keys:
              o Key: NSString: ID of the badge.
          . Badges with valid matching keys will be deleted.
          . If a key is not recognized, it will be ignored.  This is not an error.
          . Return: Dictionary of Keys vs. NSError objects.  If the dictionary is empty, there were no errors.  Otherwise, each
            of the errors is included in the return:  Key: ID of the badge that failed.  Value: NSError describing the error.
      - AddFileStatus
          . Dictionary of files with status:
              o Key: NSString: Full path of the file.
              o Value: NSString: ID of the badge used to represent the current status of the file.
          . New file status objects will be added and modified.
          . Existing file status objects will be modified.  This is not an error.
          . If a status is modified (new or different), the corresponding badge will be applied to the file's Finder icons.
          . Return: Dictionary of Keys vs. NSError objects.  If the dictionary is empty, there were no errors.  Otherwise, each
            of the errors is included in the return:  Key: Full path of the file that failed.  Value: NSError describing the error.
      - DeleteFileStatus
          . Array of file keys:
              o Key: NSString: Full path of the file.
          . File status with valid matching keys will be deleted.  The badge will be removed from the file's Finder icons.
          . If a key does not currently exist, it will be ignored.  This is not an error.
          . Return: Dictionary of Keys vs. NSError objects.  If the dictionary is empty, there were no errors.  Otherwise, each
            of the errors is included in the return:  Key: Full path of the file that failed.  Value: NSError describing the error.

XCODE (3/26/12)
  o Keys:
     - Ctl-Shft-K: Clean
     - Ctl-B: Build

BASH
  o rm -rf  <dir>     <== remove directory recursively
  o find . -type f -perm +a=x -ls  <== find all regular files recursively that are executable by all and list them via "ls -l"
  o .bash_profile example: http://www.devdaily.com/blog/post/mac-os-x/sample-mac-osx-bashrc-terminal-startup-file
  o chown -v -R robertstevens:staff . <== Change ownership recursively.
  o chmod +a=w  <== Add write capability for all users.
  o Put shell scripts in /usr/local/bin.
  o Setting environment variables: Add to /etc/launchd.conf and reboot: http://stackoverflow.com/questions/135688/setting-environment-variables-in-os-x

TEAM MEMBERS:
  o Rion McCauley
  o Gus Pinto
  o Steve McFerrin
  o Phil Wiebe
  o Pete Llaguno
  o Michael Lopez
  o Scott McDonald
  o Chuck
  o Leo
  o David Bruck


SNIPS
  o Remove a trailing backslash:
    NSMutableString *pathWithoutTrailingSlash = [path mutableCopy];
    if ([pathWithoutTrailingSlash hasSuffix:@"/"]) {
        [pathWithoutTrailingSlash deleteCharactersInRange: NSMakeRange([pathWithoutTrailingSlash length]-1, 1)];
    }

GREP:
  - grep -rin --include=*.xib "processRegistration" *   (recursive, case-insensitive, line numbers), look for all *.xib files).

GIT (3/2/12)
  - cd ~
  - mkdir ~/.ssh
  - cat ~/.ssh/id_rsa.pub | ssh root@localhost "cat - >> ~/.ssh/authorized_keys"
  - ssh root@localhost
  - ssh-keygen -t rsa
  - cat ~/.ssh/id_rsa.pub | ssh root@localhost "cat - >> ~/.ssh/authorized_keys"
  - ssh root@localhost
  - cat ~/.ssh/id_rsa.pub | ssh root@localhost "cat - >> ~/.ssh/authorized_keys"
  - ssh root@localhost
  - /var/root/Library/Developer/Xcode/DerivedData/IconBadge-bxyvdekvflxfbsafbyyrdccuymxk/Build/Products/Development/IconBadge ; exit;
  - /Users/robertstevens/Source/Projects/IconBadge/README ; exit;
  - ssh-keygen
  - ssh-keygen -t rsa -C "robert@cloud.com"
  - cat /var/root/.ssh/id_rsa
  - cat /var/root/.ssh/id_rsa.pub
  - cd /Users/robertstevens/Source/Projects/Cloud.com/Development/Mac\ Client 
  - git clone git@git.assembla.com:mac-client.git
  - cd..
  - cd ..
  - cd /Users/robertstevens/Source/Projects/Cloud.com/Development
  - git clone git@git.assembla.com:mac-client.git
  - git status
  - cd mac-client
  - git add .
  - git status
  - git commit -m "Initial Commit for the shell integreation project that allows the Cloud app to add badges to Finder objects"
  - git pushcd /Users/robertstevens/Source/Projects/Cloud.com/Development/Mac-client
  - git status
  - git remove
  - git rm
  - git stash save "Badging large icons via Finder injection"
  - git stash list
  - git stash pop stash@{0}
  - git branch: http://book.git-scm.com/3_basic_branching_and_merging.html

MORE GIT (3/7/12)
  - Never pull or merge before committing.
  - Commit often.
  - Don't pull or merge with uncommitted actions.
  - One trick for saving debugging code:
    . git stash
    . git merge origin/master
    . git stash pop
  - git commit -a -m "Fixing git problems…."   <== Forces adds
  - git add  <== adds files, or if they were being tracked, re-stages the changes.
  - git checkout  <== reverts a file, but with some minor merging back to the working directory.
  - git rm  <== removes any staged changes for a file
  - git diff  <== show the diffs between the disk version and the repository.
  - git rm -f   <== forces the removal of the changes
  - git reset  <== Undoes the last commit, and upstages everything!
  - git reset --hard  <== Undoes the last commit, undoes all of the staged files, and pulls the repository to your working directory.  Like Perforce force?
  - Good tutorial on git reset: http://progit.org/2011/07/11/reset.html
  - sudo chmod -R -a "group:everyone deny delete" .  <== Fix permissions problem
  - (3/21/12) git mergetool  <== helps with merges that need to happen.
  - To sync with master:
    . git stash save "message"
    . git pull
    . Fix conflicts and mark as fixed.
    . git commit -m "message"
    . git push
  - Set default remote:
    . git branch --set-upstream master win-client/master
  - Removing many un-staged deleted files:
    . Use git bash
    . Change drives: cd /C
    . Then change to your directory.  cd ...
    . Then issue the following command:
                git diff --diff-filter=D --name-only -z | xargs -0 git rm  
  - Committing branch
    . git branch <branch>
    . git checkout <branch>
    . git commit...
    . git push origin <branch>
    . To delete.
      - git checkout master
      - git branch -D <branch>  (locally).
      - git push origin :<branch> (remote).
  - Checking out a remote branch and creating a new branch on this client:
         git checkout -b newdesign origin/newdesign  
  

GDB (3/8/12)
  - info functions <== shows the functions
  - frame 3  <== change to frame 3
  - info frame  <== get info about a frame
  - info args
  - info locals
  - p/x $rsp  <== print value in stack register
  - x/3xg $sp  <== print 3 double words of the stack in hex.  RepeatCount: 3: number. Format: x: format.  UnitSize: g: double words, b: bytes, w: words, h: shorts.
  - show logging; set logging on; set logging off;  <== logs to gdb.txt
  - Adding a main menu item dynamically:
    . gdb
    . attach TextEdit
    . p (char)[[NSBundle bundleWithPath:@"/Library/Frameworks/FScript.framework"] load]
      . p (void)[FScriptMenuItem insertInMainMenu]
      . continue
  - 

GRAB (3/17/12)
  - Cmd+Ctrl+Shift+4, clip the image to the clipboard.


MAC OS X KEYS AND GESTURES (3/14/12)
  - Cmd-W <== Close window
  - Cmd-Opt-W  <==Close all windows
  - Start-up fix: Restart, holding Cmd-D with no devices attached or around (BlueTooth). Utilities menu. Terminal. resetpassword.

SNIPPING TOOL
  - Right-click in start menu, properties, shortcut tab.  Shortcut key.  Press a key.  Ctrl-Alt-key.
  - To snip a system tray context menu: With snipping tool running, press Esc.  Show the menu, then press Ctrl_PrtScn.

TODO:
  x (3/1/12) Finder should host the API server.
  x Change the FinderOverride code to implement a new thread, and make that thread establish a full NSRunloop environment.
  x Write a test app that will test the API.
  x Design and document the API.
  x Test the API using non-admin users.  Also admin.  Also root.
  x Provide install and uninstall scripts.
  x Capture the current Finder node's full path so it can be compared against file status.
  x Wrap everything into a single bundle, and include it in the mac_client .xcode.
  x Write code at startup in the mac_client that will perform the IconBadge installation.
  x Add badges to the QuickLook preview images.
  x Remove or disable debug logging.  Or change the logging to use DTrace?
  x Try the injection on Mountain Lion.
  x Change the main IconBadge icon.
  x Inject finder from Cloud.app after installation.
  x Don't require authorization if already installed.
  x Injection breaks Finder's "Get Info".
  x Certain files in a listview window are not badged (*.pdf, *.icns, *.jpeg, *.png, etc.).
  x Change copyrights to cloud.com.
  x Use @try/@catch in all swizzled methods.
  x Write a separate test program to select a file and badge it with a particular status (icon).  Also support random timed changes for a particular file.
  x Make all internal functions static.
  x When file status is changed via the API, notify Finder to come back and repaint the icon so the badge will change to match the new status in real time.
  x (3/21/12) Use the common getCloudIconType* functions everywhere.
  x (3/22/12) The list view icons on the flow view are not properly redrawing.  The setNeedsDisplay deselects the item, and it doesn't draw until it is selected again.  Apple bug.
  x (3/23/12) Don't stop Finder.  Rerun the test app and show that it still badges.
  x (3/23/12) Rename IconBadge to ShellSupport?  Or other?
  x (3/29/12) Bug: Can't register from the Agent back to Cloud.app.
  x (3/29/12) When Finder crashes, or is restarted, automatically re-inject. Poll the finder PID.  When it goes away, poll for Finder and reinject.
  x (3/29/12) The random change test program doesn't show all of the changes.  Why so slow?
  x (3/29/12) When we inject to Finder, enumerate all of the Finder windows and refresh them so the badges paint.
  x (3/29/12) When searching for Finder, find the Finder process belonging to the current user.  In general, make sure multiple users work properly.
  x (3/29/12) Use thread operations for sending messages back to cloud.app.
  x (3/30/12) Integrate the GUI test into the Cloud app:
  x (4/2/12) Bug: If the agent is recycled, the next message to the agent fails with an exception.  Protect against the exception, and auto-reconnect via another thread.
  x (4/2/12) Bug: Crash in Cloud when stopping Finder.
  x (4/3/12) Remove getlogin_r() duplicate code.
  x (4/5/11) Finder injection fails, but Agent still sends a refreshToFinder message to the user.
  x (4/5/12) Use proper file for nosync_192.
  x (4/5/12) Dynamically calculate the particular size and position of an icon to use for the CALayer browser images.
  x (4/5/12) Change NSLog to ALog/DLog everywhere.
  x (4/6/12) Clear all of the Finder's badges upon Cloud connection to Finder in case this is a reconnection.
  x (4/7/12) Enumerate and badge the whole cloud folder when the refreshToFinder message occurs.  Enumerate to a collection.  Start badging on another thread.  As
     user-triggered badges occur, remove that file from the collection and badge the user's requests in real time.  Repeat this process until the folder is badged.
     The user's actions will take priority.
  x (4/7/12) Test with Mountain Lion.
  x (4/7/12) Make sure that all attempts to connect to a remote server are retried on a timer.
  x (4/7/12) Gus: No badging code anywhere?
  x (4/9/12) Update registerUserName to test the inbound user name and pid.  The user name should be the same as the agent's.  The pid should be for Cloud.app.
  x (4/9/12) Add tests:
    - Restart the Mac multiple times and make sure that all three processes initialize correctly and handle the race conditions.
    - Add "crash" messages to Finder and Agent, and have the tests crash one, the other, or both, and recover.
    - Add tests for Agent.  
  x (4/9/12) On a restart, there is a race condition because Cloud, CloudApp and Finder are all trying to start simultaneously.  The Agent connection to Finder fails.
  x (4/7/12) Add a state to Cloud connection to Finder.  Cloud should not attempt to connect to Finder before connecting to Agent and receiving the refresh to finder message.
  x (4/9/12) Implement SMJobBless and a new service for the privileged work?
  x (4/10/12) Is the Agent in the wheel group (really?)?  No, it is the standard user logon.
  x (4/10/12) Badging doesn't work on Gus' or Steve's machine.
  x (4/10/12) Make getpwuid thread-safe.  Use getpwuid_r() everywhere.
  x (4/10/12) Remove "set -x" in the shell scripts.
  x (4/10/12) Uncomment messages in CLAgentService.m:beginAgentServices.
  x (4/10/12) Test for memory leaks.
  x (4/10/12) Speed up installation.  Try not to affect the GUI performance.
  x (4/12/12) Use notification instead of KVO everywhere we can.
  x (4/11/12) Badges on folders are not refreshing.  Also, badges on file in the ListView/FlowView view are not refreshing.
  x (4/12/12) Remove TODO: duplicate code.
  x (4/12/12) Change the refresh logic to run it on the Finder main thread (to avoid threading issues).
  x (4/12/12) Inspect all retains for proper use.
  x (4/12/12) Use NSError instead of int return codes.
  x (4/12/12) Inspect all code for proper function prototypes.
  x (4/12/12) Remove duplicate code in CLAgentService.m:
                dp.isAgentSendConnectionAlive = NO;        // attempt to restart the connection to the agent
                dp.isUserRegisteredWithAgent = NO;         // attempt to reregister the user with the agent
  x (4/12/12) When the first Cloud dialog appears, the typing of the user email address is delayed.
  x (4/14/12) Don't queue resets every time we give back a MAX_BADGES_QUEUED error at setBadge.
  x (4/14/12) Rework compare and swap to use atomic increment/decrement. (not necessary)
  x (4/14/12) Remove the check on finder state at the badging API.  Queue up the badges.
  x (4/13/12) Prove that the refresh-window thread is actually the Finder main thread ID.
  x (4/13/12) Change the refresh logic to refresh a window only if the window is viewing some portion of the Cloud folder.  (Decided against this)
  x (4/16/12) Remove user chmod +s flag.  It doesn't do anything.
  x (4/15/12) Rework badgeCloudDirectoryAtPath.
  x (4/15/12) Replace KVO in IconBadgeServiceUser with NSNotificationQueue. (actually reworked it pretty seriously).
  x (4/16/12) Check that agent userName is inserted into the user object, and into the dictionary, as lower case, then eliminate all of the other lowercase transformations.
  x (4/16/12) When starting agent user object, check finder to see if it is already injected.
  x (4/16/12) Kill Finder:  Doesn't rebadge other icons.
  x (4/16/12) Crash in CloudApp (memory):
	Thread 3 Crashed:
	0   libobjc.A.dylib               		0x00007fff99511f7e objc_release + 14
	1   libobjc.A.dylib               		0x00007fff9951127c (anonymous namespace)::AutoreleasePoolPage::pop(void*) + 464
	2   com.apple.CoreFoundation      0x00007fff98ad4692 _CFAutoreleasePoolPop + 34
	3   com.apple.CoreFoundation      0x00007fff98ae96d7 __CFTSDFinalize + 119
	4   libsystem_c.dylib             	0x00007fff99185112 _pthread_tsd_cleanup + 240
	5   libsystem_c.dylib             	0x00007fff9917e6ca _pthread_exit + 146
	6   libsystem_c.dylib             	0x00007fff99180c1e _pthread_workq_return + 35
	7   libsystem_c.dylib             	0x00007fff991809db _pthread_wqthread + 412
	8   libsystem_c.dylib             	0x00007fff9916afb1 start_wqthread + 13
  x Recover the Windows 7 image in a VMWare VM.
  x (4/15/12) CloudApp:IconBadgeServiceUser:observeValueForKeyPath fires twice and sends refreshToFinder message to Cloud twice.  The double-take causes the second
     observeValueForKeyPath to see a successful Finder injection, even though it wasn't.
  x (4/16/12) When restarting Cloud, the registerUser works, but no refreshToFinder message is sent, so Cloud will do no badging.
  x (4/16/12) When Cloud crashes, should we detect that and unbadge everything?  Yes.
  x (4/16/12)  Release the proxy in agent for DO with Finder.
  x (4/16/12)  Add a refreshWindows message to the Finder API.  I will also need to put logic into the user to send a refreshWindows message some amount of time 
     after the last badging operation, if a new badging operation doesn't come in within that amount of time.  (didn't need to.  It was a bug.)
  x (4/17/12) Fix the agent user clean-up loop.
  x 4/17/12) CloudApp crashes at the end of unit testing.
  x (4/16/12) Agent user hasRegisterBeenRequested is messed up.
  x (4/17/12) Move retain from agent user to agent server.
  x (4/17/12) Add retains on the DO proxys.
  x (4/17/12) Refactor the way user objects are created in the agent.  Pass ownership of the user objects to the dictionary.
  x (4/17/12) Release objects after adding them to collection.
  x (4/17/12) The server handles unregisterUserName, but it should really be the user.  If the user is registered, pass this event to the user and let him clean up, kill all badges, and 
     schedule the unregisterUser back to the server.
  x (4/1812) If the user is already registered on a registerUser, send a refreshToFinder message.
  x 4/18/12) On an unregisterUserName, pass the user pid, and generate an error if the pid's don't match.  (decided against it, for now)
  x (4/18/12) The agent user is not taking timer events, at least on a reconnect.
  x (4/19/12) The agent crash on user kill is back, even after the refactor.
  x (4/19/12) Check the release of g_dictNamedBadgeFiles in IconBadge.  Also check syncFinderLock.
  x (4/19/12) Test multiple users.
  x (4/19/12) Change "daemon" to agent everywhere.
  x (4/20/12) Check whether proxies are retained when created.  e.g., proxyForUserServer.  Remove the retains and test.  I took out the retains and it works.
  x (4/20/12) Code review.
  x (4/20/12) Compile everything with the -w (ignore warnings) flag turned off.
  x (4/28/12) Tab out of empty field didn't invoke the property set.
  x (4/29/12) The text entered is grey.  Make it black.
  x (4/29/12) Passwords should be *'s.
  x (5/2/12) The SelectStorageSize dialog is being instantiated twice.  That causes messages to be subscribed twice, and displayed twice.  Make the view a singleton?
  x (5/3/12) Change CLSettings.cs to use real properties.
  x (5/3/12) The EMail textbox is not getting focus in the CreateNewAccount dialog.  I am using the Navigated_To event.
  x (5/3/12) The password is not showing as required.  Enter the dialog and click Continue.
  x (5/3/12) The 50GB and 500GB selections cause a never-ending dialog loop.
  x (5/4/12) Change the select storage size dialog to use back and continue keys.
  x (5/3/12) Fix the timing of control focus everywhere.
  x (5/4/12) Expand the radio button click-sensitive area everywhere.
  x (5/4/12) Increase the size of the font on the account setup form.
  x (5/4/12) Add unselected state 50% white screens to the unselected radio buttons.
  x (5/4/12) Remove "TextBlock" showing on the SetupSelector dialog.
  x (5/5/12) Implement the settings on the create new account page, except for the password.
  x (5/5/12) Implement OnNavigatedTo for the CreateNewAccount page.
  x (5/5/12) Expand the Hit area on the SetupSelector dialog.  Also use the white screen on the unselected option, like the SelectStorageSize dialog.
  x (5/5/12)The SelectStorageSize selected storage size didn't hold on navigation.
  x (5/5/12) Implement the settings for the main page.
  x (5/5/12) Implement OnNavigatedTo for the main page.
  x (5/5/12) Use NavigatedTo events to initiliaze dialog state everywhere.
  x (5/5/12) The 5GB selection is not getting selected when entering the StorageSelection dialog.
  x (5/5/12) The ConvertBack (null) function is broken on the StorageSizeSelection dialog.  This is OK (expected).
  x (5/7/12) Make a prettier dialog box.
  x (5/12/12) Give focus to the email field on the main screen.
  x (5/5/12) Implement default return key on every dialog.
  x (5/5/12) The string "user@c.com" failed the regex test (relaxed the test).
  x (5/6/12) Remove duplicate code: ForceValidation().
  x (5/9/12) Add a logging utility.
  x (5/11/12) Remove the unused SetupSelector_CloudSetupNotifyFolderLocationConflictResolved message.
  x (5/11/12) Bug: The default modal messagebox onclick handler happened twice.
  x (5/11/12) Push the changes on the current Mac client 20120419V1AfterPushingFileNameChanges branch.  I have checked them out.  They are committed and good.
  x (5/15/12) Remove navigation toolbar.
  x (5/23/12) Insert the real first name into "Greetings Gus, welcome to Cloud!".
  x (5/??/12) The Navigated event is not equivalent to the NavigatedTo event in SL.
  x (5/??/12) The SetupSelector Continue button is chopped at the bottom.  It also has a dotted-line selector, which isn't all bad.
  x (5/??/12) Now the first dialog paints a dotted rectangle in the upper left corner, same size as the dialog.
  x (5/??/12) Now I am fighting with a failure to navigate (SetupSelector navigating to PageTour1 after showing a couple of dialogs.
  x (5/??/12) PageTour5 has an artifact at the bottom.
  x (5/??/12) On the SelectCloudFolder dialog, change the left button (Back) to (Cancel).
  x (5/??/12) Add more space under dialog buttons, and increase the size of the separator vertically.
  x (5/??/12) Make sure that the buttons are all the same size on the dialogs.
  x (5/??/12) Enter C:\Users\BobLaptop in the SelectCloudFolder dialog.  It wants to use C:\Users instead.
  o (5/23/12) Exception from registration: Dialog "Email has already been taken.".  The button doesn't have a caption.
  x (5/23/12) Submit all of our tool source (MvvmLight, ExtendedWpfToolkit, etc.) to git.
  x (5/25/12) Remove PageInvisible.  (changed it to WindowInvisible, and used it for system tray support).
  x (5/27/12) The balloon tooltips stopped working! (time-waster: Rebooting Windows 7 fixed it.)
  x (5/26/12) Minimize the application to the system tray with a context menu.
  x (5/24/12) Implement the first-time logic.
  x (5/27/12) Pin the icon to the system tray bar. (No.  That is the user's choice.  Dropbox is not there either.)
  o Are you sure you want to quit Cloud.com application setup?
  o When a modal dialog is present, disable the "X" Close button. Clicks on that button should not exit the modal dialog.
  o Add ICleanup interface to all view models.
  o Remove the "using win_client.Views" from the ViewModels.  ViewModels aren't supposed to know about Views.
  o The ViewModelLocator.Cleanup() function should call of the ViewModel.Cleanup functions.
  o Get rid of the ugly duplicate code (SendNavigationRequestMessage) in ViewModels.
  o Get rid of the ugly duplicate code in each of the view code-behind modules.
  o Make sure that the trace directory is not created in the release version.
  o The SelectStorageSize page did not have a selection when Settings did not exist for the user.
  o The busy indicator doesn't work.
  o Remove the old system tray NotifyIcon support.
  o Exit the application on a system tray context menu click of the Exit menu item.
  o Implement keyboard accelerators everywhere.
  o The second fancy WPF pop-up throws an exception.
  o Determine the DB architecture.
  o Don't allow network or unmountable drives for the Cloud directory.
  o Cloud window appears as a blue dot when minimized to the tray.
